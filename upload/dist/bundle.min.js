var fabric=fabric||{version:"1.4.11"};"undefined"!=typeof exports&&(exports.fabric=fabric),"undefined"!=typeof document&&"undefined"!=typeof window?(fabric.document=document,fabric.window=window):(fabric.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),fabric.window=fabric.document.createWindow()),fabric.isTouchSupported="ontouchstart"in fabric.document.documentElement,fabric.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,fabric.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width"],fabric.DPI=96,function(){function t(t,e){this.__eventListeners[t]&&(e?fabric.util.removeFromArray(this.__eventListeners[t],e):this.__eventListeners[t].length=0)}function e(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var i in t)this.on(i,t[i]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this}function i(e,i){if(this.__eventListeners){if(0===arguments.length)this.__eventListeners={};else if(1===arguments.length&&"object"==typeof arguments[0])for(var n in e)t.call(this,n,e[n]);else t.call(this,e,i);return this}}function n(t,e){if(this.__eventListeners){var i=this.__eventListeners[t];if(i){for(var n=0,r=i.length;r>n;n++)i[n].call(this,e||{});return this}}}fabric.Observable={observe:e,stopObserving:i,fire:n,on:e,off:i,trigger:n}}(),fabric.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var t=0,e=arguments.length;e>t;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.renderAll(),this},insertAt:function(t,e,i){var n=this.getObjects();return i?n[e]=t:n.splice(e,0,t),this._onObjectAdded(t),this.renderOnAddRemove&&this.renderAll(),this},remove:function(){for(var t,e=this.getObjects(),i=0,n=arguments.length;n>i;i++)t=e.indexOf(arguments[i]),-1!==t&&(e.splice(t,1),this._onObjectRemoved(arguments[i]));return this.renderOnAddRemove&&this.renderAll(),this},forEachObject:function(t,e){for(var i=this.getObjects(),n=i.length;n--;)t.call(e,i[n],n,i);return this},getObjects:function(t){return"undefined"==typeof t?this._objects:this._objects.filter(function(e){return e.type===t})},item:function(t){return this.getObjects()[t]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(t){return this.getObjects().indexOf(t)>-1},complexity:function(){return this.getObjects().reduce(function(t,e){return t+=e.complexity?e.complexity():0},0)}},function(t){var e=Math.sqrt,i=Math.atan2,n=Math.PI/180;fabric.util={removeFromArray:function(t,e){var i=t.indexOf(e);return-1!==i&&t.splice(i,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*n},radiansToDegrees:function(t){return t/n},rotatePoint:function(t,e,i){var n=Math.sin(i),r=Math.cos(i);t.subtractEquals(e);var o=t.x*r-t.y*n,a=t.x*n+t.y*r;return new fabric.Point(o,a).addEquals(e)},transformPoint:function(t,e,i){return i?new fabric.Point(e[0]*t.x+e[1]*t.y,e[2]*t.x+e[3]*t.y):new fabric.Point(e[0]*t.x+e[1]*t.y+e[4],e[2]*t.x+e[3]*t.y+e[5])},invertTransform:function(t){var e=t.slice(),i=1/(t[0]*t[3]-t[1]*t[2]);e=[i*t[3],-i*t[1],-i*t[2],i*t[0],0,0];var n=fabric.util.transformPoint({x:t[4],y:t[5]},e);return e[4]=-n.x,e[5]=-n.y,e},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t){var e=/\D{0,2}$/.exec(t),i=parseFloat(t);switch(e[0]){case"mm":return i*fabric.DPI/25.4;case"cm":return i*fabric.DPI/2.54;case"in":return i*fabric.DPI;case"pt":return i*fabric.DPI/72;case"pc":return i*fabric.DPI/72*12;default:return i}},falseFunction:function(){return!1},getKlass:function(t,e){return t=fabric.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),fabric.util.resolveNamespace(e)[t]},resolveNamespace:function(e){if(!e)return fabric;for(var i=e.split("."),n=i.length,r=t||fabric.window,o=0;n>o;++o)r=r[i[o]];return r},loadImage:function(t,e,i,n){if(!t)return void(e&&e.call(i,t));var r=fabric.util.createImage();r.onload=function(){e&&e.call(i,r),r=r.onload=r.onerror=null},r.onerror=function(){fabric.log("Error loading "+r.src),e&&e.call(i,null,!0),r=r.onload=r.onerror=null},0!==t.indexOf("data")&&"undefined"!=typeof n&&(r.crossOrigin=n),r.src=t},enlivenObjects:function(t,e,i,n){function r(){++a===s&&e&&e(o)}t=t||[];var o=[],a=0,s=t.length;return s?void t.forEach(function(t,e){if(!t||!t.type)return void r();var a=fabric.util.getKlass(t.type,i);a.async?a.fromObject(t,function(i,a){a||(o[e]=i,n&&n(t,o[e])),r()}):(o[e]=a.fromObject(t),n&&n(t,o[e]),r())}):void(e&&e(o))},groupSVGElements:function(t,e,i){var n;return n=new fabric.PathGroup(t,e),"undefined"!=typeof i&&n.setSourcePath(i),n},populateWithProperties:function(t,e,i){if(i&&"[object Array]"===Object.prototype.toString.call(i))for(var n=0,r=i.length;r>n;n++)i[n]in t&&(e[i[n]]=t[i[n]])},drawDashedLine:function(t,n,r,o,a,s){var l=o-n,c=a-r,h=e(l*l+c*c),u=i(c,l),f=s.length,d=0,p=!0;for(t.save(),t.translate(n,r),t.moveTo(0,0),t.rotate(u),n=0;h>n;)n+=s[d++%f],n>h&&(n=h),t[p?"lineTo":"moveTo"](n,0),p=!p;t.restore()},createCanvasElement:function(t){return t||(t=fabric.document.createElement("canvas")),t.getContext||"undefined"==typeof G_vmlCanvasManager||G_vmlCanvasManager.initElement(t),t},createImage:function(){return fabric.isLikelyNode?new(require("canvas").Image):fabric.document.createElement("img")},createAccessors:function(t){for(var e=t.prototype,i=e.stateProperties.length;i--;){var n=e.stateProperties[i],r=n.charAt(0).toUpperCase()+n.slice(1),o="set"+r,a="get"+r;e[a]||(e[a]=function(t){return new Function('return this.get("'+t+'")')}(n)),e[o]||(e[o]=function(t){return new Function("value",'return this.set("'+t+'", value)')}(n))}},clipContext:function(t,e){e.save(),e.beginPath(),t.clipTo(e),e.clip()},multiplyTransformMatrices:function(t,e){for(var i=[[t[0],t[2],t[4]],[t[1],t[3],t[5]],[0,0,1]],n=[[e[0],e[2],e[4]],[e[1],e[3],e[5]],[0,0,1]],r=[],o=0;3>o;o++){r[o]=[];for(var a=0;3>a;a++){for(var s=0,l=0;3>l;l++)s+=i[o][l]*n[l][a];r[o][a]=s}}return[r[0][0],r[1][0],r[0][1],r[1][1],r[0][2],r[1][2]]},getFunctionBody:function(t){return(String(t).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(t,e,i,n){n>0&&(e>n?e-=n:e=0,i>n?i-=n:i=0);for(var r=!0,o=t.getImageData(e,i,2*n||1,2*n||1),a=3,s=o.data.length;s>a;a+=4){var l=o.data[a];if(r=0>=l,r===!1)break}return o=null,r}}}("undefined"!=typeof exports?exports:this),function(){function t(t,r,a,s,l,c,h){var u=o.call(arguments);if(n[u])return n[u];var f=Math.PI,d=h*(f/180),p=Math.sin(d),g=Math.cos(d),v=0,m=0;a=Math.abs(a),s=Math.abs(s);var b=-g*t-p*r,y=-g*r+p*t,x=a*a,w=s*s,_=y*y,C=b*b,S=4*x*w-x*_-w*C,A=0;if(0>S){var k=Math.sqrt(1-.25*S/(x*w));a*=k,s*=k}else A=(l===c?-.5:.5)*Math.sqrt(S/(x*_+w*C));var T=A*a*y/s,O=-A*s*b/a,$=g*T-p*O+t/2,D=p*T+g*O+r/2,M=i(1,0,(b-T)/a,(y-O)/s),E=i((b-T)/a,(y-O)/s,(-b-T)/a,(-y-O)/s);0===c&&E>0?E-=2*f:1===c&&0>E&&(E+=2*f);for(var P=Math.ceil(Math.abs(E/(.5*f))),j=[],L=E/P,I=8/3*Math.sin(L/4)*Math.sin(L/4)/Math.sin(L/2),F=M+L,H=0;P>H;H++)j[H]=e(M,F,g,p,a,s,$,D,I,v,m),v=j[H][4],m=j[H][5],M+=L,F+=L;return n[u]=j,j}function e(t,e,i,n,a,s,l,c,h,u,f){var d=o.call(arguments);if(r[d])return r[d];var p=Math.cos(t),g=Math.sin(t),v=Math.cos(e),m=Math.sin(e),b=i*a*v-n*s*m+l,y=n*a*v+i*s*m+c,x=u+h*(-i*a*g-n*s*p),w=f+h*(-n*a*g+i*s*p),_=b+h*(i*a*m+n*s*v),C=y+h*(n*a*m-i*s*v);return r[d]=[x,w,_,C,b,y],r[d]}function i(t,e,i,n){var r=Math.atan2(e,t),o=Math.atan2(n,i);return o>=r?o-r:2*Math.PI-(r-o)}var n={},r={},o=Array.prototype.join;fabric.util.drawArc=function(e,i,n,r){for(var o=r[0],a=r[1],s=r[2],l=r[3],c=r[4],h=r[5],u=r[6],f=[[],[],[],[]],d=t(h-i,u-n,o,a,l,c,s),p=0;p<d.length;p++)f[p][0]=d[p][0]+i,f[p][1]=d[p][1]+n,f[p][2]=d[p][2]+i,f[p][3]=d[p][3]+n,f[p][4]=d[p][4]+i,f[p][5]=d[p][5]+n,e.bezierCurveTo.apply(e,f[p])}}(),function(){function t(t,e){for(var i=r.call(arguments,2),n=[],o=0,a=t.length;a>o;o++)n[o]=i.length?t[o][e].apply(t[o],i):t[o][e].call(t[o]);return n}function e(t,e){return n(t,e,function(t,e){return t>=e})}function i(t,e){return n(t,e,function(t,e){return e>t})}function n(t,e,i){if(t&&0!==t.length){var n=t.length-1,r=e?t[n][e]:t[n];if(e)for(;n--;)i(t[n][e],r)&&(r=t[n][e]);else for(;n--;)i(t[n],r)&&(r=t[n]);return r}}var r=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(t){if(void 0===this||null===this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0===i)return-1;var n=0;if(arguments.length>0&&(n=Number(arguments[1]),n!==n?n=0:0!==n&&n!==Number.POSITIVE_INFINITY&&n!==Number.NEGATIVE_INFINITY&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=i)return-1;for(var r=n>=0?n:Math.max(i-Math.abs(n),0);i>r;r++)if(r in e&&e[r]===t)return r;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var i=0,n=this.length>>>0;n>i;i++)i in this&&t.call(e,this[i],i,this)}),Array.prototype.map||(Array.prototype.map=function(t,e){for(var i=[],n=0,r=this.length>>>0;r>n;n++)n in this&&(i[n]=t.call(e,this[n],n,this));return i}),Array.prototype.every||(Array.prototype.every=function(t,e){for(var i=0,n=this.length>>>0;n>i;i++)if(i in this&&!t.call(e,this[i],i,this))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t,e){for(var i=0,n=this.length>>>0;n>i;i++)if(i in this&&t.call(e,this[i],i,this))return!0;return!1}),Array.prototype.filter||(Array.prototype.filter=function(t,e){for(var i,n=[],r=0,o=this.length>>>0;o>r;r++)r in this&&(i=this[r],t.call(e,i,r,this)&&n.push(i));return n}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var e,i=this.length>>>0,n=0;if(arguments.length>1)e=arguments[1];else for(;;){if(n in this){e=this[n++];break}if(++n>=i)throw new TypeError}for(;i>n;n++)n in this&&(e=t.call(null,e,this[n],n,this));return e}),fabric.util.array={invoke:t,min:i,max:e}}(),function(){function t(t,e){for(var i in e)t[i]=e[i];return t}function e(e){return t({},e)}fabric.util.object={extend:t,clone:e}}(),function(){function t(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})}function e(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())}function i(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")}),fabric.util.string={camelize:t,capitalize:e,escapeXml:i}}(),function(){var t=Array.prototype.slice,e=Function.prototype.apply,i=function(){};Function.prototype.bind||(Function.prototype.bind=function(n){var r,o=this,a=t.call(arguments,1);return r=a.length?function(){return e.call(o,this instanceof i?this:n,a.concat(t.call(arguments)))}:function(){return e.call(o,this instanceof i?this:n,arguments)},i.prototype=this.prototype,r.prototype=new i,r})}(),function(){function t(){}function e(t){var e=this.constructor.superclass.prototype[t];return arguments.length>1?e.apply(this,n.call(arguments,1)):e.call(this)}function i(){function i(){this.initialize.apply(this,arguments)}var o=null,s=n.call(arguments,0);"function"==typeof s[0]&&(o=s.shift()),i.superclass=o,i.subclasses=[],o&&(t.prototype=o.prototype,i.prototype=new t,o.subclasses.push(i));for(var l=0,c=s.length;c>l;l++)a(i,s[l],o);return i.prototype.initialize||(i.prototype.initialize=r),i.prototype.constructor=i,i.prototype.callSuper=e,i}var n=Array.prototype.slice,r=function(){},o=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),a=function(t,e,i){for(var n in e)t.prototype[n]=n in t.prototype&&"function"==typeof t.prototype[n]&&(e[n]+"").indexOf("callSuper")>-1?function(t){return function(){var n=this.constructor.superclass;this.constructor.superclass=i;var r=e[t].apply(this,arguments);return this.constructor.superclass=n,"initialize"!==t?r:void 0}}(n):e[n],o&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};fabric.util.createClass=i}(),function(){function t(t){var e,i,n=Array.prototype.slice.call(arguments,1),r=n.length;for(i=0;r>i;i++)if(e=typeof t[n[i]],!/^(?:function|object|unknown)$/.test(e))return!1;return!0}function e(t,e){return{handler:e,wrappedHandler:i(t,e)}}function i(t,e){return function(i){e.call(a(t),i||fabric.window.event)}}function n(t,e){return function(i){if(g[t]&&g[t][e])for(var n=g[t][e],r=0,o=n.length;o>r;r++)n[r].call(this,i||fabric.window.event)}}function r(t,e){t||(t=fabric.window.event);var i=t.target||(typeof t.srcElement!==l?t.srcElement:null),n=fabric.util.getScrollLeftTop(i,e);return{x:v(t)+n.left,y:m(t)+n.top}}function o(t,e,i){var n="touchend"===t.type?"changedTouches":"touches";return t[n]&&t[n][0]?t[n][0][e]-(t[n][0][e]-t[n][0][i])||t[i]:t[i]}var a,s,l="unknown",c=function(){var t=0;return function(e){return e.__uniqueID||(e.__uniqueID="uniqueID__"+t++)}}();!function(){var t={};a=function(e){return t[e]},s=function(e,i){t[e]=i}}();var h,u,f=t(fabric.document.documentElement,"addEventListener","removeEventListener")&&t(fabric.window,"addEventListener","removeEventListener"),d=t(fabric.document.documentElement,"attachEvent","detachEvent")&&t(fabric.window,"attachEvent","detachEvent"),p={},g={};f?(h=function(t,e,i){t.addEventListener(e,i,!1)},u=function(t,e,i){t.removeEventListener(e,i,!1)}):d?(h=function(t,i,n){var r=c(t);s(r,t),p[r]||(p[r]={}),p[r][i]||(p[r][i]=[]);var o=e(r,n);p[r][i].push(o),t.attachEvent("on"+i,o.wrappedHandler)},u=function(t,e,i){var n,r=c(t);if(p[r]&&p[r][e])for(var o=0,a=p[r][e].length;a>o;o++)n=p[r][e][o],n&&n.handler===i&&(t.detachEvent("on"+e,n.wrappedHandler),p[r][e][o]=null)}):(h=function(t,e,i){var r=c(t);if(g[r]||(g[r]={}),!g[r][e]){g[r][e]=[];var o=t["on"+e];o&&g[r][e].push(o),t["on"+e]=n(r,e)}g[r][e].push(i)},u=function(t,e,i){var n=c(t);if(g[n]&&g[n][e])for(var r=g[n][e],o=0,a=r.length;a>o;o++)r[o]===i&&r.splice(o,1)}),fabric.util.addListener=h,fabric.util.removeListener=u;var v=function(t){return typeof t.clientX!==l?t.clientX:0},m=function(t){return typeof t.clientY!==l?t.clientY:0};fabric.isTouchSupported&&(v=function(t){return o(t,"pageX","clientX")},m=function(t){return o(t,"pageY","clientY")}),fabric.util.getPointer=r,fabric.util.object.extend(fabric.util,fabric.Observable)}(),function(){function t(t,e){var i=t.style;if(!i)return t;if("string"==typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?o(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var n in e)if("opacity"===n)o(t,e[n]);else{var r="float"===n||"cssFloat"===n?"undefined"==typeof i.styleFloat?"cssFloat":"styleFloat":n;i[r]=e[n]}return t}var e=fabric.document.createElement("div"),i="string"==typeof e.style.opacity,n="string"==typeof e.style.filter,r=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,o=function(t){return t};i?o=function(t,e){return t.style.opacity=e,t}:n&&(o=function(t,e){var i=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(i.zoom=1),r.test(i.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",i.filter=i.filter.replace(r,e)):i.filter+=" alpha(opacity="+100*e+")",t}),fabric.util.setStyle=t}(),function(){function t(t){return"string"==typeof t?fabric.document.getElementById(t):t}function e(t,e){var i=fabric.document.createElement(t);for(var n in e)"class"===n?i.className=e[n]:"for"===n?i.htmlFor=e[n]:i.setAttribute(n,e[n]);return i}function i(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)}function n(t,i,n){return"string"==typeof i&&(i=e(i,n)),t.parentNode&&t.parentNode.replaceChild(i,t),i.appendChild(t),i}function r(t,e){var i,n,r=0,o=0,a=fabric.document.documentElement,s=fabric.document.body||{scrollLeft:0,scrollTop:0};for(n=t;t&&t.parentNode&&!i;)t=t.parentNode,t!==fabric.document&&"fixed"===fabric.util.getElementStyle(t,"position")&&(i=t),t!==fabric.document&&n!==e&&"absolute"===fabric.util.getElementStyle(t,"position")?(r=0,o=0):t===fabric.document?(r=s.scrollLeft||a.scrollLeft||0,o=s.scrollTop||a.scrollTop||0):(r+=t.scrollLeft||0,o+=t.scrollTop||0);return{left:r,top:o}}function o(t){var e,i,n=t&&t.ownerDocument,r={left:0,top:0},o={left:0,top:0},a={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!n)return{left:0,top:0};for(var s in a)o[a[s]]+=parseInt(h(t,s),10)||0;return e=n.documentElement,"undefined"!=typeof t.getBoundingClientRect&&(r=t.getBoundingClientRect()),i=fabric.util.getScrollLeftTop(t,null),{left:r.left+i.left-(e.clientLeft||0)+o.left,top:r.top+i.top-(e.clientTop||0)+o.top}}var a,s=Array.prototype.slice,l=function(t){return s.call(t,0)};try{a=l(fabric.document.childNodes)instanceof Array}catch(c){}a||(l=function(t){for(var e=new Array(t.length),i=t.length;i--;)e[i]=t[i];return e});var h;h=fabric.document.defaultView&&fabric.document.defaultView.getComputedStyle?function(t,e){return fabric.document.defaultView.getComputedStyle(t,null)[e]}:function(t,e){var i=t.style[e];return!i&&t.currentStyle&&(i=t.currentStyle[e]),i},function(){function t(t){return"undefined"!=typeof t.onselectstart&&(t.onselectstart=fabric.util.falseFunction),n?t.style[n]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t}function e(t){return"undefined"!=typeof t.onselectstart&&(t.onselectstart=null),n?t.style[n]="":"string"==typeof t.unselectable&&(t.unselectable=""),t}var i=fabric.document.documentElement.style,n="userSelect"in i?"userSelect":"MozUserSelect"in i?"MozUserSelect":"WebkitUserSelect"in i?"WebkitUserSelect":"KhtmlUserSelect"in i?"KhtmlUserSelect":"";fabric.util.makeElementUnselectable=t,fabric.util.makeElementSelectable=e}(),function(){function t(t,e){var i=fabric.document.getElementsByTagName("head")[0],n=fabric.document.createElement("script"),r=!0;n.onload=n.onreadystatechange=function(t){if(r){if("string"==typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)return;r=!1,e(t||fabric.window.event),n=n.onload=n.onreadystatechange=null}},n.src=t,i.appendChild(n)}fabric.util.getScript=t}(),fabric.util.getById=t,fabric.util.toArray=l,fabric.util.makeElement=e,fabric.util.addClass=i,fabric.util.wrapElement=n,fabric.util.getScrollLeftTop=r,fabric.util.getElementOffset=o,fabric.util.getElementStyle=h}(),function(){function t(t,e){return t+(/\?/.test(t)?"&":"?")+e}function e(){}function i(i,r){r||(r={});var o,a=r.method?r.method.toUpperCase():"GET",s=r.onComplete||function(){},l=n();return l.onreadystatechange=function(){4===l.readyState&&(s(l),l.onreadystatechange=e)},"GET"===a&&(o=null,"string"==typeof r.parameters&&(i=t(i,r.parameters))),l.open(a,i,!0),("POST"===a||"PUT"===a)&&l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.send(o),l}var n=function(){for(var t=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],e=t.length;e--;)try{var i=t[e]();if(i)return t[e]}catch(n){}}();fabric.util.request=i}(),fabric.log=function(){},fabric.warn=function(){},"undefined"!=typeof console&&["log","warn"].forEach(function(t){"undefined"!=typeof console[t]&&console[t].apply&&(fabric[t]=function(){return console[t].apply(console,arguments)})}),function(){function t(t){e(function(i){t||(t={});var n,r=i||+new Date,o=t.duration||500,a=r+o,s=t.onChange||function(){},l=t.abort||function(){return!1},c=t.easing||function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},h="startValue"in t?t.startValue:0,u="endValue"in t?t.endValue:100,f=t.byValue||u-h;t.onStart&&t.onStart(),function d(i){n=i||+new Date;var u=n>a?o:n-r;return l()?void(t.onComplete&&t.onComplete()):(s(c(u,h,f,o)),n>a?void(t.onComplete&&t.onComplete()):void e(d))}(r)})}function e(){return i.apply(fabric.window,arguments)}var i=fabric.window.requestAnimationFrame||fabric.window.webkitRequestAnimationFrame||fabric.window.mozRequestAnimationFrame||fabric.window.oRequestAnimationFrame||fabric.window.msRequestAnimationFrame||function(t){fabric.window.setTimeout(t,1e3/60)};fabric.util.animate=t,fabric.util.requestAnimFrame=e}(),function(){function t(t,e,i,n){return t<Math.abs(e)?(t=e,n=i/4):n=i/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:i,s:n}}function e(t,e,i){return t.a*Math.pow(2,10*(e-=1))*Math.sin(2*(e*i-t.s)*Math.PI/t.p)}function i(t,e,i,n){return i*((t=t/n-1)*t*t+1)+e}function n(t,e,i,n){return t/=n/2,1>t?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e}function r(t,e,i,n){return i*(t/=n)*t*t*t+e}function o(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e}function a(t,e,i,n){return t/=n/2,1>t?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e}function s(t,e,i,n){return i*(t/=n)*t*t*t*t+e}function l(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e}function c(t,e,i,n){return t/=n/2,1>t?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e}function h(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e}function u(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e}function f(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e}function d(t,e,i,n){return 0===t?e:i*Math.pow(2,10*(t/n-1))+e}function p(t,e,i,n){return t===n?e+i:i*(-Math.pow(2,-10*t/n)+1)+e}function g(t,e,i,n){return 0===t?e:t===n?e+i:(t/=n/2,1>t?i/2*Math.pow(2,10*(t-1))+e:i/2*(-Math.pow(2,-10*--t)+2)+e)}function v(t,e,i,n){return-i*(Math.sqrt(1-(t/=n)*t)-1)+e}function m(t,e,i,n){return i*Math.sqrt(1-(t=t/n-1)*t)+e}function b(t,e,i,n){return t/=n/2,1>t?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e}function y(i,n,r,o){var a=1.70158,s=0,l=r;if(0===i)return n;if(i/=o,1===i)return n+r;s||(s=.3*o);var c=t(l,r,s,a);return-e(c,i,o)+n}function x(e,i,n,r){var o=1.70158,a=0,s=n;if(0===e)return i;if(e/=r,1===e)return i+n;a||(a=.3*r);var l=t(s,n,a,o);return l.a*Math.pow(2,-10*e)*Math.sin(2*(e*r-l.s)*Math.PI/l.p)+l.c+i}function w(i,n,r,o){var a=1.70158,s=0,l=r;if(0===i)return n;if(i/=o/2,2===i)return n+r;s||(s=.3*o*1.5);var c=t(l,r,s,a);return 1>i?-.5*e(c,i,o)+n:c.a*Math.pow(2,-10*(i-=1))*Math.sin(2*(i*o-c.s)*Math.PI/c.p)*.5+c.c+n}function _(t,e,i,n,r){return void 0===r&&(r=1.70158),i*(t/=n)*t*((r+1)*t-r)+e}function C(t,e,i,n,r){return void 0===r&&(r=1.70158),i*((t=t/n-1)*t*((r+1)*t+r)+1)+e}function S(t,e,i,n,r){return void 0===r&&(r=1.70158),t/=n/2,1>t?i/2*t*t*(((r*=1.525)+1)*t-r)+e:i/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+e}function A(t,e,i,n){return i-k(n-t,0,i,n)+e}function k(t,e,i,n){return(t/=n)<1/2.75?7.5625*i*t*t+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}function T(t,e,i,n){return n/2>t?.5*A(2*t,0,i,n)+e:.5*k(2*t-n,0,i,n)+.5*i+e}fabric.util.ease={easeInQuad:function(t,e,i,n){return i*(t/=n)*t+e},easeOutQuad:function(t,e,i,n){return-i*(t/=n)*(t-2)+e},easeInOutQuad:function(t,e,i,n){return t/=n/2,1>t?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,n){return i*(t/=n)*t*t+e},easeOutCubic:i,easeInOutCubic:n,easeInQuart:r,easeOutQuart:o,easeInOutQuart:a,easeInQuint:s,easeOutQuint:l,easeInOutQuint:c,easeInSine:h,easeOutSine:u,easeInOutSine:f,easeInExpo:d,easeOutExpo:p,easeInOutExpo:g,easeInCirc:v,easeOutCirc:m,easeInOutCirc:b,easeInElastic:y,easeOutElastic:x,easeInOutElastic:w,easeInBack:_,easeOutBack:C,easeInOutBack:S,easeInBounce:A,easeOutBounce:k,easeInOutBounce:T}}(),function(t){"use strict";function e(t){return t in _?_[t]:t}function i(t,e,i){var n,r="[object Array]"===Object.prototype.toString.call(e);return"fill"!==t&&"stroke"!==t||"none"!==e?"fillRule"===t?e="evenodd"===e?"destination-over":e:"strokeDashArray"===t?e=e.replace(/,/g," ").split(/\s+/).map(function(t){return parseInt(t)}):"transformMatrix"===t?e=i&&i.transformMatrix?w(i.transformMatrix,g.parseTransformAttribute(e)):g.parseTransformAttribute(e):"visible"===t?(e="none"===e||"hidden"===e?!1:!0,i&&i.visible===!1&&(e=!1)):"originX"===t?e="start"===e?"left":"end"===e?"right":"center":n=r?e.map(x):x(e):e="",!r&&isNaN(n)?e:n}function n(t){for(var e in C)if(t[e]&&"undefined"!=typeof t[C[e]]&&0!==t[e].indexOf("url(")){var i=new g.Color(t[e]);t[e]=i.setAlpha(y(i.getAlpha()*t[C[e]],2)).toRgba()}return t}function r(t,e){var i=t.match(/(normal|italic)?\s*(normal|small-caps)?\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\s*(\d+)px(?:\/(normal|[\d\.]+))?\s+(.*)/);if(i){var n=i[1],r=i[3],o=i[4],a=i[5],s=i[6];n&&(e.fontStyle=n),r&&(e.fontWeight=isNaN(parseFloat(r))?r:parseFloat(r)),o&&(e.fontSize=parseFloat(o)),s&&(e.fontFamily=s),a&&(e.lineHeight="normal"===a?1:a)}}function o(t,n){var o,a;t.replace(/;$/,"").split(";").forEach(function(t){var s=t.split(":");o=e(s[0].trim().toLowerCase()),a=i(o,s[1].trim()),"font"===o?r(a,n):n[o]=a})}function a(t,n){var o,a;for(var s in t)"undefined"!=typeof t[s]&&(o=e(s.toLowerCase()),a=i(o,t[s]),"font"===o?r(a,n):n[o]=a)}function s(t){var e={};for(var i in g.cssRules)if(l(t,i.split(" ")))for(var n in g.cssRules[i])e[n]=g.cssRules[i][n];return e}function l(t,e){var i,n=!0;return i=h(t,e.pop()),i&&e.length&&(n=c(t,e)),i&&n&&0===e.length}function c(t,e){for(var i,n=!0;t.parentNode&&1===t.parentNode.nodeType&&e.length;)n&&(i=e.pop()),t=t.parentNode,n=h(t,i);return 0===e.length}function h(t,e){var i,n=t.nodeName,r=t.getAttribute("class"),o=t.getAttribute("id");if(i=new RegExp("^"+n,"i"),e=e.replace(i,""),o&&e.length&&(i=new RegExp("#"+o+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")),r&&e.length){r=r.split(" ");for(var a=r.length;a--;)i=new RegExp("\\."+r[a]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(i,"")}return 0===e.length}function u(t){for(var e=t.getElementsByTagName("use");e.length;){for(var i,n=e[0],r=n.getAttribute("xlink:href").substr(1),o=n.getAttribute("x")||0,a=n.getAttribute("y")||0,s=t.getElementById(r).cloneNode(!0),l=(n.getAttribute("transform")||"")+" translate("+o+", "+a+")",c=0,h=n.attributes,u=h.length;u>c;c++){var f=h.item(c);"x"!==f.nodeName&&"y"!==f.nodeName&&"xlink:href"!==f.nodeName&&("transform"===f.nodeName?l=l+" "+f.nodeValue:s.setAttribute(f.nodeName,f.nodeValue))}s.setAttribute("transform",l),s.removeAttribute("id"),i=n.parentNode,i.replaceChild(s,n)}}function f(t,e){if(e[3]=e[0]=e[0]>e[3]?e[3]:e[0],1!==e[0]||1!==e[3]||0!==e[4]||0!==e[5]){for(var i=t.ownerDocument.createElement("g");null!=t.firstChild;)i.appendChild(t.firstChild);i.setAttribute("transform","matrix("+e[0]+" "+e[1]+" "+e[2]+" "+e[3]+" "+e[4]+" "+e[5]+")"),t.appendChild(i)}}function d(t){var e=t.objects,i=t.options;return e=e.map(function(t){return g[m(t.type)].fromObject(t)}),{objects:e,options:i}}function p(t,e,i){e[i]&&e[i].toSVG&&t.push('<pattern x="0" y="0" id="',i,'Pattern" ','width="',e[i].source.width,'" height="',e[i].source.height,'" patternUnits="userSpaceOnUse">','<image x="0" y="0" ','width="',e[i].source.width,'" height="',e[i].source.height,'" xlink:href="',e[i].source.src,'"></image></pattern>')}var g=t.fabric||(t.fabric={}),v=g.util.object.extend,m=g.util.string.capitalize,b=g.util.object.clone,y=g.util.toFixed,x=g.util.parseUnit,w=g.util.multiplyTransformMatrices,_={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"originX"},C={stroke:"strokeOpacity",fill:"fillOpacity"};g.parseTransformAttribute=function(){function t(t,e){var i=e[0];t[0]=Math.cos(i),t[1]=Math.sin(i),t[2]=-Math.sin(i),t[3]=Math.cos(i)}function e(t,e){var i=e[0],n=2===e.length?e[1]:e[0];t[0]=i,t[3]=n}function i(t,e){t[2]=e[0]}function n(t,e){t[1]=e[0]}function r(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}var o=[1,0,0,1,0,0],a="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)",s="(?:\\s+,?\\s*|,\\s*)",l="(?:(skewX)\\s*\\(\\s*("+a+")\\s*\\))",c="(?:(skewY)\\s*\\(\\s*("+a+")\\s*\\))",h="(?:(rotate)\\s*\\(\\s*("+a+")(?:"+s+"("+a+")"+s+"("+a+"))?\\s*\\))",u="(?:(scale)\\s*\\(\\s*("+a+")(?:"+s+"("+a+"))?\\s*\\))",f="(?:(translate)\\s*\\(\\s*("+a+")(?:"+s+"("+a+"))?\\s*\\))",d="(?:(matrix)\\s*\\(\\s*("+a+")"+s+"("+a+")"+s+"("+a+")"+s+"("+a+")"+s+"("+a+")"+s+"("+a+")\\s*\\))",p="(?:"+d+"|"+f+"|"+u+"|"+h+"|"+l+"|"+c+")",v="(?:"+p+"(?:"+s+p+")*)",m="^\\s*(?:"+v+"?)\\s*$",b=new RegExp(m),y=new RegExp(p,"g");return function(a){var s=o.concat(),l=[];if(!a||a&&!b.test(a))return s;a.replace(y,function(a){var c=new RegExp(p).exec(a).filter(function(t){return""!==t&&null!=t}),h=c[1],u=c.slice(2).map(parseFloat);switch(h){case"translate":r(s,u);break;case"rotate":u[0]=g.util.degreesToRadians(u[0]),t(s,u);break;case"scale":e(s,u);break;case"skewX":i(s,u);break;case"skewY":n(s,u);break;case"matrix":s=u}l.push(s.concat()),s=o.concat()});for(var c=l[0];l.length>1;)l.shift(),c=g.util.multiplyTransformMatrices(c,l[0]);return c}}(),g.parseSVGDocument=function(){function t(t,e){for(;t&&(t=t.parentNode);)if(e.test(t.nodeName))return!0;return!1}var e=/^(path|circle|polygon|polyline|ellipse|rect|line|image|text)$/,i="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)",n=new RegExp("^\\s*("+i+"+)\\s*,?\\s*("+i+"+)\\s*,?\\s*("+i+"+)\\s*,?\\s*("+i+"+)\\s*$");return function(i,r,o){if(i){var a=new Date;u(i);var s,l,c=i.getAttribute("viewBox"),h=x(i.getAttribute("width")),d=x(i.getAttribute("height"));if(c&&(c=c.match(n))){var p=parseFloat(c[1]),v=parseFloat(c[2]),m=1,y=1;s=parseFloat(c[3]),l=parseFloat(c[4]),h&&h!==s&&(m=h/s),d&&d!==l&&(y=d/l),f(i,[m,0,0,y,m*-p,y*-v])}var w=g.util.toArray(i.getElementsByTagName("*"));if(0===w.length&&g.isLikelyNode){w=i.selectNodes('//*[name(.)!="svg"]');for(var _=[],C=0,S=w.length;S>C;C++)_[C]=w[C];w=_}var A=w.filter(function(i){return e.test(i.tagName)&&!t(i,/^(?:pattern|defs)$/)});if(!A||A&&!A.length)return void(r&&r([],{}));var k={width:h?h:s,height:d?d:l,widthAttr:h,heightAttr:d};g.gradientDefs=g.getGradientDefs(i),g.cssRules=g.getCSSRules(i),g.parseElements(A,function(t){g.documentParsingTime=new Date-a,r&&r(t,k)},b(k),o)}}}();var S={has:function(t,e){e(!1)},get:function(){},set:function(){}};v(g,{getGradientDefs:function(t){var e,i,n,r,o=t.getElementsByTagName("linearGradient"),a=t.getElementsByTagName("radialGradient"),s=0,l=[],c={},h={};for(l.length=o.length+a.length,i=o.length;i--;)l[s++]=o[i];for(i=a.length;i--;)l[s++]=a[i];for(;s--;)e=l[s],r=e.getAttribute("xlink:href"),n=e.getAttribute("id"),r&&(h[n]=r.substr(1)),c[n]=e;for(n in h){var u=c[h[n]].cloneNode(!0);for(e=c[n];u.firstChild;)e.appendChild(u.firstChild)}return c},parseAttributes:function(t,r){if(t){var o,a={};t.parentNode&&/^symbol|[g|a]$/i.test(t.parentNode.nodeName)&&(a=g.parseAttributes(t.parentNode,r));var l=r.reduce(function(n,r){return o=t.getAttribute(r),o&&(r=e(r),o=i(r,o,a),n[r]=o),n},{});return l=v(l,v(s(t),g.parseStyleAttribute(t))),n(v(a,l))}},parseElements:function(t,e,i,n){new g.ElementsParser(t,e,i,n).parse()},parseStyleAttribute:function(t){var e={},i=t.getAttribute("style");return i?("string"==typeof i?o(i,e):a(i,e),e):e},parsePointsAttribute:function(t){if(!t)return null;t=t.replace(/,/g," ").trim(),t=t.split(/\s+/);var e,i,n=[];for(e=0,i=t.length;i>e;e+=2)n.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return n},getCSSRules:function(t){for(var n,r=t.getElementsByTagName("style"),o={},a=0,s=r.length;s>a;a++){var l=r[0].textContent;l=l.replace(/\/\*[\s\S]*?\*\//g,""),n=l.match(/[^{]*\{[\s\S]*?\}/g),n=n.map(function(t){return t.trim()}),n.forEach(function(t){for(var n=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),r={},a=n[2].trim(),s=a.replace(/;$/,"").split(/\s*;\s*/),l=0,c=s.length;c>l;l++){var h=s[l].split(/\s*:\s*/),u=e(h[0]),f=i(u,h[1],h[0]);r[u]=f}t=n[1],t.split(",").forEach(function(t){o[t.trim()]=g.util.object.clone(r)})})}return o},loadSVGFromURL:function(t,e,i){function n(n){var r=n.responseXML;r&&!r.documentElement&&g.window.ActiveXObject&&n.responseText&&(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,""))),r&&r.documentElement&&g.parseSVGDocument(r.documentElement,function(i,n){S.set(t,{objects:g.util.array.invoke(i,"toObject"),options:n}),e(i,n)
},i)}t=t.replace(/^\n\s*/,"").trim(),S.has(t,function(i){i?S.get(t,function(t){var i=d(t);e(i.objects,i.options)}):new g.util.request(t,{method:"get",onComplete:n})})},loadSVGFromString:function(t,e,i){t=t.trim();var n;if("undefined"!=typeof DOMParser){var r=new DOMParser;r&&r.parseFromString&&(n=r.parseFromString(t,"text/xml"))}else g.window.ActiveXObject&&(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(t.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));g.parseSVGDocument(n.documentElement,function(t,i){e(t,i)},i)},createSVGFontFacesMarkup:function(t){for(var e="",i=0,n=t.length;n>i;i++)"text"===t[i].type&&t[i].path&&(e+=["@font-face {","font-family: ",t[i].fontFamily,"; ","src: url('",t[i].path,"')","}"].join(""));return e&&(e=['<style type="text/css">',"<![CDATA[",e,"]]>","</style>"].join("")),e},createSVGRefElementsMarkup:function(t){var e=[];return p(e,t,"backgroundColor"),p(e,t,"overlayColor"),e.join("")}})}("undefined"!=typeof exports?exports:this),fabric.ElementsParser=function(t,e,i,n){this.elements=t,this.callback=e,this.options=i,this.reviver=n},fabric.ElementsParser.prototype.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},fabric.ElementsParser.prototype.createObjects=function(){for(var t=0,e=this.elements.length;e>t;t++)!function(t,e){setTimeout(function(){t.createObject(t.elements[e],e)},0)}(this,t)},fabric.ElementsParser.prototype.createObject=function(t,e){var i=fabric[fabric.util.string.capitalize(t.tagName)];if(i&&i.fromElement)try{this._createObject(i,t,e)}catch(n){fabric.log(n)}else this.checkIfDone()},fabric.ElementsParser.prototype._createObject=function(t,e,i){if(t.async)t.fromElement(e,this.createCallback(i,e),this.options);else{var n=t.fromElement(e,this.options);this.resolveGradient(n,"fill"),this.resolveGradient(n,"stroke"),this.reviver&&this.reviver(e,n),this.instances[i]=n,this.checkIfDone()}},fabric.ElementsParser.prototype.createCallback=function(t,e){var i=this;return function(n){i.resolveGradient(n,"fill"),i.resolveGradient(n,"stroke"),i.reviver&&i.reviver(e,n),i.instances[t]=n,i.checkIfDone()}},fabric.ElementsParser.prototype.resolveGradient=function(t,e){var i=t.get(e);if(/^url\(/.test(i)){var n=i.slice(5,i.length-1);fabric.gradientDefs[n]&&t.set(e,fabric.Gradient.fromElement(fabric.gradientDefs[n],t))}},fabric.ElementsParser.prototype.checkIfDone=function(){0===--this.numElements&&(this.instances=this.instances.filter(function(t){return null!=t}),this.callback(this.instances))},function(t){"use strict";function e(t,e){this.x=t,this.y=e}var i=t.fabric||(t.fabric={});return i.Point?void i.warn("fabric.Point is already defined"):(i.Point=e,void(e.prototype={constructor:e,add:function(t){return new e(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new e(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new e(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new e(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new e(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new e(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,i){return new e(this.x+(t.x-this.x)*i,this.y+(t.y-this.y)*i)},distanceFrom:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},midPointFrom:function(t){return new e(this.x+(t.x-this.x)/2,this.y+(t.y-this.y)/2)},min:function(t){return new e(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new e(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){this.x=t,this.y=e},setFromPoint:function(t){this.x=t.x,this.y=t.y},swap:function(t){var e=this.x,i=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=i}}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){this.status=t,this.points=[]}var i=t.fabric||(t.fabric={});return i.Intersection?void i.warn("fabric.Intersection is already defined"):(i.Intersection=e,i.Intersection.prototype={appendPoint:function(t){this.points.push(t)},appendPoints:function(t){this.points=this.points.concat(t)}},i.Intersection.intersectLineLine=function(t,n,r,o){var a,s=(o.x-r.x)*(t.y-r.y)-(o.y-r.y)*(t.x-r.x),l=(n.x-t.x)*(t.y-r.y)-(n.y-t.y)*(t.x-r.x),c=(o.y-r.y)*(n.x-t.x)-(o.x-r.x)*(n.y-t.y);if(0!==c){var h=s/c,u=l/c;h>=0&&1>=h&&u>=0&&1>=u?(a=new e("Intersection"),a.points.push(new i.Point(t.x+h*(n.x-t.x),t.y+h*(n.y-t.y)))):a=new e}else a=new e(0===s||0===l?"Coincident":"Parallel");return a},i.Intersection.intersectLinePolygon=function(t,i,n){for(var r=new e,o=n.length,a=0;o>a;a++){var s=n[a],l=n[(a+1)%o],c=e.intersectLineLine(t,i,s,l);r.appendPoints(c.points)}return r.points.length>0&&(r.status="Intersection"),r},i.Intersection.intersectPolygonPolygon=function(t,i){for(var n=new e,r=t.length,o=0;r>o;o++){var a=t[o],s=t[(o+1)%r],l=e.intersectLinePolygon(a,s,i);n.appendPoints(l.points)}return n.points.length>0&&(n.status="Intersection"),n},void(i.Intersection.intersectPolygonRectangle=function(t,n,r){var o=n.min(r),a=n.max(r),s=new i.Point(a.x,o.y),l=new i.Point(o.x,a.y),c=e.intersectLinePolygon(o,s,t),h=e.intersectLinePolygon(s,a,t),u=e.intersectLinePolygon(a,l,t),f=e.intersectLinePolygon(l,o,t),d=new e;return d.appendPoints(c.points),d.appendPoints(h.points),d.appendPoints(u.points),d.appendPoints(f.points),d.points.length>0&&(d.status="Intersection"),d}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function i(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+(e-t)*(2/3-i)*6:t}var n=t.fabric||(t.fabric={});return n.Color?void n.warn("fabric.Color is already defined."):(n.Color=e,n.Color.prototype={_tryParsingColor:function(t){var i;return t in e.colorNameMap&&(t=e.colorNameMap[t]),"transparent"===t?void this.setSource([255,255,255,0]):(i=e.sourceFromHex(t),i||(i=e.sourceFromRgb(t)),i||(i=e.sourceFromHsl(t)),void(i&&this.setSource(i)))},_rgbToHsl:function(t,e,i){t/=255,e/=255,i/=255;var r,o,a,s=n.util.array.max([t,e,i]),l=n.util.array.min([t,e,i]);if(a=(s+l)/2,s===l)r=o=0;else{var c=s-l;switch(o=a>.5?c/(2-s-l):c/(s+l),s){case t:r=(e-i)/c+(i>e?6:0);break;case e:r=(i-t)/c+2;break;case i:r=(t-e)/c+4}r/=6}return[Math.round(360*r),Math.round(100*o),Math.round(100*a)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,i,n=this.getSource();return t=n[0].toString(16),t=1===t.length?"0"+t:t,e=n[1].toString(16),e=1===e.length?"0"+e:e,i=n[2].toString(16),i=1===i.length?"0"+i:i,t.toUpperCase()+e.toUpperCase()+i.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),i=t[3];return this.setSource([e,e,e,i]),this},toBlackWhite:function(t){var e=this.getSource(),i=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),n=e[3];return t=t||127,i=Number(i)<Number(t)?0:255,this.setSource([i,i,i,n]),this},overlayWith:function(t){t instanceof e||(t=new e(t));for(var i=[],n=this.getAlpha(),r=.5,o=this.getSource(),a=t.getSource(),s=0;3>s;s++)i.push(Math.round(o[s]*(1-r)+a[s]*r));return i[3]=n,this.setSource(i),this}},n.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,n.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,n.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,n.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},n.Color.fromRgb=function(t){return e.fromSource(e.sourceFromRgb(t))},n.Color.sourceFromRgb=function(t){var i=t.match(e.reRGBa);if(i){var n=parseInt(i[1],10)/(/%$/.test(i[1])?100:1)*(/%$/.test(i[1])?255:1),r=parseInt(i[2],10)/(/%$/.test(i[2])?100:1)*(/%$/.test(i[2])?255:1),o=parseInt(i[3],10)/(/%$/.test(i[3])?100:1)*(/%$/.test(i[3])?255:1);return[parseInt(n,10),parseInt(r,10),parseInt(o,10),i[4]?parseFloat(i[4]):1]}},n.Color.fromRgba=e.fromRgb,n.Color.fromHsl=function(t){return e.fromSource(e.sourceFromHsl(t))},n.Color.sourceFromHsl=function(t){var n=t.match(e.reHSLa);if(n){var r,o,a,s=(parseFloat(n[1])%360+360)%360/360,l=parseFloat(n[2])/(/%$/.test(n[2])?100:1),c=parseFloat(n[3])/(/%$/.test(n[3])?100:1);if(0===l)r=o=a=c;else{var h=.5>=c?c*(l+1):c+l-c*l,u=2*c-h;r=i(u,h,s+1/3),o=i(u,h,s),a=i(u,h,s-1/3)}return[Math.round(255*r),Math.round(255*o),Math.round(255*a),n[4]?parseFloat(n[4]):1]}},n.Color.fromHsla=e.fromHsl,n.Color.fromHex=function(t){return e.fromSource(e.sourceFromHex(t))},n.Color.sourceFromHex=function(t){if(t.match(e.reHex)){var i=t.slice(t.indexOf("#")+1),n=3===i.length,r=n?i.charAt(0)+i.charAt(0):i.substring(0,2),o=n?i.charAt(1)+i.charAt(1):i.substring(2,4),a=n?i.charAt(2)+i.charAt(2):i.substring(4,6);return[parseInt(r,16),parseInt(o,16),parseInt(a,16),1]}},void(n.Color.fromSource=function(t){var i=new e;return i.setSource(t),i}))}("undefined"!=typeof exports?exports:this),function(){function t(t){var e,i,n,r=t.getAttribute("style"),o=t.getAttribute("offset");if(o=parseFloat(o)/(/%$/.test(o)?100:1),r){var a=r.split(/\s*;\s*/);""===a[a.length-1]&&a.pop();for(var s=a.length;s--;){var l=a[s].split(/\s*:\s*/),c=l[0].trim(),h=l[1].trim();"stop-color"===c?e=h:"stop-opacity"===c&&(n=h)}}return e||(e=t.getAttribute("stop-color")||"rgb(0,0,0)"),n||(n=t.getAttribute("stop-opacity")),e=new fabric.Color(e),i=e.getAlpha(),n=isNaN(parseFloat(n))?1:parseFloat(n),n*=i,{offset:o,color:e.toRgb(),opacity:n}}function e(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}function i(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}function n(t,e){for(var i in e)if("string"==typeof e[i]&&/^\d+%$/.test(e[i])){var n=parseFloat(e[i],10);"x1"===i||"x2"===i||"r2"===i?e[i]=fabric.util.toFixed(t.width*n/100,2)+t.left:("y1"===i||"y2"===i)&&(e[i]=fabric.util.toFixed(t.height*n/100,2)+t.top)}}function r(t,e){for(var i in e)"x1"===i||"x2"===i||"r2"===i?e[i]=fabric.util.toFixed((e[i]-t.fill.origX)/t.width*100,2)+"%":("y1"===i||"y2"===i)&&(e[i]=fabric.util.toFixed((e[i]-t.fill.origY)/t.height*100,2)+"%")}fabric.Gradient=fabric.util.createClass({origX:0,origY:0,initialize:function(t){t||(t={});var e={};this.id=fabric.Object.__uid++,this.type=t.type||"linear",e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.gradientUnits=t.gradientUnits||"objectBoundingBox",this.colorStops=t.colorStops.slice(),t.gradientTransform&&(this.gradientTransform=t.gradientTransform),this.origX=t.left||this.origX,this.origY=t.top||this.origY},addColorStop:function(t){for(var e in t){var i=new fabric.Color(t[e]);this.colorStops.push({offset:e,color:i.toRgb(),opacity:i.getAlpha()})}return this},toObject:function(){return{type:this.type,coords:this.coords,gradientUnits:this.gradientUnits,colorStops:this.colorStops}},toSVG:function(t,e){var i,n,o=fabric.util.object.clone(this.coords);this.colorStops.sort(function(t,e){return t.offset-e.offset}),e&&"userSpaceOnUse"===this.gradientUnits?(o.x1+=t.width/2,o.y1+=t.height/2,o.x2+=t.width/2,o.y2+=t.height/2):"objectBoundingBox"===this.gradientUnits&&r(t,o),n='id="SVGID_'+this.id+'" gradientUnits="'+this.gradientUnits+'"',this.gradientTransform&&(n+=' gradientTransform="matrix('+this.gradientTransform.join(" ")+')" '),"linear"===this.type?i=["<linearGradient ",n,' x1="',o.x1,'" y1="',o.y1,'" x2="',o.x2,'" y2="',o.y2,'">\n']:"radial"===this.type&&(i=["<radialGradient ",n,' cx="',o.x2,'" cy="',o.y2,'" r="',o.r2,'" fx="',o.x1,'" fy="',o.y1,'">\n']);for(var a=0;a<this.colorStops.length;a++)i.push("<stop ",'offset="',100*this.colorStops[a].offset+"%",'" style="stop-color:',this.colorStops[a].color,null!=this.colorStops[a].opacity?";stop-opacity: "+this.colorStops[a].opacity:";",'"/>\n');return i.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),i.join("")},toLive:function(t){var e;if(this.type){"linear"===this.type?e=t.createLinearGradient(this.coords.x1,this.coords.y1,this.coords.x2,this.coords.y2):"radial"===this.type&&(e=t.createRadialGradient(this.coords.x1,this.coords.y1,this.coords.r1,this.coords.x2,this.coords.y2,this.coords.r2));for(var i=0,n=this.colorStops.length;n>i;i++){var r=this.colorStops[i].color,o=this.colorStops[i].opacity,a=this.colorStops[i].offset;"undefined"!=typeof o&&(r=new fabric.Color(r).setAlpha(o).toRgba()),e.addColorStop(parseFloat(a),r)}return e}}}),fabric.util.object.extend(fabric.Gradient,{fromElement:function(r,o){var a=r.getElementsByTagName("stop"),s="linearGradient"===r.nodeName?"linear":"radial",l=r.getAttribute("gradientUnits")||"objectBoundingBox",c=r.getAttribute("gradientTransform"),h=[],u={};"linear"===s?u=e(r):"radial"===s&&(u=i(r));for(var f=a.length;f--;)h.push(t(a[f]));n(o,u);var d=new fabric.Gradient({type:s,coords:u,gradientUnits:l,colorStops:h});return c&&(d.gradientTransform=fabric.parseTransformAttribute(c)),d},forObject:function(t,e){return e||(e={}),n(t,e),new fabric.Gradient(e)}})}(),fabric.Pattern=fabric.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,initialize:function(t){if(t||(t={}),this.id=fabric.Object.__uid++,t.source)if("string"==typeof t.source)if("undefined"!=typeof fabric.util.getFunctionBody(t.source))this.source=new Function(fabric.util.getFunctionBody(t.source));else{var e=this;this.source=fabric.util.createImage(),fabric.util.loadImage(t.source,function(t){e.source=t})}else this.source=t.source;t.repeat&&(this.repeat=t.repeat),t.offsetX&&(this.offsetX=t.offsetX),t.offsetY&&(this.offsetY=t.offsetY)},toObject:function(){var t;return"function"==typeof this.source?t=String(this.source):"string"==typeof this.source.src&&(t=this.source.src),{source:t,repeat:this.repeat,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,i=e.width/t.getWidth(),n=e.height/t.getHeight(),r="";return e.src?r=e.src:e.toDataURL&&(r=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+this.offsetX+'" y="'+this.offsetY+'" width="'+i+'" height="'+n+'"><image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+r+'"></image></pattern>'},toLive:function(t){var e="function"==typeof this.source?this.source():this.source;if(!e)return"";if("undefined"!=typeof e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}}),function(t){"use strict";var e=t.fabric||(t.fabric={});return e.Shadow?void e.warn("fabric.Shadow is already defined."):(e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,initialize:function(t){"string"==typeof t&&(t=this._parseShadow(t));for(var i in t)this[i]=t[i];this.id=e.Object.__uid++},_parseShadow:function(t){var i=t.trim(),n=e.Shadow.reOffsetsAndBlur.exec(i)||[],r=i.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:r.trim(),offsetX:parseInt(n[1],10)||0,offsetY:parseInt(n[2],10)||0,blur:parseInt(n[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var e="SourceAlpha";return!t||t.fill!==this.color&&t.stroke!==this.color||(e="SourceGraphic"),'<filter id="SVGID_'+this.id+'" y="-40%" height="180%"><feGaussianBlur in="'+e+'" stdDeviation="'+(this.blur?this.blur/3:0)+'"></feGaussianBlur><feOffset dx="'+this.offsetX+'" dy="'+this.offsetY+'"></feOffset><feMerge><feMergeNode></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter>'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY};var t={},i=e.Shadow.prototype;return this.color!==i.color&&(t.color=this.color),this.blur!==i.blur&&(t.blur=this.blur),this.offsetX!==i.offsetX&&(t.offsetX=this.offsetX),this.offsetY!==i.offsetY&&(t.offsetY=this.offsetY),t}}),void(e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/))}("undefined"!=typeof exports?exports:this),function(){"use strict";if(fabric.StaticCanvas)return void fabric.warn("fabric.StaticCanvas is already defined.");var t=fabric.util.object.extend,e=fabric.util.getElementOffset,i=fabric.util.removeFromArray,n=new Error("Could not initialize `canvas` element");fabric.StaticCanvas=fabric.util.createClass({initialize:function(t,e){e||(e={}),this._initStatic(t,e),fabric.StaticCanvas.activeInstance=this},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:[1,0,0,1,0,0],onBeforeScaleRotate:function(){},_initStatic:function(t,e){this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this._setImageSmoothing(),e.overlayImage&&this.setOverlayImage(e.overlayImage,this.renderAll.bind(this)),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,this.renderAll.bind(this)),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,this.renderAll.bind(this)),e.overlayColor&&this.setOverlayColor(e.overlayColor,this.renderAll.bind(this)),this.calcOffset()},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,i){return this.__setBgOverlayImage("overlayImage",t,e,i)},setBackgroundImage:function(t,e,i){return this.__setBgOverlayImage("backgroundImage",t,e,i)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},_setImageSmoothing:function(){var t=this.getContext();t.imageSmoothingEnabled=this.imageSmoothingEnabled,t.webkitImageSmoothingEnabled=this.imageSmoothingEnabled,t.mozImageSmoothingEnabled=this.imageSmoothingEnabled,t.msImageSmoothingEnabled=this.imageSmoothingEnabled,t.oImageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(t,e,i,n){return"string"==typeof e?fabric.util.loadImage(e,function(e){this[t]=new fabric.Image(e,n),i&&i()},this):(this[t]=e,i&&i()),this},__setBgOverlayColor:function(t,e,i){if(e&&e.source){var n=this;fabric.util.loadImage(e.source,function(r){n[t]=new fabric.Pattern({source:r,repeat:e.repeat,offsetX:e.offsetX,offsetY:e.offsetY}),i&&i()})}else this[t]=e,i&&i();return this},_createCanvasElement:function(){var t=fabric.document.createElement("canvas");if(t.style||(t.style={}),!t)throw n;return this._initCanvasElement(t),t},_initCanvasElement:function(t){if(fabric.util.createCanvasElement(t),"undefined"==typeof t.getContext)throw n},_initOptions:function(t){for(var e in t)this[e]=t[e];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0,this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0,this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){this.lowerCanvasEl=fabric.util.getById(t)||this._createCanvasElement(),this._initCanvasElement(this.lowerCanvasEl),fabric.util.addClass(this.lowerCanvasEl,"lower-canvas"),this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var i;e=e||{};for(var n in t)i=t[n],e.cssOnly||(this._setBackstoreDimension(n,t[n]),i+="px"),e.backstoreOnly||this._setCssDimension(n,i);return e.cssOnly||this.renderAll(),this.calcOffset(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},setViewportTransform:function(t){this.viewportTransform=t,this.renderAll();for(var e=0,i=this._objects.length;i>e;e++)this._objects[e].setCoords();return this},zoomToPoint:function(t,e){var i=t;t=fabric.util.transformPoint(t,fabric.util.invertTransform(this.viewportTransform)),this.viewportTransform[0]=e,this.viewportTransform[3]=e;var n=fabric.util.transformPoint(t,this.viewportTransform);this.viewportTransform[4]+=i.x-n.x,this.viewportTransform[5]+=i.y-n.y,this.renderAll();for(var r=0,o=this._objects.length;o>r;r++)this._objects[r].setCoords();return this},setZoom:function(t){return this.zoomToPoint(new fabric.Point(0,0),t),this},absolutePan:function(t){this.viewportTransform[4]=-t.x,this.viewportTransform[5]=-t.y,this.renderAll();for(var e=0,i=this._objects.length;i>e;e++)this._objects[e].setCoords();return this},relativePan:function(t){return this.absolutePan(new fabric.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(t,e){if(e){t.save();var i=this.viewportTransform;t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),e.render(t),t.restore(),this.controlsAboveOverlay||e._renderControls(t)}},_onObjectAdded:function(t){this.stateful&&t.setupState(),t.canvas=this,t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.getActiveObject()===t&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared")),this.fire("object:removed",{target:t}),t.fire("removed")},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this._objects.length=0,this.discardActiveGroup&&this.discardActiveGroup(),this.discardActiveObject&&this.discardActiveObject(),this.clearContext(this.contextContainer),this.contextTop&&this.clearContext(this.contextTop),this.fire("canvas:cleared"),this.renderAll(),this},renderAll:function(t){var e=this[t===!0&&this.interactive?"contextTop":"contextContainer"],i=this.getActiveGroup();return this.contextTop&&this.selection&&!this._groupSelector&&this.clearContext(this.contextTop),t||this.clearContext(e),this.fire("before:render"),this.clipTo&&fabric.util.clipContext(this,e),this._renderBackground(e),this._renderObjects(e,i),this._renderActiveGroup(e,i),this.clipTo&&e.restore(),this._renderOverlay(e),this.controlsAboveOverlay&&this.interactive&&this.drawControls(e),this.fire("after:render"),this},_renderObjects:function(t,e){var i,n;if(e)for(i=0,n=this._objects.length;n>i;++i)this._objects[i]&&!e.contains(this._objects[i])&&this._draw(t,this._objects[i]);else for(i=0,n=this._objects.length;n>i;++i)this._draw(t,this._objects[i])},_renderActiveGroup:function(t,e){if(e){var i=[];this.forEachObject(function(t){e.contains(t)&&i.push(t)}),e._set("objects",i),this._draw(t,e)}},_renderBackground:function(t){this.backgroundColor&&(t.fillStyle=this.backgroundColor.toLive?this.backgroundColor.toLive(t):this.backgroundColor,t.fillRect(this.backgroundColor.offsetX||0,this.backgroundColor.offsetY||0,this.width,this.height)),this.backgroundImage&&this._draw(t,this.backgroundImage)},_renderOverlay:function(t){this.overlayColor&&(t.fillStyle=this.overlayColor.toLive?this.overlayColor.toLive(t):this.overlayColor,t.fillRect(this.overlayColor.offsetX||0,this.overlayColor.offsetY||0,this.width,this.height)),this.overlayImage&&this._draw(t,this.overlayImage)},renderTop:function(){var t=this.contextTop||this.contextContainer;this.clearContext(t),this.selection&&this._groupSelector&&this._drawSelection();var e=this.getActiveGroup();return e&&e.render(t),this._renderOverlay(t),this.fire("after:render"),this},getCenter:function(){return{top:this.getHeight()/2,left:this.getWidth()/2}},centerObjectH:function(t){return this._centerObject(t,new fabric.Point(this.getCenter().left,t.getCenterPoint().y)),this.renderAll(),this},centerObjectV:function(t){return this._centerObject(t,new fabric.Point(t.getCenterPoint().x,this.getCenter().top)),this.renderAll(),this},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new fabric.Point(e.left,e.top)),this.renderAll(),this},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,i){var n=this.getActiveGroup();n&&this.discardActiveGroup();var r={objects:this._toObjects(e,i)};return t(r,this.__serializeBgOverlay()),fabric.util.populateWithProperties(this,r,i),n&&(this.setActiveGroup(new fabric.Group(n.getObjects(),{originX:"center",originY:"center"})),n.forEachObject(function(t){t.set("active",!0)}),this._currentTransform&&(this._currentTransform.target=this.getActiveGroup())),r},_toObjects:function(t,e){return this.getObjects().map(function(i){return this._toObject(i,t,e)},this)},_toObject:function(t,e,i){var n;this.includeDefaultValues||(n=t.includeDefaultValues,t.includeDefaultValues=!1);var r=t[e](i);return this.includeDefaultValues||(t.includeDefaultValues=n),r},__serializeBgOverlay:function(){var t={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};return this.overlayColor&&(t.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor),this.backgroundImage&&(t.backgroundImage=this.backgroundImage.toObject()),this.overlayImage&&(t.overlayImage=this.overlayImage.toObject()),t},toSVG:function(t,e){t||(t={});var i=[];return this._setSVGPreamble(i,t),this._setSVGHeader(i,t),this._setSVGBgOverlayColor(i,"backgroundColor"),this._setSVGBgOverlayImage(i,"backgroundImage"),this._setSVGObjects(i,e),this._setSVGBgOverlayColor(i,"overlayColor"),this._setSVGBgOverlayImage(i,"overlayImage"),i.push("</svg>"),i.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',e.viewBox?e.viewBox.width:this.width,'" ','height="',e.viewBox?e.viewBox.height:this.height,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':null,e.viewBox?'viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':null,'xml:space="preserve">',"<desc>Created with Fabric.js ",fabric.version,"</desc>","<defs>",fabric.createSVGFontFacesMarkup(this.getObjects()),fabric.createSVGRefElementsMarkup(this),"</defs>")},_setSVGObjects:function(t,e){var i=this.getActiveGroup();i&&this.discardActiveGroup();for(var n=0,r=this.getObjects(),o=r.length;o>n;n++)t.push(r[n].toSVG(e));i&&(this.setActiveGroup(new fabric.Group(i.getObjects())),i.forEachObject(function(t){t.set("active",!0)}))},_setSVGBgOverlayImage:function(t,e){this[e]&&this[e].toSVG&&t.push(this[e].toSVG())},_setSVGBgOverlayColor:function(t,e){this[e]&&this[e].source?t.push('<rect x="',this[e].offsetX,'" y="',this[e].offsetY,'" ','width="',"repeat-y"===this[e].repeat||"no-repeat"===this[e].repeat?this[e].source.width:this.width,'" height="',"repeat-x"===this[e].repeat||"no-repeat"===this[e].repeat?this[e].source.height:this.height,'" fill="url(#'+e+'Pattern)"',"></rect>"):this[e]&&"overlayColor"===e&&t.push('<rect x="0" y="0" ','width="',this.width,'" height="',this.height,'" fill="',this[e],'"',"></rect>")},sendToBack:function(t){return i(this._objects,t),this._objects.unshift(t),this.renderAll&&this.renderAll()},bringToFront:function(t){return i(this._objects,t),this._objects.push(t),this.renderAll&&this.renderAll()},sendBackwards:function(t,e){var n=this._objects.indexOf(t);if(0!==n){var r=this._findNewLowerIndex(t,n,e);i(this._objects,t),this._objects.splice(r,0,t),this.renderAll&&this.renderAll()}return this},_findNewLowerIndex:function(t,e,i){var n;if(i){n=e;for(var r=e-1;r>=0;--r){var o=t.intersectsWithObject(this._objects[r])||t.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(t);if(o){n=r;break}}}else n=e-1;return n},bringForward:function(t,e){var n=this._objects.indexOf(t);if(n!==this._objects.length-1){var r=this._findNewUpperIndex(t,n,e);i(this._objects,t),this._objects.splice(r,0,t),this.renderAll&&this.renderAll()}return this},_findNewUpperIndex:function(t,e,i){var n;if(i){n=e;for(var r=e+1;r<this._objects.length;++r){var o=t.intersectsWithObject(this._objects[r])||t.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(t);if(o){n=r;break}}}else n=e+1;return n},moveTo:function(t,e){return i(this._objects,t),this._objects.splice(e,0,t),this.renderAll&&this.renderAll()},dispose:function(){return this.clear(),this.interactive&&this.removeListeners(),this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"}}),t(fabric.StaticCanvas.prototype,fabric.Observable),t(fabric.StaticCanvas.prototype,fabric.Collection),t(fabric.StaticCanvas.prototype,fabric.DataURLExporter),t(fabric.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=fabric.util.createCanvasElement();if(!e||!e.getContext)return null;var i=e.getContext("2d");if(!i)return null;switch(t){case"getImageData":return"undefined"!=typeof i.getImageData;case"setLineDash":return"undefined"!=typeof i.setLineDash;case"toDataURL":return"undefined"!=typeof e.toDataURL;case"toDataURLWithQuality":try{return e.toDataURL("image/jpeg",0),!0}catch(n){}return!1;default:return null}}}),fabric.StaticCanvas.prototype.toJSON=fabric.StaticCanvas.prototype.toObject}(),fabric.BaseBrush=fabric.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",setShadow:function(t){return this.shadow=new fabric.Shadow(t),this},_setBrushStyles:function(){var t=this.canvas.contextTop;
t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin},_setShadow:function(){if(this.shadow){var t=this.canvas.contextTop;t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offsetX,t.shadowOffsetY=this.shadow.offsetY}},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0}}),function(){var t=fabric.util.array.min,e=fabric.util.array.max;fabric.PencilBrush=fabric.util.createClass(fabric.BaseBrush,{initialize:function(t){this.canvas=t,this._points=[]},onMouseDown:function(t){this._prepareForDrawing(t),this._captureDrawingPath(t),this._render()},onMouseMove:function(t){this._captureDrawingPath(t),this.canvas.clearContext(this.canvas.contextTop),this._render()},onMouseUp:function(){this._finalizeAndAddPath()},_prepareForDrawing:function(t){var e=new fabric.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){this._points.push(t)},_reset:function(){this._points.length=0,this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(t){var e=new fabric.Point(t.x,t.y);this._addPoint(e)},_render:function(){var t=this.canvas.contextTop,e=this.canvas.viewportTransform,i=this._points[0],n=this._points[1];t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.beginPath(),2===this._points.length&&i.x===n.x&&i.y===n.y&&(i.x-=.5,n.x+=.5),t.moveTo(i.x,i.y);for(var r=1,o=this._points.length;o>r;r++){var a=i.midPointFrom(n);t.quadraticCurveTo(i.x,i.y,a.x,a.y),i=this._points[r],n=this._points[r+1]}t.lineTo(i.x,i.y),t.stroke(),t.restore()},_getSVGPathData:function(){return this.box=this.getPathBoundingBox(this._points),this.convertPointsToSVGPath(this._points,this.box.minX,this.box.minY)},getPathBoundingBox:function(i){for(var n=[],r=[],o=i[0],a=i[1],s=o,l=1,c=i.length;c>l;l++){var h=o.midPointFrom(a);n.push(s.x),n.push(h.x),r.push(s.y),r.push(h.y),o=i[l],a=i[l+1],s=h}return n.push(o.x),r.push(o.y),{minX:t(n),minY:t(r),maxX:e(n),maxY:e(r)}},convertPointsToSVGPath:function(t,e,i){var n=[],r=new fabric.Point(t[0].x-e,t[0].y-i),o=new fabric.Point(t[1].x-e,t[1].y-i);n.push("M ",t[0].x-e," ",t[0].y-i," ");for(var a=1,s=t.length;s>a;a++){var l=r.midPointFrom(o);n.push("Q ",r.x," ",r.y," ",l.x," ",l.y," "),r=new fabric.Point(t[a].x-e,t[a].y-i),a+1<t.length&&(o=new fabric.Point(t[a+1].x-e,t[a+1].y-i))}return n.push("L ",r.x," ",r.y," "),n},createPath:function(t){var e=new fabric.Path(t);return e.fill=null,e.stroke=this.color,e.strokeWidth=this.width,e.strokeLineCap=this.strokeLineCap,e.strokeLineJoin=this.strokeLineJoin,this.shadow&&(this.shadow.affectStroke=!0,e.setShadow(this.shadow)),e},_finalizeAndAddPath:function(){var t=this.canvas.contextTop;t.closePath();var e=this._getSVGPathData().join("");if("M 0 0 Q 0 0 0 0 L 0 0"===e)return void this.canvas.renderAll();var i=this.box.minX+(this.box.maxX-this.box.minX)/2,n=this.box.minY+(this.box.maxY-this.box.minY)/2;this.canvas.contextTop.arc(i,n,3,0,2*Math.PI,!1);var r=this.createPath(e);r.set({left:i,top:n,originX:"center",originY:"center"}),this.canvas.add(r),r.setCoords(),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderAll(),this.canvas.fire("path:created",{path:r})}})}(),fabric.CircleBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),i=this.canvas.contextTop,n=this.canvas.viewportTransform;i.save(),i.transform(n[0],n[1],n[2],n[3],n[4],n[5]),i.fillStyle=e.fill,i.beginPath(),i.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),i.closePath(),i.fill(),i.restore()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},onMouseMove:function(t){this.drawDot(t)},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,n=this.points.length;n>i;i++){var r=this.points[i],o=new fabric.Circle({radius:r.radius,left:r.x,top:r.y,originX:"center",originY:"center",fill:r.fill});this.shadow&&o.setShadow(this.shadow),e.push(o)}var a=new fabric.Group(e,{originX:"center",originY:"center"});a.canvas=this.canvas,this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.renderAll()},addPoint:function(t){var e=new fabric.Point(t.x,t.y),i=fabric.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,n=new fabric.Color(this.color).setAlpha(fabric.util.getRandomInt(0,100)/100).toRgba();return e.radius=i,e.fill=n,this.points.push(e),e}}),fabric.SprayBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render()},onMouseMove:function(t){this.addSprayChunk(t),this.render()},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],i=0,n=this.sprayChunks.length;n>i;i++)for(var r=this.sprayChunks[i],o=0,a=r.length;a>o;o++){var s=new fabric.Rect({width:r[o].width,height:r[o].width,left:r[o].x+1,top:r[o].y+1,originX:"center",originY:"center",fill:this.color});this.shadow&&s.setShadow(this.shadow),e.push(s)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var l=new fabric.Group(e,{originX:"center",originY:"center"});l.canvas=this.canvas,this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.renderAll()},_getOptimizedRects:function(t){for(var e,i={},n=0,r=t.length;r>n;n++)e=t[n].left+""+t[n].top,i[e]||(i[e]=t[n]);var o=[];for(e in i)o.push(i[e]);return o},render:function(){var t=this.canvas.contextTop;t.fillStyle=this.color;var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]);for(var i=0,n=this.sprayChunkPoints.length;n>i;i++){var r=this.sprayChunkPoints[i];"undefined"!=typeof r.opacity&&(t.globalAlpha=r.opacity),t.fillRect(r.x,r.y,r.width,r.width)}t.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];for(var e,i,n,r=this.width/2,o=0;o<this.density;o++){e=fabric.util.getRandomInt(t.x-r,t.x+r),i=fabric.util.getRandomInt(t.y-r,t.y+r),n=this.dotWidthVariance?fabric.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var a=new fabric.Point(e,i);a.width=n,this.randomOpacity&&(a.opacity=fabric.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}}),fabric.PatternBrush=fabric.util.createClass(fabric.PencilBrush,{getPatternSrc:function(){var t=20,e=5,i=fabric.document.createElement("canvas"),n=i.getContext("2d");return i.width=i.height=t+e,n.fillStyle=this.color,n.beginPath(),n.arc(t/2,t/2,t/2,0,2*Math.PI,!1),n.closePath(),n.fill(),i},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(t){var e=this.callSuper("createPath",t);return e.stroke=new fabric.Pattern({source:this.source||this.getPatternSrcFunction()}),e}}),function(){var t=fabric.util.getPointer,e=fabric.util.degreesToRadians,i=fabric.util.radiansToDegrees,n=Math.atan2,r=Math.abs,o=.5;fabric.Canvas=fabric.util.createClass(fabric.StaticCanvas,{initialize:function(t,e){e||(e={}),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas(),fabric.Canvas.activeInstance=this},uniScaleTransform:!1,centeredScaling:!1,centeredRotation:!1,interactive:!0,selection:!0,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this.freeDrawingBrush=fabric.PencilBrush&&new fabric.PencilBrush(this),this.calcOffset()},_resetCurrentTransform:function(t){var e=this._currentTransform;e.target.set({scaleX:e.original.scaleX,scaleY:e.original.scaleY,left:e.original.left,top:e.original.top}),this._shouldCenterTransform(t,e.target)?"rotate"===e.action?this._setOriginToCenter(e.target):("center"!==e.originX&&(e.mouseXSign="right"===e.originX?-1:1),"center"!==e.originY&&(e.mouseYSign="bottom"===e.originY?-1:1),e.originX="center",e.originY="center"):(e.originX=e.original.originX,e.originY=e.original.originY)},containsPoint:function(t,e){var i=this.getPointer(t,!0),n=this._normalizePointer(e,i);return e.containsPoint(n)||e._findTargetCorner(i)},_normalizePointer:function(t,e){var i,n=this.getActiveGroup(),r=e.x,o=e.y,a=n&&"group"!==t.type&&n.contains(t);return a&&(i=new fabric.Point(n.left,n.top),i=fabric.util.transformPoint(i,this.viewportTransform,!0),r-=i.x,o-=i.y),{x:r,y:o}},isTargetTransparent:function(t,e,i){var n=t.hasBorders,r=t.transparentCorners;t.hasBorders=t.transparentCorners=!1,this._draw(this.contextCache,t),t.hasBorders=n,t.transparentCorners=r;var o=fabric.util.isTransparent(this.contextCache,e,i,this.targetFindTolerance);return this.clearContext(this.contextCache),o},_shouldClearSelection:function(t,e){var i=this.getActiveGroup(),n=this.getActiveObject();return!e||e&&i&&!i.contains(e)&&i!==e&&!t.shiftKey||e&&!e.evented||e&&!e.selectable&&n&&n!==e},_shouldCenterTransform:function(t,e){if(e){var i,n=this._currentTransform;return"scale"===n.action||"scaleX"===n.action||"scaleY"===n.action?i=this.centeredScaling||e.centeredScaling:"rotate"===n.action&&(i=this.centeredRotation||e.centeredRotation),i?!t.altKey:t.altKey}},_getOriginFromCorner:function(t,e){var i={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?i.x="right":("mr"===e||"tr"===e||"br"===e)&&(i.x="left"),"tl"===e||"mt"===e||"tr"===e?i.y="bottom":("bl"===e||"mb"===e||"br"===e)&&(i.y="top"),i},_getActionFromCorner:function(t,e){var i="drag";return e&&(i="ml"===e||"mr"===e?"scaleX":"mt"===e||"mb"===e?"scaleY":"mtr"===e?"rotate":"scale"),i},_setupCurrentTransform:function(t,i){if(i){var n=this.getPointer(t),r=i._findTargetCorner(this.getPointer(t,!0)),o=this._getActionFromCorner(i,r),a=this._getOriginFromCorner(i,r);this._currentTransform={target:i,action:o,scaleX:i.scaleX,scaleY:i.scaleY,offsetX:n.x-i.left,offsetY:n.y-i.top,originX:a.x,originY:a.y,ex:n.x,ey:n.y,left:i.left,top:i.top,theta:e(i.angle),width:i.width*i.scaleX,mouseXSign:1,mouseYSign:1},this._currentTransform.original={left:i.left,top:i.top,scaleX:i.scaleX,scaleY:i.scaleY,originX:a.x,originY:a.y},this._resetCurrentTransform(t)}},_translateObject:function(t,e){var i=this._currentTransform.target;i.get("lockMovementX")||i.set("left",t-this._currentTransform.offsetX),i.get("lockMovementY")||i.set("top",e-this._currentTransform.offsetY)},_scaleObject:function(t,e,i){var n=this._currentTransform,r=n.target,o=r.get("lockScalingX"),a=r.get("lockScalingY"),s=r.get("lockScalingFlip");if(!o||!a){var l=r.translateToOriginPoint(r.getCenterPoint(),n.originX,n.originY),c=r.toLocalPoint(new fabric.Point(t,e),n.originX,n.originY);this._setLocalMouse(c,n),this._setObjectScale(c,n,o,a,i,s),r.setPositionByOrigin(l,n.originX,n.originY)}},_setObjectScale:function(t,e,i,n,r,o){var a=e.target,s=!1,l=!1;e.newScaleX=t.x/(a.width+a.strokeWidth),e.newScaleY=t.y/(a.height+a.strokeWidth),o&&e.newScaleX<=0&&e.newScaleX<a.scaleX&&(s=!0),o&&e.newScaleY<=0&&e.newScaleY<a.scaleY&&(l=!0),"equally"!==r||i||n?r?"x"!==r||a.get("lockUniScaling")?"y"!==r||a.get("lockUniScaling")||l||n||a.set("scaleY",e.newScaleY):s||i||a.set("scaleX",e.newScaleX):(s||i||a.set("scaleX",e.newScaleX),l||n||a.set("scaleY",e.newScaleY)):s||l||this._scaleObjectEqually(t,a,e),s||l||this._flipObject(e)},_scaleObjectEqually:function(t,e,i){var n=t.y+t.x,r=(e.height+e.strokeWidth)*i.original.scaleY+(e.width+e.strokeWidth)*i.original.scaleX;i.newScaleX=i.original.scaleX*n/r,i.newScaleY=i.original.scaleY*n/r,e.set("scaleX",i.newScaleX),e.set("scaleY",i.newScaleY)},_flipObject:function(t){t.newScaleX<0&&("left"===t.originX?t.originX="right":"right"===t.originX&&(t.originX="left")),t.newScaleY<0&&("top"===t.originY?t.originY="bottom":"bottom"===t.originY&&(t.originY="top"))},_setLocalMouse:function(t,e){var i=e.target;"right"===e.originX?t.x*=-1:"center"===e.originX&&(t.x*=2*e.mouseXSign,t.x<0&&(e.mouseXSign=-e.mouseXSign)),"bottom"===e.originY?t.y*=-1:"center"===e.originY&&(t.y*=2*e.mouseYSign,t.y<0&&(e.mouseYSign=-e.mouseYSign)),r(t.x)>i.padding?t.x<0?t.x+=i.padding:t.x-=i.padding:t.x=0,r(t.y)>i.padding?t.y<0?t.y+=i.padding:t.y-=i.padding:t.y=0},_rotateObject:function(t,e){var r=this._currentTransform;if(!r.target.get("lockRotation")){var o=n(r.ey-r.top,r.ex-r.left),a=n(e-r.top,t-r.left),s=i(a-o+r.theta);0>s&&(s=360+s),r.target.angle=s}},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.setAngle(0)},_drawSelection:function(){var t=this.contextTop,e=this._groupSelector,i=e.left,n=e.top,a=r(i),s=r(n);if(t.fillStyle=this.selectionColor,t.fillRect(e.ex-(i>0?0:-i),e.ey-(n>0?0:-n),a,s),t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,this.selectionDashArray.length>1){var l=e.ex+o-(i>0?0:a),c=e.ey+o-(n>0?0:s);t.beginPath(),fabric.util.drawDashedLine(t,l,c,l+a,c,this.selectionDashArray),fabric.util.drawDashedLine(t,l,c+s-1,l+a,c+s-1,this.selectionDashArray),fabric.util.drawDashedLine(t,l,c,l,c+s,this.selectionDashArray),fabric.util.drawDashedLine(t,l+a-1,c,l+a-1,c+s,this.selectionDashArray),t.closePath(),t.stroke()}else t.strokeRect(e.ex+o-(i>0?0:a),e.ey+o-(n>0?0:s),a,s)},_isLastRenderedObject:function(t){return this.controlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay.visible&&this.containsPoint(t,this.lastRenderedObjectWithControlsAboveOverlay)&&this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(t,!0))},findTarget:function(t,e){if(!this.skipTargetFind){if(this._isLastRenderedObject(t))return this.lastRenderedObjectWithControlsAboveOverlay;var i=this.getActiveGroup();if(i&&!e&&this.containsPoint(t,i))return i;var n=this._searchPossibleTargets(t);return this._fireOverOutEvents(n),n}},_fireOverOutEvents:function(t){t?this._hoveredTarget!==t&&(this.fire("mouse:over",{target:t}),t.fire("mouseover"),this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout")),this._hoveredTarget=t):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null)},_checkTarget:function(t,e,i){if(e&&e.visible&&e.evented&&this.containsPoint(t,e)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;var n=this.isTargetTransparent(e,i.x,i.y);if(!n)return!0}},_searchPossibleTargets:function(t){for(var e,i=this.getPointer(t,!0),n=this._objects.length;n--;)if(this._checkTarget(t,this._objects[n],i)){this.relatedTarget=this._objects[n],e=this._objects[n];break}return e},getPointer:function(e,i,n){n||(n=this.upperCanvasEl);var r,o=t(e,n),a=n.getBoundingClientRect();return this.calcOffset(),o.x=o.x-this._offset.left,o.y=o.y-this._offset.top,i||(o=fabric.util.transformPoint(o,fabric.util.invertTransform(this.viewportTransform))),r=0===a.width||0===a.height?{width:1,height:1}:{width:n.width/a.width,height:n.height/a.height},{x:o.x*r.width,y:o.y*r.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement(),fabric.util.addClass(this.upperCanvasEl,"upper-canvas "+t),this.wrapperEl.appendChild(this.upperCanvasEl),this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl),this._applyCanvasStyle(this.upperCanvasEl),this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=fabric.util.wrapElement(this.lowerCanvasEl,"div",{"class":this.containerClass}),fabric.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"}),fabric.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.getWidth()||t.width,i=this.getHeight()||t.height;fabric.util.setStyle(t,{position:"absolute",width:e+"px",height:i+"px",left:0,top:0}),t.width=e,t.height=i,fabric.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(t){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=t,t.set("active",!0)},setActiveObject:function(t,e){return this._setActiveObject(t),this.renderAll(),this.fire("object:selected",{target:t,e:e}),t.fire("selected",{e:e}),this},getActiveObject:function(){return this._activeObject},_discardActiveObject:function(){this._activeObject&&this._activeObject.set("active",!1),this._activeObject=null},discardActiveObject:function(t){return this._discardActiveObject(),this.renderAll(),this.fire("selection:cleared",{e:t}),this},_setActiveGroup:function(t){this._activeGroup=t,t&&t.set("active",!0)},setActiveGroup:function(t,e){return this._setActiveGroup(t),t&&(this.fire("object:selected",{target:t,e:e}),t.fire("selected",{e:e})),this},getActiveGroup:function(){return this._activeGroup},_discardActiveGroup:function(){var t=this.getActiveGroup();t&&t.destroy(),this.setActiveGroup(null)},discardActiveGroup:function(t){return this._discardActiveGroup(),this.fire("selection:cleared",{e:t}),this},deactivateAll:function(){for(var t=this.getObjects(),e=0,i=t.length;i>e;e++)t[e].set("active",!1);return this._discardActiveGroup(),this._discardActiveObject(),this},deactivateAllWithDispatch:function(t){var e=this.getActiveGroup()||this.getActiveObject();return e&&this.fire("before:selection:cleared",{target:e,e:t}),this.deactivateAll(),e&&this.fire("selection:cleared",{e:t}),this},drawControls:function(t){var e=this.getActiveGroup();e?this._drawGroupControls(t,e):this._drawObjectsControls(t)},_drawGroupControls:function(t,e){e._renderControls(t)},_drawObjectsControls:function(t){for(var e=0,i=this._objects.length;i>e;++e)this._objects[e]&&this._objects[e].active&&(this._objects[e]._renderControls(t),this.lastRenderedObjectWithControlsAboveOverlay=this._objects[e])}});for(var a in fabric.StaticCanvas)"prototype"!==a&&(fabric.Canvas[a]=fabric.StaticCanvas[a]);fabric.isTouchSupported&&(fabric.Canvas.prototype._setCursorFromEvent=function(){}),fabric.Element=fabric.Canvas}(),function(){var t={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},e=fabric.util.addListener,i=fabric.util.removeListener;fabric.util.object.extend(fabric.Canvas.prototype,{cursorMap:["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],_initEventListeners:function(){this._bindEvents(),e(fabric.window,"resize",this._onResize),e(this.upperCanvasEl,"mousedown",this._onMouseDown),e(this.upperCanvasEl,"mousemove",this._onMouseMove),e(this.upperCanvasEl,"mousewheel",this._onMouseWheel),e(this.upperCanvasEl,"touchstart",this._onMouseDown),e(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof Event&&"add"in Event&&(Event.add(this.upperCanvasEl,"gesture",this._onGesture),Event.add(this.upperCanvasEl,"drag",this._onDrag),Event.add(this.upperCanvasEl,"orientation",this._onOrientationChange),Event.add(this.upperCanvasEl,"shake",this._onShake))},_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this)},removeListeners:function(){i(fabric.window,"resize",this._onResize),i(this.upperCanvasEl,"mousedown",this._onMouseDown),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"mousewheel",this._onMouseWheel),i(this.upperCanvasEl,"touchstart",this._onMouseDown),i(this.upperCanvasEl,"touchmove",this._onMouseMove),"undefined"!=typeof Event&&"remove"in Event&&(Event.remove(this.upperCanvasEl,"gesture",this._onGesture),Event.remove(this.upperCanvasEl,"drag",this._onDrag),Event.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),Event.remove(this.upperCanvasEl,"shake",this._onShake))},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t,e){this.__onMouseWheel&&this.__onMouseWheel(t,e)},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onMouseDown:function(t){this.__onMouseDown(t),e(fabric.document,"touchend",this._onMouseUp),e(fabric.document,"touchmove",this._onMouseMove),i(this.upperCanvasEl,"mousemove",this._onMouseMove),i(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchstart"===t.type?i(this.upperCanvasEl,"mousedown",this._onMouseDown):(e(fabric.document,"mouseup",this._onMouseUp),e(fabric.document,"mousemove",this._onMouseMove))},_onMouseUp:function(t){if(this.__onMouseUp(t),i(fabric.document,"mouseup",this._onMouseUp),i(fabric.document,"touchend",this._onMouseUp),i(fabric.document,"mousemove",this._onMouseMove),i(fabric.document,"touchmove",this._onMouseMove),e(this.upperCanvasEl,"mousemove",this._onMouseMove),e(this.upperCanvasEl,"touchmove",this._onMouseMove),"touchend"===t.type){var n=this;setTimeout(function(){e(n.upperCanvasEl,"mousedown",n._onMouseDown)},400)}},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t,e){var i=this.getActiveGroup()||this.getActiveObject();return!!(t&&(t.isMoving||t!==i)||!t&&i||!t&&!i&&!this._groupSelector||e&&this._previousPointer&&this.selection&&(e.x!==this._previousPointer.x||e.y!==this._previousPointer.y))},__onMouseUp:function(t){var e;if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(t);this._currentTransform?(this._finalizeCurrentTransform(),e=this._currentTransform.target):e=this.findTarget(t,!0);var i=this._shouldRender(e,this.getPointer(t));this._maybeGroupObjects(t),e&&(e.isMoving=!1),i&&this.renderAll(),this._handleCursorAndEvent(t,e)},_handleCursorAndEvent:function(t,e){this._setCursorFromEvent(t,e);var i=this;setTimeout(function(){i._setCursorFromEvent(t,e)},50),this.fire("mouse:up",{target:e,e:t}),e&&e.fire("mouseup",{e:t})},_finalizeCurrentTransform:function(){var t=this._currentTransform,e=t.target;e._scaling&&(e._scaling=!1),e.setCoords(),this.stateful&&e.hasStateChanged()&&(this.fire("object:modified",{target:e}),e.fire("modified")),this._restoreOriginXY(e)},_restoreOriginXY:function(t){if(this._previousOriginX&&this._previousOriginY){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null}},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.discardActiveObject(t).renderAll(),this.clipTo&&fabric.util.clipContext(this,this.contextTop);var e=fabric.util.invertTransform(this.viewportTransform),i=fabric.util.transformPoint(this.getPointer(t,!0),e);this.freeDrawingBrush.onMouseDown(i),this.fire("mouse:down",{e:t})},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=fabric.util.invertTransform(this.viewportTransform),i=fabric.util.transformPoint(this.getPointer(t,!0),e);this.freeDrawingBrush.onMouseMove(i)}this.setCursor(this.freeDrawingCursor),this.fire("mouse:move",{e:t})},_onMouseUpInDrawingMode:function(t){this._isCurrentlyDrawing=!1,this.clipTo&&this.contextTop.restore(),this.freeDrawingBrush.onMouseUp(),this.fire("mouse:up",{e:t})},__onMouseDown:function(t){var e="which"in t?1===t.which:1===t.button;if(e||fabric.isTouchSupported){if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(t);if(!this._currentTransform){var i=this.findTarget(t),n=this.getPointer(t,!0);this._previousPointer=n;var r=this._shouldRender(i,n),o=this._shouldGroup(t,i);this._shouldClearSelection(t,i)?this._clearSelection(t,i,n):o&&(this._handleGrouping(t,i),i=this.getActiveGroup()),i&&i.selectable&&!o&&(this._beforeTransform(t,i),this._setupCurrentTransform(t,i)),r&&this.renderAll(),this.fire("mouse:down",{target:i,e:t}),i&&i.fire("mousedown",{e:t})}}},_beforeTransform:function(t,e){var i;this.stateful&&e.saveState(),(i=e._findTargetCorner(this.getPointer(t)))&&this.onBeforeScaleRotate(e),e!==this.getActiveGroup()&&e!==this.getActiveObject()&&(this.deactivateAll(),this.setActiveObject(e,t))},_clearSelection:function(t,e,i){this.deactivateAllWithDispatch(t),e&&e.selectable?this.setActiveObject(e,t):this.selection&&(this._groupSelector={ex:i.x,ey:i.y,top:0,left:0})},_setOriginToCenter:function(t){this._previousOriginX=this._currentTransform.target.originX,this._previousOriginY=this._currentTransform.target.originY;var e=t.getCenterPoint();t.originX="center",t.originY="center",t.left=e.x,t.top=e.y,this._currentTransform.left=t.left,this._currentTransform.top=t.top},_setCenterToOrigin:function(t){var e=t.translateToOriginPoint(t.getCenterPoint(),this._previousOriginX,this._previousOriginY);t.originX=this._previousOriginX,t.originY=this._previousOriginY,t.left=e.x,t.top=e.y,this._previousOriginX=null,this._previousOriginY=null},__onMouseMove:function(t){var e,i;if(this.isDrawingMode)return void this._onMouseMoveInDrawingMode(t);var n=this._groupSelector;n?(i=this.getPointer(t,!0),n.left=i.x-n.ex,n.top=i.y-n.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t),!e||e&&!e.selectable?this.setCursor(this.defaultCursor):this._setCursorFromEvent(t,e)),this.fire("mouse:move",{target:e,e:t}),e&&e.fire("mousemove",{e:t})},_transformObject:function(t){var e=this.getPointer(t),i=this._currentTransform;i.reset=!1,i.target.isMoving=!0,this._beforeScaleTransform(t,i),this._performTransformAction(t,i,e),this.renderAll()},_performTransformAction:function(t,e,i){var n=i.x,r=i.y,o=e.target,a=e.action;"rotate"===a?(this._rotateObject(n,r),this._fire("rotating",o,t)):"scale"===a?(this._onScale(t,e,n,r),this._fire("scaling",o,t)):"scaleX"===a?(this._scaleObject(n,r,"x"),this._fire("scaling",o,t)):"scaleY"===a?(this._scaleObject(n,r,"y"),this._fire("scaling",o,t)):(this._translateObject(n,r),this._fire("moving",o,t),this.setCursor(this.moveCursor))},_fire:function(t,e,i){this.fire("object:"+t,{target:e,e:i}),e.fire(t,{e:i})},_beforeScaleTransform:function(t,e){if("scale"===e.action||"scaleX"===e.action||"scaleY"===e.action){var i=this._shouldCenterTransform(t,e.target);(i&&("center"!==e.originX||"center"!==e.originY)||!i&&"center"===e.originX&&"center"===e.originY)&&(this._resetCurrentTransform(t),e.reset=!0)}},_onScale:function(t,e,i,n){!t.shiftKey&&!this.uniScaleTransform||e.target.get("lockUniScaling")?(e.reset||"scale"!==e.currentAction||this._resetCurrentTransform(t,e.target),e.currentAction="scaleEqually",this._scaleObject(i,n,"equally")):(e.currentAction="scale",this._scaleObject(i,n))},_setCursorFromEvent:function(t,e){if(!e||!e.selectable)return this.setCursor(this.defaultCursor),!1;var i=this.getActiveGroup(),n=e._findTargetCorner&&(!i||!i.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));return n?this._setCornerCursor(n,e):this.setCursor(e.hoverCursor||this.hoverCursor),!0},_setCornerCursor:function(e,i){if(e in t)this.setCursor(this._getRotatedCornerCursor(e,i));else{if("mtr"!==e||!i.hasRotatingPoint)return this.setCursor(this.defaultCursor),!1;this.setCursor(this.rotationCursor)}},_getRotatedCornerCursor:function(e,i){var n=Math.round(i.getAngle()%360/45);return 0>n&&(n+=8),n+=t[e],n%=8,this.cursorMap[n]}})}(),function(){var t=Math.min,e=Math.max;fabric.util.object.extend(fabric.Canvas.prototype,{_shouldGroup:function(t,e){var i=this.getActiveObject();return t.shiftKey&&(this.getActiveGroup()||i&&i!==e)&&this.selection},_handleGrouping:function(t,e){(e!==this.getActiveGroup()||(e=this.findTarget(t,!0),e&&!e.isType("group")))&&(this.getActiveGroup()?this._updateActiveGroup(e,t):this._createActiveGroup(e,t),this._activeGroup&&this._activeGroup.saveCoords())},_updateActiveGroup:function(t,e){var i=this.getActiveGroup();if(i.contains(t)){if(i.removeWithUpdate(t),this._resetObjectTransform(i),t.set("active",!1),1===i.size())return this.discardActiveGroup(e),void this.setActiveObject(i.item(0))}else i.addWithUpdate(t),this._resetObjectTransform(i);this.fire("selection:created",{target:i,e:e}),i.set("active",!0)},_createActiveGroup:function(t,e){if(this._activeObject&&t!==this._activeObject){var i=this._createGroup(t);i.addWithUpdate(),this.setActiveGroup(i),this._activeObject=null,this.fire("selection:created",{target:i,e:e})}t.set("active",!0)},_createGroup:function(t){var e=this.getObjects(),i=e.indexOf(this._activeObject)<e.indexOf(t),n=i?[this._activeObject,t]:[t,this._activeObject];return new fabric.Group(n,{originX:"center",originY:"center",canvas:this})},_groupSelectedObjects:function(t){var e=this._collectObjects();1===e.length?this.setActiveObject(e[0],t):e.length>1&&(e=new fabric.Group(e.reverse(),{originX:"center",originY:"center",canvas:this}),e.addWithUpdate(),this.setActiveGroup(e,t),e.saveCoords(),this.fire("selection:created",{target:e}),this.renderAll())},_collectObjects:function(){for(var i,n=[],r=this._groupSelector.ex,o=this._groupSelector.ey,a=r+this._groupSelector.left,s=o+this._groupSelector.top,l=new fabric.Point(t(r,a),t(o,s)),c=new fabric.Point(e(r,a),e(o,s)),h=r===a&&o===s,u=this._objects.length;u--&&(i=this._objects[u],!(i&&i.selectable&&i.visible&&(i.intersectsWithRect(l,c)||i.isContainedWithinRect(l,c)||i.containsPoint(l)||i.containsPoint(c))&&(i.set("active",!0),n.push(i),h))););return n},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t);var e=this.getActiveGroup();e&&(e.setObjectsCoords().setCoords(),e.isMoving=!1,this.setCursor(this.defaultCursor)),this._groupSelector=null,this._currentTransform=null}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",i=t.quality||1,n=t.multiplier||1,r={left:t.left,top:t.top,width:t.width,height:t.height};return 1!==n?this.__toDataURLWithMultiplier(e,i,r,n):this.__toDataURL(e,i,r)},__toDataURL:function(t,e,i){this.renderAll(!0);var n=this.upperCanvasEl||this.lowerCanvasEl,r=this.__getCroppedCanvas(n,i);"jpg"===t&&(t="jpeg");var o=fabric.StaticCanvas.supports("toDataURLWithQuality")?(r||n).toDataURL("image/"+t,e):(r||n).toDataURL("image/"+t);return this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),r&&(r=null),o},__getCroppedCanvas:function(t,e){var i,n,r="left"in e||"top"in e||"width"in e||"height"in e;return r&&(i=fabric.util.createCanvasElement(),n=i.getContext("2d"),i.width=e.width||this.width,i.height=e.height||this.height,n.drawImage(t,-e.left||0,-e.top||0)),i
},__toDataURLWithMultiplier:function(t,e,i,n){var r=this.getWidth(),o=this.getHeight(),a=r*n,s=o*n,l=this.getActiveObject(),c=this.getActiveGroup(),h=this.contextTop||this.contextContainer;n>1&&this.setWidth(a).setHeight(s),h.scale(n,n),i.left&&(i.left*=n),i.top&&(i.top*=n),i.width?i.width*=n:1>n&&(i.width=a),i.height?i.height*=n:1>n&&(i.height=s),c?this._tempRemoveBordersControlsFromGroup(c):l&&this.deactivateAll&&this.deactivateAll(),this.renderAll(!0);var u=this.__toDataURL(t,e,i);return this.width=r,this.height=o,h.scale(1/n,1/n),this.setWidth(r).setHeight(o),c?this._restoreBordersControlsOnGroup(c):l&&this.setActiveObject&&this.setActiveObject(l),this.contextTop&&this.clearContext(this.contextTop),this.renderAll(),u},toDataURLWithMultiplier:function(t,e,i){return this.toDataURL({format:t,multiplier:e,quality:i})},_tempRemoveBordersControlsFromGroup:function(t){t.origHasControls=t.hasControls,t.origBorderColor=t.borderColor,t.hasControls=!0,t.borderColor="rgba(0,0,0,0)",t.forEachObject(function(t){t.origBorderColor=t.borderColor,t.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(t){t.hideControls=t.origHideControls,t.borderColor=t.origBorderColor,t.forEachObject(function(t){t.borderColor=t.origBorderColor,delete t.origBorderColor})}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{loadFromDatalessJSON:function(t,e,i){return this.loadFromJSON(t,e,i)},loadFromJSON:function(t,e,i){if(t){var n="string"==typeof t?JSON.parse(t):t;this.clear();var r=this;return this._enlivenObjects(n.objects,function(){r._setBgOverlay(n,e)},i),this}},_setBgOverlay:function(t,e){var i=this,n={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!(t.backgroundImage||t.overlayImage||t.background||t.overlay))return void(e&&e());var r=function(){n.backgroundImage&&n.overlayImage&&n.backgroundColor&&n.overlayColor&&(i.renderAll(),e&&e())};this.__setBgOverlay("backgroundImage",t.backgroundImage,n,r),this.__setBgOverlay("overlayImage",t.overlayImage,n,r),this.__setBgOverlay("backgroundColor",t.background,n,r),this.__setBgOverlay("overlayColor",t.overlay,n,r),r()},__setBgOverlay:function(t,e,i,n){var r=this;return e?void("backgroundImage"===t||"overlayImage"===t?fabric.Image.fromObject(e,function(e){r[t]=e,i[t]=!0,n&&n()}):this["set"+fabric.util.string.capitalize(t,!0)](e,function(){i[t]=!0,n&&n()})):void(i[t]=!0)},_enlivenObjects:function(t,e,i){var n=this;if(!t||0===t.length)return void(e&&e());var r=this.renderOnAddRemove;this.renderOnAddRemove=!1,fabric.util.enlivenObjects(t,function(t){t.forEach(function(t,e){n.insertAt(t,e,!0)}),n.renderOnAddRemove=r,e&&e()},null,i)},_toDataURL:function(t,e){this.clone(function(i){e(i.toDataURL(t))})},_toDataURLWithMultiplier:function(t,e,i){this.clone(function(n){i(n.toDataURLWithMultiplier(t,e))})},clone:function(t,e){var i=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(e){e.loadFromJSON(i,function(){t&&t(e)})})},cloneWithoutData:function(t){var e=fabric.document.createElement("canvas");e.width=this.getWidth(),e.height=this.getHeight();var i=new fabric.Canvas(e);i.clipTo=this.clipTo,this.backgroundImage?(i.setBackgroundImage(this.backgroundImage.src,function(){i.renderAll(),t&&t(i)}),i.backgroundImageOpacity=this.backgroundImageOpacity,i.backgroundImageStretch=this.backgroundImageStretch):t&&t(i)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.toFixed,r=e.util.string.capitalize,o=e.util.degreesToRadians,a=e.StaticCanvas.supports("setLineDash");e.Object||(e.Object=e.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,cornerSize:12,transparentCorners:!0,hoverCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"source-over",backgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockScalingFlip:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule shadow clipTo visible backgroundColor".split(" "),initialize:function(t){t&&this.setOptions(t)},_initGradient:function(t){!t.fill||!t.fill.colorStops||t.fill instanceof e.Gradient||this.set("fill",new e.Gradient(t.fill))},_initPattern:function(t){!t.fill||!t.fill.source||t.fill instanceof e.Pattern||this.set("fill",new e.Pattern(t.fill)),!t.stroke||!t.stroke.source||t.stroke instanceof e.Pattern||this.set("stroke",new e.Pattern(t.stroke))},_initClipping:function(t){if(t.clipTo&&"string"==typeof t.clipTo){var i=e.util.getFunctionBody(t.clipTo);"undefined"!=typeof i&&(this.clipTo=new Function("ctx",i))}},setOptions:function(t){for(var e in t)this.set(e,t[e]);this._initGradient(t),this._initPattern(t),this._initClipping(t)},transform:function(t,e){this.group&&this.group.transform(t,e),t.globalAlpha=this.opacity;var i=e?this._getLeftTopCoords():this.getCenterPoint();t.translate(i.x,i.y),t.rotate(o(this.angle)),t.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(t){var i=e.Object.NUM_FRACTION_DIGITS,r={type:this.type,originX:this.originX,originY:this.originY,left:n(this.left,i),top:n(this.top,i),width:n(this.width,i),height:n(this.height,i),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,i),strokeDashArray:this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:n(this.strokeMiterLimit,i),scaleX:n(this.scaleX,i),scaleY:n(this.scaleY,i),angle:n(this.getAngle(),i),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,i),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&String(this.clipTo),backgroundColor:this.backgroundColor};return this.includeDefaultValues||(r=this._removeDefaultValues(r)),e.util.populateWithProperties(this,r,t),r},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var i=e.util.getKlass(t.type).prototype,n=i.stateProperties;return n.forEach(function(e){t[e]===i[e]&&delete t[e]}),t},toString:function(){return"#<fabric."+r(this.type)+">"},get:function(t){return this[t]},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):"function"==typeof e&&"clipTo"!==t?this._set(t,e(this.get(t))):this._set(t,e),this},_set:function(t,i){var r="scaleX"===t||"scaleY"===t;return r&&(i=this._constrainScale(i)),"scaleX"===t&&0>i?(this.flipX=!this.flipX,i*=-1):"scaleY"===t&&0>i?(this.flipY=!this.flipY,i*=-1):"width"===t||"height"===t?this.minScaleLimit=n(Math.min(.1,1/Math.max(this.width,this.height)),2):"shadow"!==t||!i||i instanceof e.Shadow||(i=new e.Shadow(i)),this[t]=i,this},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},setSourcePath:function(t){return this.sourcePath=t,this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(t,i){if(0!==this.width&&0!==this.height&&this.visible){if(t.save(),this._setupFillRule(t),this._transform(t,i),this._setStrokeStyles(t),this._setFillStyles(t),this.group&&"path-group"===this.group.type){t.translate(-this.group.width/2,-this.group.height/2);var n=this.transformMatrix;n&&t.transform.apply(t,n)}t.globalAlpha=this.group?t.globalAlpha*this.opacity:this.opacity,this._setShadow(t),this.clipTo&&e.util.clipContext(this,t),this._render(t,i),this.clipTo&&t.restore(),this._removeShadow(t),this._restoreFillRule(t),t.restore()}},_transform:function(t,e){var i=this.transformMatrix;i&&!this.group&&t.setTransform.apply(t,i),e||this.transform(t)},_setStrokeStyles:function(t){this.stroke&&(t.lineWidth=this.strokeWidth,t.lineCap=this.strokeLineCap,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,t.strokeStyle=this.stroke.toLive?this.stroke.toLive(t):this.stroke)},_setFillStyles:function(t){this.fill&&(t.fillStyle=this.fill.toLive?this.fill.toLive(t):this.fill)},_renderControls:function(t,i){var n=this.getViewportTransform();if(t.save(),this.active&&!i){var r;this.group&&(r=e.util.transformPoint(this.group.getCenterPoint(),n),t.translate(r.x,r.y),t.rotate(o(this.group.angle))),r=e.util.transformPoint(this.getCenterPoint(),n,null!=this.group),this.group&&(r.x*=this.group.scaleX,r.y*=this.group.scaleY),t.translate(r.x,r.y),t.rotate(o(this.angle)),this.drawBorders(t),this.drawControls(t)}t.restore()},_setShadow:function(t){this.shadow&&(t.shadowColor=this.shadow.color,t.shadowBlur=this.shadow.blur,t.shadowOffsetX=this.shadow.offsetX,t.shadowOffsetY=this.shadow.offsetY)},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_renderFill:function(t){if(this.fill){if(t.save(),this.fill.toLive&&t.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),this.fill.gradientTransform){var e=this.fill.gradientTransform;t.transform.apply(t,e)}"destination-over"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore(),this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t)}},_renderStroke:function(t){if(this.stroke&&0!==this.strokeWidth){if(t.save(),this.strokeDashArray)1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),a?(t.setLineDash(this.strokeDashArray),this._stroke&&this._stroke(t)):this._renderDashedStroke&&this._renderDashedStroke(t),t.stroke();else{if(this.stroke.gradientTransform){var e=this.stroke.gradientTransform;t.transform.apply(t,e)}this._stroke?this._stroke(t):t.stroke()}this._removeShadow(t),t.restore()}},clone:function(t,i){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(i),t):new e.Object(this.toObject(i))},cloneAsImage:function(t){var i=this.toDataURL();return e.util.loadImage(i,function(i){t&&t(new e.Image(i))}),this},toDataURL:function(t){t||(t={});var i=e.util.createCanvasElement(),n=this.getBoundingRect();i.width=n.width,i.height=n.height,e.util.wrapElement(i,"div");var r=new e.Canvas(i);"jpg"===t.format&&(t.format="jpeg"),"jpeg"===t.format&&(r.backgroundColor="#fff");var o={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1),this.setPositionByOrigin(new e.Point(i.width/2,i.height/2),"center","center");var a=this.canvas;r.add(this);var s=r.toDataURL(t);return this.set(o).setCoords(),this.canvas=a,r.dispose(),r=null,s},isType:function(t){return this.type===t},complexity:function(){return 0},toJSON:function(t){return this.toObject(t)},setGradient:function(t,i){i||(i={});var n={colorStops:[]};n.type=i.type||(i.r1||i.r2?"radial":"linear"),n.coords={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},(i.r1||i.r2)&&(n.coords.r1=i.r1,n.coords.r2=i.r2);for(var r in i.colorStops){var o=new e.Color(i.colorStops[r]);n.colorStops.push({offset:r,color:o.toRgb(),opacity:o.getAlpha()})}return this.set(t,e.Gradient.forObject(this,n))},setPatternFill:function(t){return this.set("fill",new e.Pattern(t))},setShadow:function(t){return this.set("shadow",t?new e.Shadow(t):null)},setColor:function(t){return this.set("fill",t),this},setAngle:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas.centerObjectH(this),this},centerV:function(){return this.canvas.centerObjectV(this),this},center:function(){return this.canvas.centerObject(this),this},remove:function(){return this.canvas.remove(this),this},getLocalPointer:function(t,e){e=e||this.canvas.getPointer(t);var i=this.translateToOriginPoint(this.getCenterPoint(),"left","top");return{x:e.x-i.x,y:e.y-i.y}},_setupFillRule:function(t){this.fillRule&&(this._prevFillRule=t.globalCompositeOperation,t.globalCompositeOperation=this.fillRule)},_restoreFillRule:function(t){this.fillRule&&this._prevFillRule&&(t.globalCompositeOperation=this._prevFillRule)}}),e.util.createAccessors(e.Object),e.Object.prototype.rotate=e.Object.prototype.setAngle,i(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.__uid=0)}("undefined"!=typeof exports?exports:this),function(){var t=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{translateToCenterPoint:function(e,i,n){var r=e.x,o=e.y,a=this.stroke?this.strokeWidth:0;return"left"===i?r=e.x+(this.getWidth()+a*this.scaleX)/2:"right"===i&&(r=e.x-(this.getWidth()+a*this.scaleX)/2),"top"===n?o=e.y+(this.getHeight()+a*this.scaleY)/2:"bottom"===n&&(o=e.y-(this.getHeight()+a*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(r,o),e,t(this.angle))},translateToOriginPoint:function(e,i,n){var r=e.x,o=e.y,a=this.stroke?this.strokeWidth:0;return"left"===i?r=e.x-(this.getWidth()+a*this.scaleX)/2:"right"===i&&(r=e.x+(this.getWidth()+a*this.scaleX)/2),"top"===n?o=e.y-(this.getHeight()+a*this.scaleY)/2:"bottom"===n&&(o=e.y+(this.getHeight()+a*this.scaleY)/2),fabric.util.rotatePoint(new fabric.Point(r,o),e,t(this.angle))},getCenterPoint:function(){var t=new fabric.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var i=this.getCenterPoint();return this.translateToOriginPoint(i,t,e)},toLocalPoint:function(e,i,n){var r,o,a=this.getCenterPoint(),s=this.stroke?this.strokeWidth:0;return i&&n?(r="left"===i?a.x-(this.getWidth()+s*this.scaleX)/2:"right"===i?a.x+(this.getWidth()+s*this.scaleX)/2:a.x,o="top"===n?a.y-(this.getHeight()+s*this.scaleY)/2:"bottom"===n?a.y+(this.getHeight()+s*this.scaleY)/2:a.y):(r=this.left,o=this.top),fabric.util.rotatePoint(new fabric.Point(e.x,e.y),a,-t(this.angle)).subtractEquals(new fabric.Point(r,o))},setPositionByOrigin:function(t,e,i){var n=this.translateToCenterPoint(t,e,i),r=this.translateToOriginPoint(n,this.originX,this.originY);this.set("left",r.x),this.set("top",r.y)},adjustPosition:function(e){var i=t(this.angle),n=this.getWidth()/2,r=Math.cos(i)*n,o=Math.sin(i)*n,a=this.getWidth(),s=Math.cos(i)*a,l=Math.sin(i)*a;"center"===this.originX&&"left"===e||"right"===this.originX&&"center"===e?(this.left-=r,this.top-=o):"left"===this.originX&&"center"===e||"center"===this.originX&&"right"===e?(this.left+=r,this.top+=o):"left"===this.originX&&"right"===e?(this.left+=s,this.top+=l):"right"===this.originX&&"left"===e&&(this.left-=s,this.top-=l),this.setCoords(),this.originX=e},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","center")}})}(),function(){var t=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{oCoords:null,intersectsWithRect:function(t,e){var i=this.oCoords,n=new fabric.Point(i.tl.x,i.tl.y),r=new fabric.Point(i.tr.x,i.tr.y),o=new fabric.Point(i.bl.x,i.bl.y),a=new fabric.Point(i.br.x,i.br.y),s=fabric.Intersection.intersectPolygonRectangle([n,r,a,o],t,e);return"Intersection"===s.status},intersectsWithObject:function(t){function e(t){return{tl:new fabric.Point(t.tl.x,t.tl.y),tr:new fabric.Point(t.tr.x,t.tr.y),bl:new fabric.Point(t.bl.x,t.bl.y),br:new fabric.Point(t.br.x,t.br.y)}}var i=e(this.oCoords),n=e(t.oCoords),r=fabric.Intersection.intersectPolygonPolygon([i.tl,i.tr,i.br,i.bl],[n.tl,n.tr,n.br,n.bl]);return"Intersection"===r.status},isContainedWithinObject:function(t){var e=t.getBoundingRect(),i=new fabric.Point(e.left,e.top),n=new fabric.Point(e.left+e.width,e.top+e.height);return this.isContainedWithinRect(i,n)},isContainedWithinRect:function(t,e){var i=this.getBoundingRect();return i.left>=t.x&&i.left+i.width<=e.x&&i.top>=t.y&&i.top+i.height<=e.y},containsPoint:function(t){var e=this._getImageLines(this.oCoords),i=this._findCrossPoints(t,e);return 0!==i&&i%2===1},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var i,n,r,o,a,s,l,c=0;for(var h in e)if(l=e[h],!(l.o.y<t.y&&l.d.y<t.y||l.o.y>=t.y&&l.d.y>=t.y||(l.o.x===l.d.x&&l.o.x>=t.x?(a=l.o.x,s=t.y):(i=0,n=(l.d.y-l.o.y)/(l.d.x-l.o.x),r=t.y-i*t.x,o=l.o.y-n*l.o.x,a=-(r-o)/(i-n),s=r+i*a),a>=t.x&&(c+=1),2!==c)))break;return c},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var t=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,this.oCoords.bl.x],e=fabric.util.array.min(t),i=fabric.util.array.max(t),n=Math.abs(e-i),r=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y],o=fabric.util.array.min(r),a=fabric.util.array.max(r),s=Math.abs(o-a);return{left:e,top:o,width:n,height:s}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?0>t?-this.minScaleLimit:this.minScaleLimit:t},scale:function(t){return t=this._constrainScale(t),0>t&&(this.flipX=!this.flipX,this.flipY=!this.flipY,t*=-1),this.scaleX=t,this.scaleY=t,this.setCoords(),this},scaleToWidth:function(t){var e=this.getBoundingRectWidth()/this.getWidth();return this.scale(t/this.width/e)},scaleToHeight:function(t){var e=this.getBoundingRectHeight()/this.getHeight();return this.scale(t/this.height/e)},setCoords:function(){var e=this.strokeWidth>1?this.strokeWidth:0,i=t(this.angle),n=this.getViewportTransform(),r=function(t){return fabric.util.transformPoint(t,n)},o=this.width,a=this.height,s="round"===this.strokeLineCap||"square"===this.strokeLineCap,l="line"===this.type&&1===this.width,c="line"===this.type&&1===this.height,h=s&&c||"line"!==this.type,u=s&&l||"line"!==this.type;l?o=e:c&&(a=e),h&&(o+=e),u&&(a+=e),this.currentWidth=o*this.scaleX,this.currentHeight=a*this.scaleY,this.currentWidth<0&&(this.currentWidth=Math.abs(this.currentWidth));var f=Math.sqrt(Math.pow(this.currentWidth/2,2)+Math.pow(this.currentHeight/2,2)),d=Math.atan(isFinite(this.currentHeight/this.currentWidth)?this.currentHeight/this.currentWidth:0),p=Math.cos(d+i)*f,g=Math.sin(d+i)*f,v=Math.sin(i),m=Math.cos(i),b=this.getCenterPoint(),y=new fabric.Point(this.currentWidth,this.currentHeight),x=new fabric.Point(b.x-p,b.y-g),w=new fabric.Point(x.x+y.x*m,x.y+y.x*v),_=new fabric.Point(x.x-y.y*v,x.y+y.y*m),C=new fabric.Point(x.x+y.x/2*m,x.y+y.x/2*v),S=r(x),A=r(w),k=r(new fabric.Point(w.x-y.y*v,w.y+y.y*m)),T=r(_),O=r(new fabric.Point(x.x-y.y/2*v,x.y+y.y/2*m)),$=r(C),D=r(new fabric.Point(w.x-y.y/2*v,w.y+y.y/2*m)),M=r(new fabric.Point(_.x+y.x/2*m,_.y+y.x/2*v)),E=r(new fabric.Point(C.x,C.y)),P=Math.cos(d+i)*this.padding*Math.sqrt(2),j=Math.sin(d+i)*this.padding*Math.sqrt(2);return S=S.add(new fabric.Point(-P,-j)),A=A.add(new fabric.Point(j,-P)),k=k.add(new fabric.Point(P,j)),T=T.add(new fabric.Point(-j,P)),O=O.add(new fabric.Point((-P-j)/2,(-j+P)/2)),$=$.add(new fabric.Point((j-P)/2,-(j+P)/2)),D=D.add(new fabric.Point((j+P)/2,(j-P)/2)),M=M.add(new fabric.Point((P-j)/2,(P+j)/2)),E=E.add(new fabric.Point((j-P)/2,-(j+P)/2)),this.oCoords={tl:S,tr:A,br:k,bl:T,ml:O,mt:$,mr:D,mb:M,mtr:E},this._setCornerCoords&&this._setCornerCoords(),this}})}(),fabric.util.object.extend(fabric.Object.prototype,{sendToBack:function(){return this.group?fabric.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?fabric.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?fabric.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?fabric.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group?fabric.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas.moveTo(this,t),this}}),fabric.util.object.extend(fabric.Object.prototype,{getSvgStyles:function(){var t=this.fill?this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill:"none",e="destination-over"===this.fillRule?"evenodd":this.fillRule,i=this.stroke?this.stroke.toLive?"url(#SVGID_"+this.stroke.id+")":this.stroke:"none",n=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):"",o=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",s=this.strokeMiterLimit?this.strokeMiterLimit:"4",l="undefined"!=typeof this.opacity?this.opacity:"1",c=this.visible?"":" visibility: hidden;",h=this.shadow&&"text"!==this.type?"filter: url(#SVGID_"+this.shadow.id+");":"";return["stroke: ",i,"; ","stroke-width: ",n,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",o,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",s,"; ","fill: ",t,"; ","fill-rule: ",e,"; ","opacity: ",l,";",h,c].join("")},getSvgTransform:function(){if(this.group)return"";var t=fabric.util.toFixed,e=this.getAngle(),i=this.getViewportTransform(),n=fabric.util.transformPoint(this.getCenterPoint(),i),r=fabric.Object.NUM_FRACTION_DIGITS,o="path-group"===this.type?"":"translate("+t(n.x,r)+" "+t(n.y,r)+")",a=0!==e?" rotate("+t(e,r)+")":"",s=1===this.scaleX&&1===this.scaleY&&1===i[0]&&1===i[3]?"":" scale("+t(this.scaleX*i[0],r)+" "+t(this.scaleY*i[3],r)+")",l="path-group"===this.type?this.width*i[0]:0,c=this.flipX?" matrix(-1 0 0 1 "+l+" 0) ":"",h="path-group"===this.type?this.height*i[3]:0,u=this.flipY?" matrix(1 0 0 -1 0 "+h+")":"";return[o,a,s,c,u].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+")":""},_createBaseSVGMarkup:function(){var t=[];return this.fill&&this.fill.toLive&&t.push(this.fill.toSVG(this,!1)),this.stroke&&this.stroke.toLive&&t.push(this.stroke.toSVG(this,!1)),this.shadow&&t.push(this.shadow.toSVG(this)),t}}),fabric.util.object.extend(fabric.Object.prototype,{hasStateChanged:function(){return this.stateProperties.some(function(t){return this.get(t)!==this.originalState[t]},this)},saveState:function(t){return this.stateProperties.forEach(function(t){this.originalState[t]=this.get(t)},this),t&&t.stateProperties&&t.stateProperties.forEach(function(t){this.originalState[t]=this.get(t)},this),this},setupState:function(){return this.originalState={},this.saveState(),this}}),function(){var t=fabric.util.degreesToRadians,e=function(){return"undefined"!=typeof G_vmlCanvasManager};fabric.util.object.extend(fabric.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(t){if(!this.hasControls||!this.active)return!1;var e,i,n=t.x,r=t.y;for(var o in this.oCoords)if(this.isControlVisible(o)&&("mtr"!==o||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==o&&"mr"!==o&&"mb"!==o&&"ml"!==o)&&(i=this._getImageLines(this.oCoords[o].corner),e=this._findCrossPoints({x:n,y:r},i),0!==e&&e%2===1))return this.__corner=o,o;return!1},_setCornerCoords:function(){var e=this.oCoords,i=t(this.angle),n=t(45-this.angle),r=Math.sqrt(2*Math.pow(this.cornerSize,2))/2,o=r*Math.cos(n),a=r*Math.sin(n),s=Math.sin(i),l=Math.cos(i);e.tl.corner={tl:{x:e.tl.x-a,y:e.tl.y-o},tr:{x:e.tl.x+o,y:e.tl.y-a},bl:{x:e.tl.x-o,y:e.tl.y+a},br:{x:e.tl.x+a,y:e.tl.y+o}},e.tr.corner={tl:{x:e.tr.x-a,y:e.tr.y-o},tr:{x:e.tr.x+o,y:e.tr.y-a},br:{x:e.tr.x+a,y:e.tr.y+o},bl:{x:e.tr.x-o,y:e.tr.y+a}},e.bl.corner={tl:{x:e.bl.x-a,y:e.bl.y-o},bl:{x:e.bl.x-o,y:e.bl.y+a},br:{x:e.bl.x+a,y:e.bl.y+o},tr:{x:e.bl.x+o,y:e.bl.y-a}},e.br.corner={tr:{x:e.br.x+o,y:e.br.y-a},bl:{x:e.br.x-o,y:e.br.y+a},br:{x:e.br.x+a,y:e.br.y+o},tl:{x:e.br.x-a,y:e.br.y-o}},e.ml.corner={tl:{x:e.ml.x-a,y:e.ml.y-o},tr:{x:e.ml.x+o,y:e.ml.y-a},bl:{x:e.ml.x-o,y:e.ml.y+a},br:{x:e.ml.x+a,y:e.ml.y+o}},e.mt.corner={tl:{x:e.mt.x-a,y:e.mt.y-o},tr:{x:e.mt.x+o,y:e.mt.y-a},bl:{x:e.mt.x-o,y:e.mt.y+a},br:{x:e.mt.x+a,y:e.mt.y+o}},e.mr.corner={tl:{x:e.mr.x-a,y:e.mr.y-o},tr:{x:e.mr.x+o,y:e.mr.y-a},bl:{x:e.mr.x-o,y:e.mr.y+a},br:{x:e.mr.x+a,y:e.mr.y+o}},e.mb.corner={tl:{x:e.mb.x-a,y:e.mb.y-o},tr:{x:e.mb.x+o,y:e.mb.y-a},bl:{x:e.mb.x-o,y:e.mb.y+a},br:{x:e.mb.x+a,y:e.mb.y+o}},e.mtr.corner={tl:{x:e.mtr.x-a+s*this.rotatingPointOffset,y:e.mtr.y-o-l*this.rotatingPointOffset},tr:{x:e.mtr.x+o+s*this.rotatingPointOffset,y:e.mtr.y-a-l*this.rotatingPointOffset},bl:{x:e.mtr.x-o+s*this.rotatingPointOffset,y:e.mtr.y+a-l*this.rotatingPointOffset},br:{x:e.mtr.x+a+s*this.rotatingPointOffset,y:e.mtr.y+o-l*this.rotatingPointOffset}}},drawBorders:function(t){if(!this.hasBorders)return this;var e=this.padding,i=2*e,n=this.getViewportTransform();t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,t.strokeStyle=this.borderColor;var r=1/this._constrainScale(this.scaleX),o=1/this._constrainScale(this.scaleY);t.lineWidth=1/this.borderScaleFactor;var a=this.getWidth(),s=this.getHeight(),l=this.strokeWidth>1?this.strokeWidth:0,c="round"===this.strokeLineCap||"square"===this.strokeLineCap,h="line"===this.type&&1===this.width,u="line"===this.type&&1===this.height,f=c&&u||"line"!==this.type,d=c&&h||"line"!==this.type;h?a=l/r:u&&(s=l/o),f&&(a+=l/r),d&&(s+=l/o);var p=fabric.util.transformPoint(new fabric.Point(a,s),n,!0),g=p.x,v=p.y;if(this.group&&(g*=this.group.scaleX,v*=this.group.scaleY),t.strokeRect(~~(-(g/2)-e)-.5,~~(-(v/2)-e)-.5,~~(g+i)+1,~~(v+i)+1),this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls){var m=(-v-2*e)/2;t.beginPath(),t.moveTo(0,m),t.lineTo(0,m-this.rotatingPointOffset),t.closePath(),t.stroke()}return t.restore(),this},drawControls:function(t){if(!this.hasControls)return this;var e=this.cornerSize,i=e/2,n=this.getViewportTransform(),r=this.strokeWidth>1?this.strokeWidth:0,o=this.width,a=this.height,s="round"===this.strokeLineCap||"square"===this.strokeLineCap,l="line"===this.type&&1===this.width,c="line"===this.type&&1===this.height,h=s&&c||"line"!==this.type,u=s&&l||"line"!==this.type;l?o=r:c&&(a=r),h&&(o+=r),u&&(a+=r),o*=this.scaleX,a*=this.scaleY;var f=fabric.util.transformPoint(new fabric.Point(o,a),n,!0),d=f.x,p=f.y,g=-(d/2),v=-(p/2),m=this.padding,b=i,y=i-e,x=this.transparentCorners?"strokeRect":"fillRect";return t.save(),t.lineWidth=1,t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,t.strokeStyle=t.fillStyle=this.cornerColor,this._drawControl("tl",t,x,g-b-m,v-b-m),this._drawControl("tr",t,x,g+d-b+m,v-b-m),this._drawControl("bl",t,x,g-b-m,v+p+y+m),this._drawControl("br",t,x,g+d+y+m,v+p+y+m),this.get("lockUniScaling")||(this._drawControl("mt",t,x,g+d/2-b,v-b-m),this._drawControl("mb",t,x,g+d/2-b,v+p+y+m),this._drawControl("mr",t,x,g+d+y+m,v+p/2-b),this._drawControl("ml",t,x,g-b-m,v+p/2-b)),this.hasRotatingPoint&&this._drawControl("mtr",t,x,g+d/2-b,v-this.rotatingPointOffset-this.cornerSize/2-m),t.restore(),this},_drawControl:function(t,i,n,r,o){var a=this.cornerSize;this.isControlVisible(t)&&(e()||this.transparentCorners||i.clearRect(r,o,a,a),i[n](r,o,a,a))},isControlVisible:function(t){return this._getControlsVisibility()[t]},setControlVisible:function(t,e){return this._getControlsVisibility()[t]=e,this},setControlsVisibility:function(t){t||(t={});for(var e in t)this.setControlVisible(e,t[e]);return this},_getControlsVisibility:function(){return this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0}),this._controlsVisibility}})}(),fabric.util.object.extend(fabric.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){e=e||{};var i=function(){},n=e.onComplete||i,r=e.onChange||i,o=this;return fabric.util.animate({startValue:t.get("left"),endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),o.renderAll(),r()},onComplete:function(){t.setCoords(),n()}}),this},fxCenterObjectV:function(t,e){e=e||{};var i=function(){},n=e.onComplete||i,r=e.onChange||i,o=this;return fabric.util.animate({startValue:t.get("top"),endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),o.renderAll(),r()},onComplete:function(){t.setCoords(),n()}}),this},fxRemove:function(t,e){e=e||{};var i=function(){},n=e.onComplete||i,r=e.onChange||i,o=this;return fabric.util.animate({startValue:t.get("opacity"),endValue:0,duration:this.FX_DURATION,onStart:function(){t.set("active",!1)},onChange:function(e){t.set("opacity",e),o.renderAll(),r()},onComplete:function(){o.remove(t),n()}}),this}}),fabric.util.object.extend(fabric.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var t,e,i=[];for(t in arguments[0])i.push(t);for(var n=0,r=i.length;r>n;n++)t=i[n],e=n!==r-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(t,e,i,n){var r,o=this;e=e.toString(),i=i?fabric.util.object.clone(i):{},~t.indexOf(".")&&(r=t.split("."));var a=r?this.get(r[0])[r[1]]:this.get(t);"from"in i||(i.from=a),e=~e.indexOf("=")?a+parseFloat(e.replace("=","")):parseFloat(e),fabric.util.animate({startValue:i.from,endValue:e,byValue:i.by,easing:i.easing,duration:i.duration,abort:i.abort&&function(){return i.abort.call(o)},onChange:function(e){r?o[r[0]][r[1]]=e:o.set(t,e),n||i.onChange&&i.onChange()},onComplete:function(){n||(o.setCoords(),i.onComplete&&i.onComplete())}})}}),function(t){"use strict";function e(t,e){var i=t.origin,n=t.axis1,r=t.axis2,o=t.dimension,a=e.nearest,s=e.center,l=e.farthest;return function(){switch(this.get(i)){case a:return Math.min(this.get(n),this.get(r));case s:return Math.min(this.get(n),this.get(r))+.5*this.get(o);case l:return Math.max(this.get(n),this.get(r))}}}var i=t.fabric||(t.fabric={}),n=i.util.object.extend,r={x1:1,x2:1,y1:1,y2:1},o=i.StaticCanvas.supports("setLineDash");return i.Line?void i.warn("fabric.Line is already defined"):(i.Line=i.util.createClass(i.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(t,e){e=e||{},t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1)||1,this.height=Math.abs(this.y2-this.y1)||1,this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this[t]=e,"undefined"!=typeof r[t]&&this._setWidthHeight(),this},_getLeftToOriginX:e({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:e({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t,e){if(t.beginPath(),e){var i=this.getCenterPoint();t.translate(i.x,i.y)}if(!this.strokeDashArray||this.strokeDashArray&&o){var n=this.x1<=this.x2?-1:1,r=this.y1<=this.y2?-1:1;t.moveTo(1===this.width?0:n*this.width/2,1===this.height?0:r*this.height/2),t.lineTo(1===this.width?0:-1*n*this.width/2,1===this.height?0:-1*r*this.height/2)}t.lineWidth=this.strokeWidth;var a=t.strokeStyle;
t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=a},_renderDashedStroke:function(t){var e=this.x1<=this.x2?-1:1,n=this.y1<=this.y2?-1:1,r=1===this.width?0:e*this.width/2,o=1===this.height?0:n*this.height/2;t.beginPath(),i.util.drawDashedLine(t,r,o,-r,-o,this.strokeDashArray),t.closePath()},toObject:function(t){return n(this.callSuper("toObject",t),{x1:this.get("x1"),y1:this.get("y1"),x2:this.get("x2"),y2:this.get("y2")})},toSVG:function(t){var e=this._createBaseSVGMarkup(),i="";if(!this.group){var n=-this.width/2-(this.x1>this.x2?this.x2:this.x1),r=-this.height/2-(this.y1>this.y2?this.y2:this.y1);i="translate("+n+", "+r+") "}return e.push("<line ",'x1="',this.x1,'" y1="',this.y1,'" x2="',this.x2,'" y2="',this.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),i,this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),i.Line.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),i.Line.fromElement=function(t,e){var r=i.parseAttributes(t,i.Line.ATTRIBUTE_NAMES),o=[r.x1||0,r.y1||0,r.x2||0,r.y2||0];return new i.Line(o,n(r,e))},void(i.Line.fromObject=function(t){var e=[t.x1,t.y1,t.x2,t.y2];return new i.Line(e,t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){return"radius"in t&&t.radius>0}var i=t.fabric||(t.fabric={}),n=2*Math.PI,r=i.util.object.extend;return i.Circle?void i.warn("fabric.Circle is already defined."):(i.Circle=i.util.createClass(i.Object,{type:"circle",radius:0,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("radius",t.radius||0)},_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return r(this.callSuper("toObject",t),{radius:this.get("radius")})},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,n=0;return this.group&&(i=this.left+this.radius,n=this.top+this.radius),e.push("<circle ",'cx="'+i+'" cy="'+n+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},_render:function(t,e){t.beginPath(),t.arc(e?this.left+this.radius:0,e?this.top+this.radius:0,this.radius,0,n,!1),this._renderFill(t),this._renderStroke(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){this.radius=t,this.set("width",2*t).set("height",2*t)},complexity:function(){return 1}}),i.Circle.ATTRIBUTE_NAMES=i.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),i.Circle.fromElement=function(t,n){n||(n={});var o=i.parseAttributes(t,i.Circle.ATTRIBUTE_NAMES);if(!e(o))throw new Error("value of `r` attribute is required and can not be negative");o.left=o.left||0,o.top=o.top||0;var a=new i.Circle(r(o,n));return a.left-=a.radius,a.top-=a.radius,a},void(i.Circle.fromObject=function(t){return new i.Circle(t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});return e.Triangle?void e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("width",t.width||100).set("height",t.height||100)},_render:function(t){var e=this.width/2,i=this.height/2;t.beginPath(),t.moveTo(-e,i),t.lineTo(0,-i),t.lineTo(e,i),t.closePath(),this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i=this.width/2,n=this.height/2;t.beginPath(),e.util.drawDashedLine(t,-i,n,0,-n,this.strokeDashArray),e.util.drawDashedLine(t,0,-n,i,n,this.strokeDashArray),e.util.drawDashedLine(t,i,n,-i,n,this.strokeDashArray),t.closePath()},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.width/2,n=this.height/2,r=[-i+" "+n,"0 "+-n,i+" "+n].join(",");return e.push("<polygon ",'points="',r,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),void(e.Triangle.fromObject=function(t){return new e.Triangle(t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=2*Math.PI,n=e.util.object.extend;return e.Ellipse?void e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,initialize:function(t){t=t||{},this.callSuper("initialize",t),this.set("rx",t.rx||0),this.set("ry",t.ry||0),this.set("width",2*this.get("rx")),this.set("height",2*this.get("ry"))},toObject:function(t){return n(this.callSuper("toObject",t),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=0,n=0;return this.group&&(i=this.left+this.rx,n=this.top+this.ry),e.push("<ellipse ",'cx="',i,'" cy="',n,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},_render:function(t,e){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(e?this.left+this.rx:0,e?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,i,!1),t.restore(),this._renderFill(t),this._renderStroke(t)},complexity:function(){return 1}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,i){i||(i={});var r=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);r.left=r.left||0,r.top=r.top||0;var o=new e.Ellipse(n(r,i));return o.top-=o.ry,o.left-=o.rx,o},void(e.Ellipse.fromObject=function(t){return new e.Ellipse(t)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;if(e.Rect)return void console.warn("fabric.Rect is already defined");var n=e.Object.prototype.stateProperties.concat();n.push("rx","ry","x","y"),e.Rect=e.util.createClass(e.Object,{stateProperties:n,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(t){t=t||{},this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t,e){if(1===this.width&&1===this.height)return void t.fillRect(0,0,1,1);var i=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,r=this.width,o=this.height,a=e?this.left:0,s=e?this.top:0,l=0!==i||0!==n,c=.4477152502;t.beginPath(),e||t.translate(-this.width/2,-this.height/2),t.moveTo(a+i,s),t.lineTo(a+r-i,s),l&&t.bezierCurveTo(a+r-c*i,s,a+r,s+c*n,a+r,s+n),t.lineTo(a+r,s+o-n),l&&t.bezierCurveTo(a+r,s+o-c*n,a+r-c*i,s+o,a+r-i,s+o),t.lineTo(a+i,s+o),l&&t.bezierCurveTo(a+c*i,s+o,a,s+o-c*n,a,s+o-n),t.lineTo(a,s+n),l&&t.bezierCurveTo(a,s+c*n,a+c*i,s,a+i,s),t.closePath(),this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i=-this.width/2,n=-this.height/2,r=this.width,o=this.height;t.beginPath(),e.util.drawDashedLine(t,i,n,i+r,n,this.strokeDashArray),e.util.drawDashedLine(t,i+r,n,i+r,n+o,this.strokeDashArray),e.util.drawDashedLine(t,i+r,n+o,i,n+o,this.strokeDashArray),e.util.drawDashedLine(t,i,n+o,i,n,this.strokeDashArray),t.closePath()},toObject:function(t){var e=i(this.callSuper("toObject",t),{rx:this.get("rx")||0,ry:this.get("ry")||0});return this.includeDefaultValues||this._removeDefaultValues(e),e},toSVG:function(t){var e=this._createBaseSVGMarkup(),i=this.left,n=this.top;return this.group||(i=-this.width/2,n=-this.height/2),e.push("<rect ",'x="',i,'" y="',n,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n'),t?t(e.join("")):e.join("")},complexity:function(){return 1}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,n){if(!t)return null;n=n||{};var r=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);return r.left=r.left||0,r.top=r.top||0,new e.Rect(i(n?e.util.object.clone(n):{},r))},e.Rect.fromObject=function(t){return new e.Rect(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.toFixed;return e.Polyline?void e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,initialize:function(t,e,i){e=e||{},this.set("points",t),this.callSuper("initialize",e),this._calcDimensions(i)},_calcDimensions:function(t){return e.Polygon.prototype._calcDimensions.call(this,t)},toObject:function(t){return e.Polygon.prototype.toObject.call(this,t)},toSVG:function(t){for(var e=[],n=this._createBaseSVGMarkup(),r=0,o=this.points.length;o>r;r++)e.push(i(this.points[r].x,2),",",i(this.points[r].y,2)," ");return n.push("<polyline ",'points="',e.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n'),t?t(n.join("")):n.join("")},_render:function(t){var e;t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y);for(var i=0,n=this.points.length;n>i;i++)e=this.points[i],t.lineTo(e.x,e.y);this._renderFill(t),this._renderStroke(t)},_renderDashedStroke:function(t){var i,n;t.beginPath();for(var r=0,o=this.points.length;o>r;r++)i=this.points[r],n=this.points[r+1]||i,e.util.drawDashedLine(t,i.x,i.y,n.x,n.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElement=function(t,i){if(!t)return null;i||(i={});var n=e.parsePointsAttribute(t.getAttribute("points")),r=e.parseAttributes(t,e.Polyline.ATTRIBUTE_NAMES);return null===n?null:new e.Polyline(n,e.util.object.extend(r,i),!0)},void(e.Polyline.fromObject=function(t){var i=t.points;return new e.Polyline(i,t,!0)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.array.min,r=e.util.array.max,o=e.util.toFixed;return e.Polygon?void e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Object,{type:"polygon",points:null,initialize:function(t,e,i){e=e||{},this.points=t,this.callSuper("initialize",e),this._calcDimensions(i)},_calcDimensions:function(t){var e=this.points,i=n(e,"x"),o=n(e,"y"),a=r(e,"x"),s=r(e,"y");if(this.width=a-i||1,this.height=s-o||1,this.minX=i,this.minY=o,!t){var l=this.width/2+this.minX,c=this.height/2+this.minY;this.points.forEach(function(t){t.x-=l,t.y-=c},this)}},toObject:function(t){return i(this.callSuper("toObject",t),{points:this.points.concat()})},toSVG:function(t){for(var e=[],i=this._createBaseSVGMarkup(),n=0,r=this.points.length;r>n;n++)e.push(o(this.points[n].x,2),",",o(this.points[n].y,2)," ");return i.push("<polygon ",'points="',e.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n'),t?t(i.join("")):i.join("")},_render:function(t){var e;t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y);for(var i=0,n=this.points.length;n>i;i++)e=this.points[i],t.lineTo(e.x,e.y);this._renderFill(t),(this.stroke||this.strokeDashArray)&&(t.closePath(),this._renderStroke(t))},_renderDashedStroke:function(t){var i,n;t.beginPath();for(var r=0,o=this.points.length;o>r;r++)i=this.points[r],n=this.points[r+1]||this.points[0],e.util.drawDashedLine(t,i.x,i.y,n.x,n.y,this.strokeDashArray);t.closePath()},complexity:function(){return this.points.length}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=function(t,n){if(!t)return null;n||(n={});var r=e.parsePointsAttribute(t.getAttribute("points")),o=e.parseAttributes(t,e.Polygon.ATTRIBUTE_NAMES);return null===r?null:new e.Polygon(r,i(o,n),!0)},void(e.Polygon.fromObject=function(t){return new e.Polygon(t.points,t,!0)}))}("undefined"!=typeof exports?exports:this),function(t){"use strict";function e(t){return"H"===t[0]?t[1]:t[t.length-2]}function i(t){return"V"===t[0]?t[1]:t[t.length-1]}var n=t.fabric||(t.fabric={}),r=n.util.array.min,o=n.util.array.max,a=n.util.object.extend,s=Object.prototype.toString,l=n.util.drawArc,c={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},h={m:"l",M:"L"};return n.Path?void n.warn("fabric.Path is already defined"):(n.Path=n.util.createClass(n.Object,{type:"path",path:null,initialize:function(t,e){if(e=e||{},this.setOptions(e),!t)throw new Error("`path` argument is required");var i="[object Array]"===s.call(t);this.path=i?t:t.match&&t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi),this.path&&(i||(this.path=this._parsePath()),this._initializePath(e),e.sourcePath&&this.setSourcePath(e.sourcePath))},_initializePath:function(t){var e="width"in t&&null!=t.width,i="height"in t&&null!=t.width,n="left"in t,r="top"in t,o=n?this.left:0,s=r?this.top:0;e&&i?(r||(this.top=this.height/2),n||(this.left=this.width/2)):(a(this,this._parseDimensions()),e&&(this.width=t.width),i&&(this.height=t.height)),this.pathOffset=this.pathOffset||this._calculatePathOffset(o,s)},_calculatePathOffset:function(t,e){return{x:this.left-t-this.width/2,y:this.top-e-this.height/2}},_render:function(t,e){var i,n,r,o,a,s=null,c=0,h=0,u=0,f=0,d=0,p=0,g=-(this.width/2+this.pathOffset.x),v=-(this.height/2+this.pathOffset.y);e&&(g+=this.width/2,v+=this.height/2);for(var m=0,b=this.path.length;b>m;++m){switch(i=this.path[m],i[0]){case"l":u+=i[1],f+=i[2],t.lineTo(u+g,f+v);break;case"L":u=i[1],f=i[2],t.lineTo(u+g,f+v);break;case"h":u+=i[1],t.lineTo(u+g,f+v);break;case"H":u=i[1],t.lineTo(u+g,f+v);break;case"v":f+=i[1],t.lineTo(u+g,f+v);break;case"V":f=i[1],t.lineTo(u+g,f+v);break;case"m":u+=i[1],f+=i[2],c=u,h=f,t.moveTo(u+g,f+v);break;case"M":u=i[1],f=i[2],c=u,h=f,t.moveTo(u+g,f+v);break;case"c":n=u+i[5],r=f+i[6],d=u+i[3],p=f+i[4],t.bezierCurveTo(u+i[1]+g,f+i[2]+v,d+g,p+v,n+g,r+v),u=n,f=r;break;case"C":u=i[5],f=i[6],d=i[3],p=i[4],t.bezierCurveTo(i[1]+g,i[2]+v,d+g,p+v,u+g,f+v);break;case"s":n=u+i[3],r=f+i[4],d=d?2*u-d:u,p=p?2*f-p:f,t.bezierCurveTo(d+g,p+v,u+i[1]+g,f+i[2]+v,n+g,r+v),d=u+i[1],p=f+i[2],u=n,f=r;break;case"S":n=i[3],r=i[4],d=2*u-d,p=2*f-p,t.bezierCurveTo(d+g,p+v,i[1]+g,i[2]+v,n+g,r+v),u=n,f=r,d=i[1],p=i[2];break;case"q":n=u+i[3],r=f+i[4],d=u+i[1],p=f+i[2],t.quadraticCurveTo(d+g,p+v,n+g,r+v),u=n,f=r;break;case"Q":n=i[3],r=i[4],t.quadraticCurveTo(i[1]+g,i[2]+v,n+g,r+v),u=n,f=r,d=i[1],p=i[2];break;case"t":n=u+i[1],r=f+i[2],null===s[0].match(/[QqTt]/)?(d=u,p=f):"t"===s[0]?(d=2*u-o,p=2*f-a):"q"===s[0]&&(d=2*u-d,p=2*f-p),o=d,a=p,t.quadraticCurveTo(d+g,p+v,n+g,r+v),u=n,f=r,d=u+i[1],p=f+i[2];break;case"T":n=i[1],r=i[2],d=2*u-d,p=2*f-p,t.quadraticCurveTo(d+g,p+v,n+g,r+v),u=n,f=r;break;case"a":l(t,u+g,f+v,[i[1],i[2],i[3],i[4],i[5],i[6]+u+g,i[7]+f+v]),u+=i[6],f+=i[7];break;case"A":l(t,u+g,f+v,[i[1],i[2],i[3],i[4],i[5],i[6]+g,i[7]+v]),u=i[6],f=i[7];break;case"z":case"Z":u=c,f=h,t.closePath()}s=i}},render:function(t,e){if(this.visible){t.save(),e&&t.translate(-this.width/2,-this.height/2);var i=this.transformMatrix;i&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),e||this.transform(t),this._setStrokeStyles(t),this._setFillStyles(t),this._setShadow(t),this.clipTo&&n.util.clipContext(this,t),t.beginPath(),t.globalAlpha=this.group?t.globalAlpha*this.opacity:this.opacity,this._render(t,e),this._renderFill(t),this._renderStroke(t),this.clipTo&&t.restore(),this._removeShadow(t),t.restore()}},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){var e=a(this.callSuper("toObject",t),{path:this.path.map(function(t){return t.slice()}),pathOffset:this.pathOffset});return this.sourcePath&&(e.sourcePath=this.sourcePath),this.transformMatrix&&(e.transformMatrix=this.transformMatrix),e},toDatalessObject:function(t){var e=this.toObject(t);return this.sourcePath&&(e.path=this.sourcePath),delete e.sourcePath,e},toSVG:function(t){for(var e=[],i=this._createBaseSVGMarkup(),n=0,r=this.path.length;r>n;n++)e.push(this.path[n].join(" "));var o=e.join(" ");return i.push("<path ",'d="',o,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'" stroke-linecap="round" ',"/>\n"),t?t(i.join("")):i.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var t,e,i,n,r,o=[],a=[],s=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,l=0,u=this.path.length;u>l;l++){for(t=this.path[l],n=t.slice(1).trim(),a.length=0;i=s.exec(n);)a.push(i[0]);r=[t.charAt(0)];for(var f=0,d=a.length;d>f;f++)e=parseFloat(a[f]),isNaN(e)||r.push(e);var p=r[0],g=c[p.toLowerCase()],v=h[p]||p;if(r.length-1>g)for(var m=1,b=r.length;b>m;m+=g)o.push([p].concat(r.slice(m,m+g))),p=v;else o.push(r)}return o},_parseDimensions:function(){var t=[],e=[],i={};this.path.forEach(function(n,r){this._getCoordsFromCommand(n,r,t,e,i)},this);var n=r(t),a=r(e),s=o(t),l=o(e),c=s-n,h=l-a,u={left:this.left+(n+c/2),top:this.top+(a+h/2),width:c,height:h};return u},_getCoordsFromCommand:function(t,n,r,o,a){var s=!1;"H"!==t[0]&&(a.x=e(0===n?t:this.path[n-1])),"V"!==t[0]&&(a.y=i(0===n?t:this.path[n-1])),t[0]===t[0].toLowerCase()&&(s=!0);var l,c=this._getXY(t,s,a);l=parseInt(c.x,10),isNaN(l)||r.push(l),l=parseInt(c.y,10),isNaN(l)||o.push(l)},_getXY:function(t,n,r){var o=n?r.x+e(t):"V"===t[0]?r.x:e(t),a=n?r.y+i(t):"H"===t[0]?r.y:i(t);return{x:o,y:a}}}),n.Path.fromObject=function(t,e){"string"==typeof t.path?n.loadSVGFromURL(t.path,function(i){var r=i[0],o=t.path;delete t.path,n.util.object.extend(r,t),r.setSourcePath(o),e(r)}):e(new n.Path(t.path,t))},n.Path.ATTRIBUTE_NAMES=n.SHARED_ATTRIBUTES.concat(["d"]),n.Path.fromElement=function(t,e,i){var r=n.parseAttributes(t,n.Path.ATTRIBUTE_NAMES);e&&e(new n.Path(r.d,a(r,i)))},void(n.Path.async=!0))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.array.invoke,r=e.Object.prototype.toObject;return e.PathGroup?void e.warn("fabric.PathGroup is already defined"):(e.PathGroup=e.util.createClass(e.Path,{type:"path-group",fill:"",initialize:function(t,e){e=e||{},this.paths=t||[];for(var i=this.paths.length;i--;)this.paths[i].group=this;this.setOptions(e),e.widthAttr&&(this.scaleX=e.widthAttr/e.width),e.heightAttr&&(this.scaleY=e.heightAttr/e.height),this.setCoords(),e.sourcePath&&this.setSourcePath(e.sourcePath)},render:function(t){if(this.visible){t.save();var i=this.transformMatrix;i&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this.transform(t),this._setShadow(t),this.clipTo&&e.util.clipContext(this,t);for(var n=0,r=this.paths.length;r>n;++n)this.paths[n].render(t,!0);this.clipTo&&t.restore(),this._removeShadow(t),t.restore()}},_set:function(t,e){if("fill"===t&&e&&this.isSameColor())for(var i=this.paths.length;i--;)this.paths[i]._set(t,e);return this.callSuper("_set",t,e)},toObject:function(t){var e=i(r.call(this,t),{paths:n(this.getObjects(),"toObject",t)});return this.sourcePath&&(e.sourcePath=this.sourcePath),e},toDatalessObject:function(t){var e=this.toObject(t);return this.sourcePath&&(e.paths=this.sourcePath),e},toSVG:function(t){for(var e=this.getObjects(),i="translate("+this.left+" "+this.top+")",n=["<g ",'style="',this.getSvgStyles(),'" ','transform="',i,this.getSvgTransform(),'" ',">\n"],r=0,o=e.length;o>r;r++)n.push(e[r].toSVG(t));return n.push("</g>\n"),t?t(n.join("")):n.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var t=(this.getObjects()[0].get("fill")||"").toLowerCase();return this.getObjects().every(function(e){return(e.get("fill")||"").toLowerCase()===t})},complexity:function(){return this.paths.reduce(function(t,e){return t+(e&&e.complexity?e.complexity():0)},0)},getObjects:function(){return this.paths}}),e.PathGroup.fromObject=function(t,i){"string"==typeof t.paths?e.loadSVGFromURL(t.paths,function(n){var r=t.paths;delete t.paths;var o=e.util.groupSVGElements(n,t,r);i(o)}):e.util.enlivenObjects(t.paths,function(n){delete t.paths,i(new e.PathGroup(n,t))})},void(e.PathGroup.async=!0))}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.array.min,r=e.util.array.max,o=e.util.array.invoke;if(!e.Group){var a={lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",initialize:function(t,e){e=e||{},this._objects=t||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;this.originalState={},this.callSuper("initialize"),this._calcBounds(),this._updateObjectsCoords(),e&&i(this,e),this._setOpacityIfSame(),this.setCoords(),this.saveCoords()},_updateObjectsCoords:function(){this.forEachObject(this._updateObjectCoords,this)},_updateObjectCoords:function(t){var e=t.getLeft(),i=t.getTop();t.set({originalLeft:e,originalTop:i,left:e-this.left,top:i-this.top}),t.setCoords(),t.__origHasControls=t.hasControls,t.hasControls=!1},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){return this._restoreObjectsState(),t&&(this._objects.push(t),t.group=this),this.forEachObject(this._setObjectActive,this),this._calcBounds(),this._updateObjectsCoords(),this},_setObjectActive:function(t){t.set("active",!0),t.group=this},removeWithUpdate:function(t){return this._moveFlippedObject(t),this._restoreObjectsState(),this.forEachObject(this._setObjectActive,this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this},_onObjectAdded:function(t){t.group=this},_onObjectRemoved:function(t){delete t.group,t.set("active",!1)},delegatedProperties:{fill:!0,opacity:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(t,e){if(t in this.delegatedProperties){var i=this._objects.length;for(this[t]=e;i--;)this._objects[i].set(t,e)}else this[t]=e},toObject:function(t){return i(this.callSuper("toObject",t),{objects:o(this._objects,"toObject",t)})},render:function(t){if(this.visible){t.save(),this.clipTo&&e.util.clipContext(this,t);for(var i=0,n=this._objects.length;n>i;i++)this._renderObject(this._objects[i],t);this.clipTo&&t.restore(),t.restore()}},_renderControls:function(t,e){this.callSuper("_renderControls",t,e);for(var i=0,n=this._objects.length;n>i;i++)this._objects[i]._renderControls(t)},_renderObject:function(t,e){var i=t.hasRotatingPoint;t.visible&&(t.hasRotatingPoint=!1,t.render(e),t.hasRotatingPoint=i)},_restoreObjectsState:function(){return this._objects.forEach(this._restoreObjectState,this),this},_moveFlippedObject:function(t){var e=t.get("originX"),i=t.get("originY"),n=t.getCenterPoint();t.set({originX:"center",originY:"center",left:n.x,top:n.y}),this._toggleFlipping(t);var r=t.getPointByOrigin(e,i);return t.set({originX:e,originY:i,left:r.x,top:r.y}),this},_toggleFlipping:function(t){this.flipX&&(t.toggle("flipX"),t.set("left",-t.get("left")),t.setAngle(-t.getAngle())),this.flipY&&(t.toggle("flipY"),t.set("top",-t.get("top")),t.setAngle(-t.getAngle()))},_restoreObjectState:function(t){return this._setObjectPosition(t),t.setCoords(),t.hasControls=t.__origHasControls,delete t.__origHasControls,t.set("active",!1),t.setCoords(),delete t.group,this},_setObjectPosition:function(t){var e=this.getLeft(),i=this.getTop(),n=this._getRotatedLeftTop(t);t.set({angle:t.getAngle()+this.getAngle(),left:e+n.left,top:i+n.top,scaleX:t.get("scaleX")*this.get("scaleX"),scaleY:t.get("scaleY")*this.get("scaleY")})},_getRotatedLeftTop:function(t){var e=this.getAngle()*(Math.PI/180);return{left:-Math.sin(e)*t.getTop()*this.get("scaleY")+Math.cos(e)*t.getLeft()*this.get("scaleX"),top:Math.cos(e)*t.getTop()*this.get("scaleY")+Math.sin(e)*t.getLeft()*this.get("scaleX")}},destroy:function(){return this._objects.forEach(this._moveFlippedObject,this),this._restoreObjectsState()},saveCoords:function(){return this._originalLeft=this.get("left"),this._originalTop=this.get("top"),this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){return this.forEachObject(function(t){t.setCoords()}),this},_setOpacityIfSame:function(){var t=this.getObjects(),e=t[0]?t[0].get("opacity"):1,i=t.every(function(t){return t.get("opacity")===e});i&&(this.opacity=e)},_calcBounds:function(t){for(var e,i=[],n=[],r=0,o=this._objects.length;o>r;++r){e=this._objects[r],e.setCoords();for(var a in e.oCoords)i.push(e.oCoords[a].x),n.push(e.oCoords[a].y)}this.set(this._getBounds(i,n,t))},_getBounds:function(t,i,o){var a=e.util.invertTransform(this.getViewportTransform()),s=e.util.transformPoint(new e.Point(n(t),n(i)),a),l=e.util.transformPoint(new e.Point(r(t),r(i)),a),c={width:l.x-s.x||0,height:l.y-s.y||0};return o||(c.left=(s.x+l.x)/2||0,c.top=(s.y+l.y)/2||0),c},toSVG:function(t){for(var e=["<g ",'transform="',this.getSvgTransform(),'">\n'],i=0,n=this._objects.length;n>i;i++)e.push(this._objects[i].toSVG(t));return e.push("</g>\n"),t?t(e.join("")):e.join("")},get:function(t){if(t in a){if(this[t])return this[t];for(var e=0,i=this._objects.length;i>e;e++)if(this._objects[e][t])return!0;return!1}return t in this.delegatedProperties?this._objects[0]&&this._objects[0].get(t):this[t]}}),e.Group.fromObject=function(t,i){e.util.enlivenObjects(t.objects,function(n){delete t.objects,i&&i(new e.Group(n,t))})},e.Group.async=!0}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=fabric.util.object.extend;return t.fabric||(t.fabric={}),t.fabric.Image?void fabric.warn("fabric.Image is already defined."):(fabric.Image=fabric.util.createClass(fabric.Object,{type:"image",crossOrigin:"",initialize:function(t,e){e||(e={}),this.filters=[],this.callSuper("initialize",e),this._initElement(t,e),this._initConfig(e),e.filters&&(this.filters=e.filters,this.applyFilters())},getElement:function(){return this._element},setElement:function(t,e){return this._element=t,this._originalElement=t,this._initConfig(),0!==this.filters.length&&this.applyFilters(e),this},setCrossOrigin:function(t){return this.crossOrigin=t,this._element.crossOrigin=t,this},getOriginalSize:function(){var t=this.getElement();return{width:t.width,height:t.height}},_stroke:function(t){t.save(),this._setStrokeStyles(t),t.beginPath(),t.strokeRect(-this.width/2,-this.height/2,this.width,this.height),t.closePath(),t.restore()},_renderDashedStroke:function(t){var e=-this.width/2,i=-this.height/2,n=this.width,r=this.height;t.save(),this._setStrokeStyles(t),t.beginPath(),fabric.util.drawDashedLine(t,e,i,e+n,i,this.strokeDashArray),fabric.util.drawDashedLine(t,e+n,i,e+n,i+r,this.strokeDashArray),fabric.util.drawDashedLine(t,e+n,i+r,e,i+r,this.strokeDashArray),fabric.util.drawDashedLine(t,e,i+r,e,i,this.strokeDashArray),t.closePath(),t.restore()},toObject:function(t){return e(this.callSuper("toObject",t),{src:this._originalElement.src||this._originalElement._src,filters:this.filters.map(function(t){return t&&t.toObject()}),crossOrigin:this.crossOrigin})},toSVG:function(t){var e=[],i=-this.width/2,n=-this.height/2;if(this.group&&(i=this.left,n=this.top),e.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n','<image xlink:href="',this.getSvgSrc(),'" x="',i,'" y="',n,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="none"',"></image>\n"),this.stroke||this.strokeDashArray){var r=this.fill;this.fill=null,e.push("<rect ",'x="',i,'" y="',n,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=r}return e.push("</g>\n"),t?t(e.join("")):e.join("")},getSrc:function(){return this.getElement()?this.getElement().src||this.getElement()._src:void 0},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(t,e){this.constructor.fromObject(this.toObject(e),t)},applyFilters:function(t){if(this._originalElement){if(0===this.filters.length)return this._element=this._originalElement,void(t&&t());var e=this._originalElement,i=fabric.util.createCanvasElement(),n=fabric.util.createImage(),r=this;return i.width=e.width,i.height=e.height,i.getContext("2d").drawImage(e,0,0,e.width,e.height),this.filters.forEach(function(t){t&&t.applyTo(i)}),n.width=e.width,n.height=e.height,fabric.isLikelyNode?(n.src=i.toBuffer(void 0,fabric.Image.pngCompression),r._element=n,t&&t()):(n.onload=function(){r._element=n,t&&t(),n.onload=i=e=null},n.src=i.toDataURL("image/png")),this}},_render:function(t,e){this._element&&t.drawImage(this._element,e?this.left:-this.width/2,e?this.top:-this.height/2,this.width,this.height),this._renderStroke(t)},_resetWidthHeight:function(){var t=this.getElement();this.set("width",t.width),this.set("height",t.height)},_initElement:function(t){this.setElement(fabric.util.getById(t)),fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t),this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(t,e){t.filters&&t.filters.length?fabric.util.enlivenObjects(t.filters,function(t){e&&e(t)},"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){this.width="width"in t?t.width:this.getElement()?this.getElement().width||0:0,this.height="height"in t?t.height:this.getElement()?this.getElement().height||0:0},complexity:function(){return 1}}),fabric.Image.CSS_CANVAS="canvas-img",fabric.Image.prototype.getSvgSrc=fabric.Image.prototype.getSrc,fabric.Image.fromObject=function(t,e){fabric.util.loadImage(t.src,function(i){fabric.Image.prototype._initFilters.call(t,t,function(n){t.filters=n||[];var r=new fabric.Image(i,t);e&&e(r)})},null,t.crossOrigin)},fabric.Image.fromURL=function(t,e,i){fabric.util.loadImage(t,function(t){e(new fabric.Image(t,i))},null,i&&i.crossOrigin)},fabric.Image.ATTRIBUTE_NAMES=fabric.SHARED_ATTRIBUTES.concat("x y width height xlink:href".split(" ")),fabric.Image.fromElement=function(t,i,n){var r=fabric.parseAttributes(t,fabric.Image.ATTRIBUTE_NAMES);fabric.Image.fromURL(r["xlink:href"],i,e(n?fabric.util.object.clone(n):{},r))},fabric.Image.async=!0,void(fabric.Image.pngCompression=1))}("undefined"!=typeof exports?exports:this),fabric.util.object.extend(fabric.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.getAngle()%360;return t>0?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.setAngle(this._getAngleValueForStraighten()),this},fxStraighten:function(t){t=t||{};var e=function(){},i=t.onComplete||e,n=t.onChange||e,r=this;return fabric.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){r.setAngle(t),n()},onComplete:function(){r.setCoords(),i()},onStart:function(){r.set("active",!1)}}),this}}),fabric.util.object.extend(fabric.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.renderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.renderAll.bind(this)}),this}}),fabric.Image.filters=fabric.Image.filters||{},fabric.Image.filters.BaseFilter=fabric.util.createClass({type:"BaseFilter",toObject:function(){return{type:this.type}},toJSON:function(){return this.toObject()}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Brightness=e.util.createClass(e.Image.filters.BaseFilter,{type:"Brightness",initialize:function(t){t=t||{},this.brightness=t.brightness||0},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),n=i.data,r=this.brightness,o=0,a=n.length;a>o;o+=4)n[o]+=r,n[o+1]+=r,n[o+2]+=r;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{brightness:this.brightness})}}),e.Image.filters.Brightness.fromObject=function(t){return new e.Image.filters.Brightness(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Convolute=e.util.createClass(e.Image.filters.BaseFilter,{type:"Convolute",initialize:function(t){t=t||{},this.opaque=t.opaque,this.matrix=t.matrix||[0,0,0,0,1,0,0,0,0];
var i=e.util.createCanvasElement();this.tmpCtx=i.getContext("2d")},_createImageData:function(t,e){return this.tmpCtx.createImageData(t,e)},applyTo:function(t){for(var e=this.matrix,i=t.getContext("2d"),n=i.getImageData(0,0,t.width,t.height),r=Math.round(Math.sqrt(e.length)),o=Math.floor(r/2),a=n.data,s=n.width,l=n.height,c=s,h=l,u=this._createImageData(c,h),f=u.data,d=this.opaque?1:0,p=0;h>p;p++)for(var g=0;c>g;g++){for(var v=p,m=g,b=4*(p*c+g),y=0,x=0,w=0,_=0,C=0;r>C;C++)for(var S=0;r>S;S++){var A=v+C-o,k=m+S-o;if(!(0>A||A>l||0>k||k>s)){var T=4*(A*s+k),O=e[C*r+S];y+=a[T]*O,x+=a[T+1]*O,w+=a[T+2]*O,_+=a[T+3]*O}}f[b]=y,f[b+1]=x,f[b+2]=w,f[b+3]=_+d*(255-_)}i.putImageData(u,0,0)},toObject:function(){return i(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=function(t){return new e.Image.filters.Convolute(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.GradientTransparency=e.util.createClass(e.Image.filters.BaseFilter,{type:"GradientTransparency",initialize:function(t){t=t||{},this.threshold=t.threshold||100},applyTo:function(t){for(var e=t.getContext("2d"),i=e.getImageData(0,0,t.width,t.height),n=i.data,r=this.threshold,o=n.length,a=0,s=n.length;s>a;a+=4)n[a+3]=r+255*(o-a)/o;e.putImageData(i,0,0)},toObject:function(){return i(this.callSuper("toObject"),{threshold:this.threshold})}}),e.Image.filters.GradientTransparency.fromObject=function(t){return new e.Image.filters.GradientTransparency(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Grayscale=e.util.createClass(e.Image.filters.BaseFilter,{type:"Grayscale",applyTo:function(t){for(var e,i=t.getContext("2d"),n=i.getImageData(0,0,t.width,t.height),r=n.data,o=n.width*n.height*4,a=0;o>a;)e=(r[a]+r[a+1]+r[a+2])/3,r[a]=e,r[a+1]=e,r[a+2]=e,a+=4;i.putImageData(n,0,0)}}),e.Image.filters.Grayscale.fromObject=function(){return new e.Image.filters.Grayscale}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Invert=e.util.createClass(e.Image.filters.BaseFilter,{type:"Invert",applyTo:function(t){var e,i=t.getContext("2d"),n=i.getImageData(0,0,t.width,t.height),r=n.data,o=r.length;for(e=0;o>e;e+=4)r[e]=255-r[e],r[e+1]=255-r[e+1],r[e+2]=255-r[e+2];i.putImageData(n,0,0)}}),e.Image.filters.Invert.fromObject=function(){return new e.Image.filters.Invert}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Mask=e.util.createClass(e.Image.filters.BaseFilter,{type:"Mask",initialize:function(t){t=t||{},this.mask=t.mask,this.channel=[0,1,2,3].indexOf(t.channel)>-1?t.channel:0},applyTo:function(t){if(this.mask){var i,n=t.getContext("2d"),r=n.getImageData(0,0,t.width,t.height),o=r.data,a=this.mask.getElement(),s=e.util.createCanvasElement(),l=this.channel,c=r.width*r.height*4;s.width=a.width,s.height=a.height,s.getContext("2d").drawImage(a,0,0,a.width,a.height);var h=s.getContext("2d").getImageData(0,0,a.width,a.height),u=h.data;for(i=0;c>i;i+=4)o[i+3]=u[i+l];n.putImageData(r,0,0)}},toObject:function(){return i(this.callSuper("toObject"),{mask:this.mask.toObject(),channel:this.channel})}}),e.Image.filters.Mask.fromObject=function(t,i){e.util.loadImage(t.mask.src,function(n){t.mask=new e.Image(n,t.mask),i&&i(new e.Image.filters.Mask(t))})},e.Image.filters.Mask.async=!0}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Noise=e.util.createClass(e.Image.filters.BaseFilter,{type:"Noise",initialize:function(t){t=t||{},this.noise=t.noise||0},applyTo:function(t){for(var e,i=t.getContext("2d"),n=i.getImageData(0,0,t.width,t.height),r=n.data,o=this.noise,a=0,s=r.length;s>a;a+=4)e=(.5-Math.random())*o,r[a]+=e,r[a+1]+=e,r[a+2]+=e;i.putImageData(n,0,0)},toObject:function(){return i(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=function(t){return new e.Image.filters.Noise(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Pixelate=e.util.createClass(e.Image.filters.BaseFilter,{type:"Pixelate",initialize:function(t){t=t||{},this.blocksize=t.blocksize||4},applyTo:function(t){var e,i,n,r,o,a,s,l=t.getContext("2d"),c=l.getImageData(0,0,t.width,t.height),h=c.data,u=c.height,f=c.width;for(i=0;u>i;i+=this.blocksize)for(n=0;f>n;n+=this.blocksize){e=4*i*f+4*n,r=h[e],o=h[e+1],a=h[e+2],s=h[e+3];for(var d=i,p=i+this.blocksize;p>d;d++)for(var g=n,v=n+this.blocksize;v>g;g++)e=4*d*f+4*g,h[e]=r,h[e+1]=o,h[e+2]=a,h[e+3]=s}l.putImageData(c,0,0)},toObject:function(){return i(this.callSuper("toObject"),{blocksize:this.blocksize})}}),e.Image.filters.Pixelate.fromObject=function(t){return new e.Image.filters.Pixelate(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.RemoveWhite=e.util.createClass(e.Image.filters.BaseFilter,{type:"RemoveWhite",initialize:function(t){t=t||{},this.threshold=t.threshold||30,this.distance=t.distance||20},applyTo:function(t){for(var e,i,n,r=t.getContext("2d"),o=r.getImageData(0,0,t.width,t.height),a=o.data,s=this.threshold,l=this.distance,c=255-s,h=Math.abs,u=0,f=a.length;f>u;u+=4)e=a[u],i=a[u+1],n=a[u+2],e>c&&i>c&&n>c&&h(e-i)<l&&h(e-n)<l&&h(i-n)<l&&(a[u+3]=1);r.putImageData(o,0,0)},toObject:function(){return i(this.callSuper("toObject"),{threshold:this.threshold,distance:this.distance})}}),e.Image.filters.RemoveWhite.fromObject=function(t){return new e.Image.filters.RemoveWhite(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Sepia=e.util.createClass(e.Image.filters.BaseFilter,{type:"Sepia",applyTo:function(t){var e,i,n=t.getContext("2d"),r=n.getImageData(0,0,t.width,t.height),o=r.data,a=o.length;for(e=0;a>e;e+=4)i=.3*o[e]+.59*o[e+1]+.11*o[e+2],o[e]=i+100,o[e+1]=i+50,o[e+2]=i+255;n.putImageData(r,0,0)}}),e.Image.filters.Sepia.fromObject=function(){return new e.Image.filters.Sepia}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Image.filters.Sepia2=e.util.createClass(e.Image.filters.BaseFilter,{type:"Sepia2",applyTo:function(t){var e,i,n,r,o=t.getContext("2d"),a=o.getImageData(0,0,t.width,t.height),s=a.data,l=s.length;for(e=0;l>e;e+=4)i=s[e],n=s[e+1],r=s[e+2],s[e]=(.393*i+.769*n+.189*r)/1.351,s[e+1]=(.349*i+.686*n+.168*r)/1.203,s[e+2]=(.272*i+.534*n+.131*r)/2.14;o.putImageData(a,0,0)}}),e.Image.filters.Sepia2.fromObject=function(){return new e.Image.filters.Sepia2}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Tint=e.util.createClass(e.Image.filters.BaseFilter,{type:"Tint",initialize:function(t){t=t||{},this.color=t.color||"#000000",this.opacity="undefined"!=typeof t.opacity?t.opacity:new e.Color(this.color).getAlpha()},applyTo:function(t){var i,n,r,o,a,s,l,c,h,u=t.getContext("2d"),f=u.getImageData(0,0,t.width,t.height),d=f.data,p=d.length;for(h=new e.Color(this.color).getSource(),n=h[0]*this.opacity,r=h[1]*this.opacity,o=h[2]*this.opacity,c=1-this.opacity,i=0;p>i;i+=4)a=d[i],s=d[i+1],l=d[i+2],d[i]=n+a*c,d[i+1]=r+s*c,d[i+2]=o+l*c;u.putImageData(f,0,0)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color,opacity:this.opacity})}}),e.Image.filters.Tint.fromObject=function(t){return new e.Image.filters.Tint(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend;e.Image.filters.Multiply=e.util.createClass(e.Image.filters.BaseFilter,{type:"Multiply",initialize:function(t){t=t||{},this.color=t.color||"#000000"},applyTo:function(t){var i,n,r=t.getContext("2d"),o=r.getImageData(0,0,t.width,t.height),a=o.data,s=a.length;for(n=new e.Color(this.color).getSource(),i=0;s>i;i+=4)a[i]*=n[0]/255,a[i+1]*=n[1]/255,a[i+2]*=n[2]/255;r.putImageData(o,0,0)},toObject:function(){return i(this.callSuper("toObject"),{color:this.color})}}),e.Image.filters.Multiply.fromObject=function(t){return new e.Image.filters.Multiply(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric;e.Image.filters.Blend=e.util.createClass({type:"Blend",initialize:function(t){t=t||{},this.color=t.color||"#000",this.image=t.image||!1,this.mode=t.mode||"multiply",this.alpha=t.alpha||1},applyTo:function(t){var i,n,r,o,a,s,l,c=t.getContext("2d"),h=c.getImageData(0,0,t.width,t.height),u=h.data,f=!1;if(this.image){f=!0;var d=e.util.createCanvasElement();d.width=this.image.width,d.height=this.image.height;var p=new e.StaticCanvas(d);p.add(this.image);var g=p.getContext("2d");l=g.getImageData(0,0,p.width,p.height).data}else l=new e.Color(this.color).getSource(),i=l[0]*this.alpha,n=l[1]*this.alpha,r=l[2]*this.alpha;for(var v=0,m=u.length;m>v;v+=4)switch(o=u[v],a=u[v+1],s=u[v+2],f&&(i=l[v]*this.alpha,n=l[v+1]*this.alpha,r=l[v+2]*this.alpha),this.mode){case"multiply":u[v]=o*i/255,u[v+1]=a*n/255,u[v+2]=s*r/255;break;case"screen":u[v]=1-(1-o)*(1-i),u[v+1]=1-(1-a)*(1-n),u[v+2]=1-(1-s)*(1-r);break;case"add":u[v]=Math.min(255,o+i),u[v+1]=Math.min(255,a+n),u[v+2]=Math.min(255,s+r);break;case"diff":case"difference":u[v]=Math.abs(o-i),u[v+1]=Math.abs(a-n),u[v+2]=Math.abs(s-r);break;case"subtract":var b=o-i,y=a-n,x=s-r;u[v]=0>b?0:b,u[v+1]=0>y?0:y,u[v+2]=0>x?0:x;break;case"darken":u[v]=Math.min(o,i),u[v+1]=Math.min(a,n),u[v+2]=Math.min(s,r);break;case"lighten":u[v]=Math.max(o,i),u[v+1]=Math.max(a,n),u[v+2]=Math.max(s,r)}c.putImageData(h,0,0)}}),e.Image.filters.Blend.fromObject=function(t){return new e.Image.filters.Blend(t)}}("undefined"!=typeof exports?exports:this),function(t){"use strict";var e=t.fabric||(t.fabric={}),i=e.util.object.extend,n=e.util.object.clone,r=e.util.toFixed,o=e.StaticCanvas.supports("setLineDash");if(e.Text)return void e.warn("fabric.Text is already defined");var a=e.Object.prototype.stateProperties.concat();a.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor","useNative","path"),e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,textDecoration:!0,fontStyle:!0,lineHeight:!0,stroke:!0,strokeWidth:!0,text:!0},_reNewline:/\r?\n/,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.3,textBackgroundColor:"",path:null,useNative:!0,stateProperties:a,stroke:null,shadow:null,initialize:function(t,e){e=e||{},this.text=t,this.__skipDimension=!0,this.setOptions(e),this.__skipDimension=!1,this._initDimensions()},_initDimensions:function(){if(!this.__skipDimension){var t=e.util.createCanvasElement();this._render(t.getContext("2d"))}},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(t){"undefined"==typeof Cufon||this.useNative===!0?this._renderViaNative(t):this._renderViaCufon(t)},_renderViaNative:function(t){var i=this.text.split(this._reNewline);this._setTextStyles(t),this.width=this._getTextWidth(t,i),this.height=this._getTextHeight(t,i),this.clipTo&&e.util.clipContext(this,t),this._renderTextBackground(t,i),this._translateForTextAlign(t),this._renderText(t,i),"left"!==this.textAlign&&"justify"!==this.textAlign&&t.restore(),this._renderTextDecoration(t,i),this.clipTo&&t.restore(),this._setBoundaries(t,i),this._totalLineHeight=0},_renderText:function(t,e){t.save(),this._setShadow(t),this._setupFillRule(t),this._renderTextFill(t,e),this._renderTextStroke(t,e),this._restoreFillRule(t),this._removeShadow(t),t.restore()},_translateForTextAlign:function(t){"left"!==this.textAlign&&"justify"!==this.textAlign&&(t.save(),t.translate("center"===this.textAlign?this.width/2:this.width,0))},_setBoundaries:function(t,e){this._boundaries=[];for(var i=0,n=e.length;n>i;i++){var r=this._getLineWidth(t,e[i]),o=this._getLineLeftOffset(r);this._boundaries.push({height:this.fontSize*this.lineHeight,width:r,left:o})}},_setTextStyles:function(t){this._setFillStyles(t),this._setStrokeStyles(t),t.textBaseline="alphabetic",this.skipTextAlign||(t.textAlign=this.textAlign),t.font=this._getFontDeclaration()},_getTextHeight:function(t,e){return this.fontSize*e.length*this.lineHeight},_getTextWidth:function(t,e){for(var i=t.measureText(e[0]||"|").width,n=1,r=e.length;r>n;n++){var o=t.measureText(e[n]).width;o>i&&(i=o)}return i},_renderChars:function(t,e,i,n,r){e[t](i,n,r)},_renderTextLine:function(t,e,i,n,r,o){if(r-=this.fontSize/4,"justify"!==this.textAlign)return void this._renderChars(t,e,i,n,r,o);var a=e.measureText(i).width,s=this.width;if(s>a)for(var l=i.split(/\s+/),c=e.measureText(i.replace(/\s+/g,"")).width,h=s-c,u=l.length-1,f=h/u,d=0,p=0,g=l.length;g>p;p++)this._renderChars(t,e,l[p],n+d,r,o),d+=e.measureText(l[p]).width+f;else this._renderChars(t,e,i,n,r,o)},_getLeftOffset:function(){return e.isLikelyNode?0:-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextFill:function(t,e){if(this.fill||this._skipFillStrokeCheck){this._boundaries=[];for(var i=0,n=0,r=e.length;r>n;n++){var o=this._getHeightOfLine(t,n,e);i+=o,this._renderTextLine("fillText",t,e[n],this._getLeftOffset(),this._getTopOffset()+i,n)}}},_renderTextStroke:function(t,e){if(this.stroke&&0!==this.strokeWidth||this._skipFillStrokeCheck){var i=0;t.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),o&&t.setLineDash(this.strokeDashArray)),t.beginPath();for(var n=0,r=e.length;r>n;n++){var a=this._getHeightOfLine(t,n,e);i+=a,this._renderTextLine("strokeText",t,e[n],this._getLeftOffset(),this._getTopOffset()+i,n)}t.closePath(),t.restore()}},_getHeightOfLine:function(){return this.fontSize*this.lineHeight},_renderTextBackground:function(t,e){this._renderTextBoxBackground(t),this._renderTextLinesBackground(t,e)},_renderTextBoxBackground:function(t){this.backgroundColor&&(t.save(),t.fillStyle=this.backgroundColor,t.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),t.restore())},_renderTextLinesBackground:function(t,e){if(this.textBackgroundColor){t.save(),t.fillStyle=this.textBackgroundColor;for(var i=0,n=e.length;n>i;i++)if(""!==e[i]){var r=this._getLineWidth(t,e[i]),o=this._getLineLeftOffset(r);t.fillRect(this._getLeftOffset()+o,this._getTopOffset()+i*this.fontSize*this.lineHeight,r,this.fontSize*this.lineHeight)}t.restore()}},_getLineLeftOffset:function(t){return"center"===this.textAlign?(this.width-t)/2:"right"===this.textAlign?this.width-t:0},_getLineWidth:function(t,e){return"justify"===this.textAlign?this.width:t.measureText(e).width},_renderTextDecoration:function(t,e){function i(i){for(var o=0,a=e.length;a>o;o++){var s=r._getLineWidth(t,e[o]),l=r._getLineLeftOffset(s);t.fillRect(r._getLeftOffset()+l,~~(i+o*r._getHeightOfLine(t,o,e)-n),s,1)}}if(this.textDecoration){var n=this._getTextHeight(t,e)/2,r=this;this.textDecoration.indexOf("underline")>-1&&i(this.fontSize*this.lineHeight),this.textDecoration.indexOf("line-through")>-1&&i(this.fontSize*this.lineHeight-this.fontSize/2),this.textDecoration.indexOf("overline")>-1&&i(this.fontSize*this.lineHeight-this.fontSize)}},_getFontDeclaration:function(){return[e.isLikelyNode?this.fontWeight:this.fontStyle,e.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",e.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(t,e){if(this.visible){t.save(),this._transform(t,e);var i=this.transformMatrix,n=this.group&&"path-group"===this.group.type;n&&t.translate(-this.group.width/2,-this.group.height/2),i&&t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),n&&t.translate(this.left,this.top),this._render(t),t.restore()}},toObject:function(t){var e=i(this.callSuper("toObject",t),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,path:this.path,textBackgroundColor:this.textBackgroundColor,useNative:this.useNative});return this.includeDefaultValues||this._removeDefaultValues(e),e},toSVG:function(t){var e=[],i=this.text.split(this._reNewline),n=this._getSVGLeftTopOffsets(i),r=this._getSVGTextAndBg(n.lineTop,n.textLeft,i),o=this._getSVGShadows(n.lineTop,i);return n.textTop+=this._fontAscent?this._fontAscent/5*this.lineHeight:0,this._wrapSVGTextAndBg(e,r,o,n),t?t(e.join("")):e.join("")},_getSVGLeftTopOffsets:function(t){var e=this.useNative?this.fontSize*this.lineHeight:-this._fontAscent-this._fontAscent/5*this.lineHeight,i=-(this.width/2),n=this.useNative?this.fontSize-1:this.height/2-t.length*this.fontSize-this._totalLineHeight;return{textLeft:i+(this.group?this.left:0),textTop:n+(this.group?this.top:0),lineTop:e}},_wrapSVGTextAndBg:function(t,e,i,n){t.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n',e.textBgRects.join(""),"<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(),'" ','transform="translate(',r(n.textLeft,2)," ",r(n.textTop,2),')">',i.join(""),e.textSpans.join(""),"</text>\n","</g>\n")},_getSVGShadows:function(t,i){var n,o,a=[],s=1;if(!this.shadow||!this._boundaries)return a;for(n=0,o=i.length;o>n;n++)if(""!==i[n]){var l=this._boundaries&&this._boundaries[n]?this._boundaries[n].left:0;a.push('<tspan x="',r(l+s+this.shadow.offsetX,2),0===n||this.useNative?'" y':'" dy','="',r(this.useNative?t*n-this.height/2+this.shadow.offsetY:t+(0===n?this.shadow.offsetY:0),2),'" ',this._getFillAttributes(this.shadow.color),">",e.util.string.escapeXml(i[n]),"</tspan>"),s=1}else s++;return a},_getSVGTextAndBg:function(t,e,i){var n=[],r=[],o=1;this._setSVGBg(r);for(var a=0,s=i.length;s>a;a++)""!==i[a]?(this._setSVGTextLineText(i[a],a,n,t,o,r),o=1):o++,this.textBackgroundColor&&this._boundaries&&this._setSVGTextLineBg(r,a,e,t);return{textSpans:n,textBgRects:r}},_setSVGTextLineText:function(t,i,n,o,a){var s=this._boundaries&&this._boundaries[i]?r(this._boundaries[i].left,2):0;n.push('<tspan x="',s,'" ',0===i||this.useNative?"y":"dy",'="',r(this.useNative?o*i-this.height/2:o*a,2),'" ',this._getFillAttributes(this.fill),">",e.util.string.escapeXml(t),"</tspan>")},_setSVGTextLineBg:function(t,e,i,n){t.push("<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',r(i+this._boundaries[e].left,2),'" y="',r(n*e-this.height/2,2),'" width="',r(this._boundaries[e].width,2),'" height="',r(this._boundaries[e].height,2),'"></rect>\n')},_setSVGBg:function(t){this.backgroundColor&&this._boundaries&&t.push("<rect ",this._getFillAttributes(this.backgroundColor),' x="',r(-this.width/2,2),'" y="',r(-this.height/2,2),'" width="',r(this.width,2),'" height="',r(this.height,2),'"></rect>')},_getFillAttributes:function(t){var i=t&&"string"==typeof t?new e.Color(t):"";return i&&i.getSource()&&1!==i.getAlpha()?'opacity="'+i.getAlpha()+'" fill="'+i.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_set:function(t,e){"fontFamily"===t&&this.path&&(this.path=this.path.replace(/(.*?)([^\/]*)(\.font\.js)/,"$1"+e+"$3")),this.callSuper("_set",t,e),t in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,i){if(!t)return null;var n=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES);i=e.util.object.extend(i?e.util.object.clone(i):{},n),"dx"in n&&(i.left+=n.dx),"dy"in n&&(i.top+=n.dy),"fontSize"in i||(i.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE),i.originX||(i.originX="left");var r=new e.Text(t.textContent,i),o=0;return"left"===r.originX&&(o=r.getWidth()/2),"right"===r.originX&&(o=-r.getWidth()/2),r.set({left:r.getLeft()+o,top:r.getTop()-r.getHeight()/2}),r},e.Text.fromObject=function(t){return new e.Text(t.text,n(t))},e.util.createAccessors(e.Text)}("undefined"!=typeof exports?exports:this),function(){var t=fabric.util.object.clone;fabric.IText=fabric.util.createClass(fabric.Text,fabric.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1e3,cursorDuration:600,styles:null,caching:!0,_skipFillStrokeCheck:!0,_reSpace:/\s|\n/,_fontSizeFraction:4,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,_charWidthsCache:{},initialize:function(t,e){this.styles=e?e.styles||{}:{},this.callSuper("initialize",t,e),this.initBehavior(),fabric.IText.instances.push(this),this.__lineWidths={},this.__lineHeights={},this.__lineOffsets={}},isEmptyStyles:function(){if(!this.styles)return!0;var t=this.styles;for(var e in t)for(var i in t[e])for(var n in t[e][i])return!1;return!0},setSelectionStart:function(t){this.selectionStart!==t&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})),this.selectionStart=t,this.hiddenTextarea&&(this.hiddenTextarea.selectionStart=t)},setSelectionEnd:function(t){this.selectionEnd!==t&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})),this.selectionEnd=t,this.hiddenTextarea&&(this.hiddenTextarea.selectionEnd=t)},getSelectionStyles:function(t,e){if(2===arguments.length){for(var i=[],n=t;e>n;n++)i.push(this.getSelectionStyles(n));return i}var r=this.get2DCursorLocation(t);return this.styles[r.lineIndex]?this.styles[r.lineIndex][r.charIndex]||{}:{}},setSelectionStyles:function(t){if(this.selectionStart===this.selectionEnd)this._extendStyles(this.selectionStart,t);else for(var e=this.selectionStart;e<this.selectionEnd;e++)this._extendStyles(e,t);return this},_extendStyles:function(t,e){var i=this.get2DCursorLocation(t);this.styles[i.lineIndex]||(this.styles[i.lineIndex]={}),this.styles[i.lineIndex][i.charIndex]||(this.styles[i.lineIndex][i.charIndex]={}),fabric.util.object.extend(this.styles[i.lineIndex][i.charIndex],e)},_render:function(t){this.callSuper("_render",t),this.ctx=t,this.isEditing&&this.renderCursorOrSelection()},renderCursorOrSelection:function(){if(this.active){var t,e=this.text.split("");this.selectionStart===this.selectionEnd?(t=this._getCursorBoundaries(e,"cursor"),this.renderCursor(t)):(t=this._getCursorBoundaries(e,"selection"),this.renderSelection(e,t))}},get2DCursorLocation:function(t){"undefined"==typeof t&&(t=this.selectionStart);var e=this.text.slice(0,t),i=e.split(this._reNewline);return{lineIndex:i.length-1,charIndex:i[i.length-1].length}},getCurrentCharStyle:function(t,e){var i=this.styles[t]&&this.styles[t][0===e?0:e-1];return{fontSize:i&&i.fontSize||this.fontSize,fill:i&&i.fill||this.fill,textBackgroundColor:i&&i.textBackgroundColor||this.textBackgroundColor,textDecoration:i&&i.textDecoration||this.textDecoration,fontFamily:i&&i.fontFamily||this.fontFamily,fontWeight:i&&i.fontWeight||this.fontWeight,fontStyle:i&&i.fontStyle||this.fontStyle,stroke:i&&i.stroke||this.stroke,strokeWidth:i&&i.strokeWidth||this.strokeWidth}},getCurrentCharFontSize:function(t,e){return this.styles[t]&&this.styles[t][0===e?0:e-1]&&this.styles[t][0===e?0:e-1].fontSize||this.fontSize},getCurrentCharColor:function(t,e){return this.styles[t]&&this.styles[t][0===e?0:e-1]&&this.styles[t][0===e?0:e-1].fill||this.cursorColor},_getCursorBoundaries:function(t,e){var i=this.get2DCursorLocation(),n=this.text.split(this._reNewline),r=Math.round(this._getLeftOffset()),o=-this.height/2,a=this._getCursorBoundariesOffsets(t,e,i,n);return{left:r,top:o,leftOffset:a.left+a.lineLeft,topOffset:a.top}},_getCursorBoundariesOffsets:function(t,e,i,n){for(var r=0,o=0,a=0,s=0,l="cursor"===e?this._getHeightOfLine(this.ctx,0)-this.getCurrentCharFontSize(i.lineIndex,i.charIndex):0,c=0;c<this.selectionStart;c++){if("\n"===t[c]){s=0;var h=o+("cursor"===e?1:0);l+=this._getCachedLineHeight(h),o++,a=0}else s+=this._getWidthOfChar(this.ctx,t[c],o,a),a++;r=this._getCachedLineOffset(o,n)}return this._clearCache(),{top:l,left:s,lineLeft:r}},_clearCache:function(){this.__lineWidths={},this.__lineHeights={},this.__lineOffsets={}},_getCachedLineHeight:function(t){return this.__lineHeights[t]||(this.__lineHeights[t]=this._getHeightOfLine(this.ctx,t))},_getCachedLineWidth:function(t,e){return this.__lineWidths[t]||(this.__lineWidths[t]=this._getWidthOfLine(this.ctx,t,e))},_getCachedLineOffset:function(t,e){var i=this._getCachedLineWidth(t,e);return this.__lineOffsets[t]||(this.__lineOffsets[t]=this._getLineLeftOffset(i))},renderCursor:function(t){var e=this.ctx;e.save();var i=this.get2DCursorLocation(),n=i.lineIndex,r=i.charIndex,o=this.getCurrentCharFontSize(n,r),a=0===n&&0===r?this._getCachedLineOffset(n,this.text.split(this._reNewline)):t.leftOffset;e.fillStyle=this.getCurrentCharColor(n,r),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+a,t.top+t.topOffset,this.cursorWidth/this.scaleX,o),e.restore()},renderSelection:function(t,e){var i=this.ctx;i.save(),i.fillStyle=this.selectionColor;for(var n=this.get2DCursorLocation(this.selectionStart),r=this.get2DCursorLocation(this.selectionEnd),o=n.lineIndex,a=r.lineIndex,s=this.text.split(this._reNewline),l=o;a>=l;l++){var c=this._getCachedLineOffset(l,s)||0,h=this._getCachedLineHeight(l),u=0;if(l===o)for(var f=0,d=s[l].length;d>f;f++)f>=n.charIndex&&(l!==a||f<r.charIndex)&&(u+=this._getWidthOfChar(i,s[l][f],l,f)),f<n.charIndex&&(c+=this._getWidthOfChar(i,s[l][f],l,f));else if(l>o&&a>l)u+=this._getCachedLineWidth(l,s)||5;else if(l===a)for(var p=0,g=r.charIndex;g>p;p++)u+=this._getWidthOfChar(i,s[l][p],l,p);i.fillRect(e.left+c,e.top+e.topOffset,u,h),e.topOffset+=h}i.restore()},_renderChars:function(t,e,i,n,r,o){if(this.isEmptyStyles())return this._renderCharsFast(t,e,i,n,r);this.skipTextAlign=!0,n-="center"===this.textAlign?this.width/2:"right"===this.textAlign?this.width:0;var a,s=this.text.split(this._reNewline),l=this._getWidthOfLine(e,o,s),c=this._getHeightOfLine(e,o,s),h=this._getLineLeftOffset(l),u=i.split(""),f="";n+=h||0,e.save();for(var d=0,p=u.length;p>=d;d++){a=a||this.getCurrentCharStyle(o,d);var g=this.getCurrentCharStyle(o,d+1);(this._hasStyleChanged(a,g)||d===p)&&(this._renderChar(t,e,o,d-1,f,n,r,c),f="",a=g),f+=u[d]}e.restore()},_renderCharsFast:function(t,e,i,n,r){this.skipTextAlign=!1,"fillText"===t&&this.fill&&this.callSuper("_renderChars",t,e,i,n,r),"strokeText"===t&&this.stroke&&this.callSuper("_renderChars",t,e,i,n,r)},_renderChar:function(t,e,i,n,r,o,a,s){var l,c,h;if(this.styles&&this.styles[i]&&(l=this.styles[i][n])){var u=l.stroke||this.stroke,f=l.fill||this.fill;e.save(),c=this._applyCharStylesGetWidth(e,r,i,n,l),h=this._getHeightOfChar(e,r,i,n),f&&e.fillText(r,o,a),u&&e.strokeText(r,o,a),this._renderCharDecoration(e,l,o,a,c,s,h),e.restore(),e.translate(c,0)}else"strokeText"===t&&this.stroke&&e[t](r,o,a),"fillText"===t&&this.fill&&e[t](r,o,a),c=this._applyCharStylesGetWidth(e,r,i,n),this._renderCharDecoration(e,null,o,a,c,s),e.translate(e.measureText(r).width,0)},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.fontSize!==e.fontSize||t.textBackgroundColor!==e.textBackgroundColor||t.textDecoration!==e.textDecoration||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth},_renderCharDecoration:function(t,e,i,n,r,o,a){var s=e?e.textDecoration||this.textDecoration:this.textDecoration,l=(e?e.fontSize:null)||this.fontSize;s&&(s.indexOf("underline")>-1&&this._renderCharDecorationAtOffset(t,i,n+this.fontSize/this._fontSizeFraction,r,0,this.fontSize/20),s.indexOf("line-through")>-1&&this._renderCharDecorationAtOffset(t,i,n+this.fontSize/this._fontSizeFraction,r,a/2,l/20),s.indexOf("overline")>-1&&this._renderCharDecorationAtOffset(t,i,n,r,o-this.fontSize/this._fontSizeFraction,this.fontSize/20))},_renderCharDecorationAtOffset:function(t,e,i,n,r,o){t.fillRect(e,i-r,n,o)},_renderTextLine:function(t,e,i,n,r,o){r+=this.fontSize/4,this.callSuper("_renderTextLine",t,e,i,n,r,o)},_renderTextDecoration:function(t,e){return this.isEmptyStyles()?this.callSuper("_renderTextDecoration",t,e):void 0},_renderTextLinesBackground:function(t,e){if(this.textBackgroundColor||this.styles){t.save(),this.textBackgroundColor&&(t.fillStyle=this.textBackgroundColor);for(var i=0,n=this.fontSize/this._fontSizeFraction,r=0,o=e.length;o>r;r++){var a=this._getHeightOfLine(t,r,e);if(""!==e[r]){var s=this._getWidthOfLine(t,r,e),l=this._getLineLeftOffset(s);if(this.textBackgroundColor&&(t.fillStyle=this.textBackgroundColor,t.fillRect(this._getLeftOffset()+l,this._getTopOffset()+i+n,s,a)),this.styles[r])for(var c=0,h=e[r].length;h>c;c++)if(this.styles[r]&&this.styles[r][c]&&this.styles[r][c].textBackgroundColor){var u=e[r][c];t.fillStyle=this.styles[r][c].textBackgroundColor,t.fillRect(this._getLeftOffset()+l+this._getWidthOfCharsAt(t,r,c,e),this._getTopOffset()+i+n,this._getWidthOfChar(t,u,r,c,e)+1,a)}i+=a}else i+=a}t.restore()}},_getCacheProp:function(t,e){return t+e.fontFamily+e.fontSize+e.fontWeight+e.fontStyle+e.shadow},_applyCharStylesGetWidth:function(e,i,n,r,o){var a=o||this.styles[n]&&this.styles[n][r];a=a?t(a):{},this._applyFontStyles(a);var s=this._getCacheProp(i,a);if(this.isEmptyStyles()&&this._charWidthsCache[s]&&this.caching)return this._charWidthsCache[s];"string"==typeof a.shadow&&(a.shadow=new fabric.Shadow(a.shadow));var l=a.fill||this.fill;return e.fillStyle=l.toLive?l.toLive(e):l,a.stroke&&(e.strokeStyle=a.stroke&&a.stroke.toLive?a.stroke.toLive(e):a.stroke),e.lineWidth=a.strokeWidth||this.strokeWidth,e.font=this._getFontDeclaration.call(a),this._setShadow.call(a,e),this.caching?(this._charWidthsCache[s]||(this._charWidthsCache[s]=e.measureText(i).width),this._charWidthsCache[s]):e.measureText(i).width},_applyFontStyles:function(t){t.fontFamily||(t.fontFamily=this.fontFamily),t.fontSize||(t.fontSize=this.fontSize),t.fontWeight||(t.fontWeight=this.fontWeight),t.fontStyle||(t.fontStyle=this.fontStyle)},_getStyleDeclaration:function(e,i){return this.styles[e]&&this.styles[e][i]?t(this.styles[e][i]):{}},_getWidthOfChar:function(t,e,i,n){var r=this._getStyleDeclaration(i,n);this._applyFontStyles(r);var o=this._getCacheProp(e,r);if(this._charWidthsCache[o]&&this.caching)return this._charWidthsCache[o];if(t){t.save();var a=this._applyCharStylesGetWidth(t,e,i,n);return t.restore(),a}},_getHeightOfChar:function(t,e,i,n){return this.styles[i]&&this.styles[i][n]?this.styles[i][n].fontSize||this.fontSize:this.fontSize},_getWidthOfCharAt:function(t,e,i,n){n=n||this.text.split(this._reNewline);var r=n[e].split("")[i];return this._getWidthOfChar(t,r,e,i)},_getHeightOfCharAt:function(t,e,i,n){n=n||this.text.split(this._reNewline);var r=n[e].split("")[i];return this._getHeightOfChar(t,r,e,i)},_getWidthOfCharsAt:function(t,e,i,n){for(var r=0,o=0;i>o;o++)r+=this._getWidthOfCharAt(t,e,o,n);return r},_getWidthOfLine:function(t,e,i){return this._getWidthOfCharsAt(t,e,i[e].length,i)},_getTextWidth:function(t,e){if(this.isEmptyStyles())return this.callSuper("_getTextWidth",t,e);for(var i=this._getWidthOfLine(t,0,e),n=1,r=e.length;r>n;n++){var o=this._getWidthOfLine(t,n,e);o>i&&(i=o)}return i},_getHeightOfLine:function(t,e,i){i=i||this.text.split(this._reNewline);for(var n=this._getHeightOfChar(t,i[e][0],e,0),r=i[e],o=r.split(""),a=1,s=o.length;s>a;a++){var l=this._getHeightOfChar(t,o[a],e,a);l>n&&(n=l)}return n*this.lineHeight},_getTextHeight:function(t,e){for(var i=0,n=0,r=e.length;r>n;n++)i+=this._getHeightOfLine(t,n,e);
return i},_getTopOffset:function(){var t=fabric.Text.prototype._getTopOffset.call(this);return t-this.fontSize/this._fontSizeFraction},_renderTextBoxBackground:function(t){this.backgroundColor&&(t.save(),t.fillStyle=this.backgroundColor,t.fillRect(this._getLeftOffset(),this._getTopOffset()+this.fontSize/this._fontSizeFraction,this.width,this.height),t.restore())},toObject:function(e){return fabric.util.object.extend(this.callSuper("toObject",e),{styles:t(this.styles)})}}),fabric.IText.fromObject=function(e){return new fabric.IText(e.text,t(e))},fabric.IText.instances=[]}(),function(){var t=fabric.util.object.clone;fabric.util.object.extend(fabric.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation()},initSelectedHandler:function(){this.on("selected",function(){var t=this;setTimeout(function(){t.selected=!0},100)})},initAddedHandler:function(){this.on("added",function(){this.canvas&&!this.canvas._hasITextHandlers&&(this.canvas._hasITextHandlers=!0,this._initCanvasHandlers())})},_initCanvasHandlers:function(){this.canvas.on("selection:cleared",function(){fabric.IText.prototype.exitEditingOnOthers.call()}),this.canvas.on("mouse:up",function(){fabric.IText.instances.forEach(function(t){t.__isMousedown=!1})}),this.canvas.on("object:selected",function(t){fabric.IText.prototype.exitEditingOnOthers.call(t.target)})},_tick:function(){if(!this._abortCursorAnimation){var t=this;this.animate("_currentCursorOpacity",1,{duration:this.cursorDuration,onComplete:function(){t._onTickComplete()},onChange:function(){t.canvas&&t.canvas.renderAll()},abort:function(){return t._abortCursorAnimation}})}},_onTickComplete:function(){if(!this._abortCursorAnimation){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){t.animate("_currentCursorOpacity",0,{duration:this.cursorDuration/2,onComplete:function(){t._tick()},onChange:function(){t.canvas&&t.canvas.renderAll()},abort:function(){return t._abortCursorAnimation}})},100)}},initDelayedCursor:function(t){var e=this,i=t?0:this.cursorDelay;t&&(this._abortCursorAnimation=!0,clearTimeout(this._cursorTimeout1),this._currentCursorOpacity=1,this.canvas&&this.canvas.renderAll()),this._cursorTimeout2&&clearTimeout(this._cursorTimeout2),this._cursorTimeout2=setTimeout(function(){e._abortCursorAnimation=!1,e._tick()},i)},abortCursorAnimation:function(){this._abortCursorAnimation=!0,clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,this.canvas&&this.canvas.renderAll();var t=this;setTimeout(function(){t._abortCursorAnimation=!1},10)},selectAll:function(){this.selectionStart=0,this.selectionEnd=this.text.length,this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},getSelectedText:function(){return this.text.slice(this.selectionStart,this.selectionEnd)},findWordBoundaryLeft:function(t){var e=0,i=t-1;if(this._reSpace.test(this.text.charAt(i)))for(;this._reSpace.test(this.text.charAt(i));)e++,i--;for(;/\S/.test(this.text.charAt(i))&&i>-1;)e++,i--;return t-e},findWordBoundaryRight:function(t){var e=0,i=t;if(this._reSpace.test(this.text.charAt(i)))for(;this._reSpace.test(this.text.charAt(i));)e++,i++;for(;/\S/.test(this.text.charAt(i))&&i<this.text.length;)e++,i++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,i=t-1;!/\n/.test(this.text.charAt(i))&&i>-1;)e++,i--;return t-e},findLineBoundaryRight:function(t){for(var e=0,i=t;!/\n/.test(this.text.charAt(i))&&i<this.text.length;)e++,i++;return t+e},getNumNewLinesInSelectedText:function(){for(var t=this.getSelectedText(),e=0,i=0,n=t.split(""),r=n.length;r>i;i++)"\n"===n[i]&&e++;return e},searchWordBoundary:function(t,e){for(var i=this._reSpace.test(this.text.charAt(t))?t-1:t,n=this.text.charAt(i),r=/[ \n\.,;!\?\-]/;!r.test(n)&&i>0&&i<this.text.length;)i+=e,n=this.text.charAt(i);return r.test(n)&&"\n"!==n&&(i+=1===e?0:1),i},selectWord:function(t){var e=this.searchWordBoundary(t,-1),i=this.searchWordBoundary(t,1);this.setSelectionStart(e),this.setSelectionEnd(i),this.initDelayedCursor(!0)},selectLine:function(t){var e=this.findLineBoundaryLeft(t),i=this.findLineBoundaryRight(t);this.setSelectionStart(e),this.setSelectionEnd(i),this.initDelayedCursor(!0)},enterEditing:function(){return!this.isEditing&&this.editable?(this.exitEditingOnOthers(),this.isEditing=!0,this.initHiddenTextarea(),this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._tick(),this.canvas&&this.canvas.renderAll(),this.fire("editing:entered"),this.canvas&&this.canvas.fire("text:editing:entered",{target:this}),this):void 0},exitEditingOnOthers:function(){fabric.IText.instances.forEach(function(t){t.selected=!1,t.isEditing&&t.exitEditing()},this)},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},_updateTextarea:function(){this.hiddenTextarea&&(this.hiddenTextarea.value=this.text,this.hiddenTextarea.selectionStart=this.selectionStart)},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.overCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){return this.selected=!1,this.isEditing=!1,this.selectable=!0,this.selectionEnd=this.selectionStart,this.hiddenTextarea&&this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this.fire("editing:exited"),this.canvas&&this.canvas.fire("text:editing:exited",{target:this}),this},_removeExtraneousStyles:function(){var t=this.text.split(this._reNewline);for(var e in this.styles)t[e]||delete this.styles[e]},_removeCharsFromTo:function(t,e){for(var i=e;i!==t;){var n=this.get2DCursorLocation(i).charIndex;i--;var r=this.get2DCursorLocation(i).charIndex,o=r>n;o?this.removeStyleObject(o,i+1):this.removeStyleObject(0===this.get2DCursorLocation(i).charIndex,i)}this.text=this.text.slice(0,t)+this.text.slice(e)},insertChars:function(t){var e="\n"===this.text.slice(this.selectionStart,this.selectionStart+1);this.text=this.text.slice(0,this.selectionStart)+t+this.text.slice(this.selectionEnd),this.selectionStart===this.selectionEnd&&this.insertStyleObjects(t,e,this.copiedStyles),this.selectionStart+=t.length,this.selectionEnd=this.selectionStart,this.canvas&&this.canvas.renderAll().renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},insertNewlineStyleObject:function(e,i,n){this.shiftLineStyles(e,1),this.styles[e+1]||(this.styles[e+1]={});var r=this.styles[e][i-1],o={};if(n)o[0]=t(r),this.styles[e+1]=o;else{for(var a in this.styles[e])parseInt(a,10)>=i&&(o[parseInt(a,10)-i]=this.styles[e][a],delete this.styles[e][a]);this.styles[e+1]=o}},insertCharStyleObject:function(e,i,n){var r=this.styles[e],o=t(r);0!==i||n||(i=1);for(var a in o){var s=parseInt(a,10);s>=i&&(r[s+1]=o[s])}this.styles[e][i]=n||t(r[i-1])},insertStyleObjects:function(t,e,i){if(!this.isEmptyStyles()){var n=this.get2DCursorLocation(),r=n.lineIndex,o=n.charIndex;this.styles[r]||(this.styles[r]={}),"\n"===t?this.insertNewlineStyleObject(r,o,e):i?this._insertStyles(i):this.insertCharStyleObject(r,o)}},_insertStyles:function(t){for(var e=0,i=t.length;i>e;e++){var n=this.get2DCursorLocation(this.selectionStart+e),r=n.lineIndex,o=n.charIndex;this.insertCharStyleObject(r,o,t[e])}},shiftLineStyles:function(e,i){var n=t(this.styles);for(var r in this.styles){var o=parseInt(r,10);o>e&&(this.styles[o+i]=n[o])}},removeStyleObject:function(e,i){var n=this.get2DCursorLocation(i),r=n.lineIndex,o=n.charIndex;if(e){var a=this.text.split(this._reNewline),s=a[r-1],l=s?s.length:0;this.styles[r-1]||(this.styles[r-1]={});for(o in this.styles[r])this.styles[r-1][parseInt(o,10)+l]=this.styles[r][o];this.shiftLineStyles(r,-1)}else{var c=this.styles[r];if(c){var h=this.selectionStart===this.selectionEnd?-1:0;delete c[o+h]}var u=t(c);for(var f in u){var d=parseInt(f,10);d>=o&&0!==d&&(c[d-1]=u[d],delete c[d])}}},insertNewline:function(){this.insertChars("\n")}})}(),fabric.util.object.extend(fabric.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(t){this.__newClickTime=+new Date;var e=this.canvas.getPointer(t.e);this.isTripleClick(e)?(this.fire("tripleclick",t),this._stopEvent(t.e)):this.isDoubleClick(e)&&(this.fire("dblclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected},isDoubleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y&&this.__lastIsEditing},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initSelectedHandler(),this.initMousedownHandler(),this.initMousemoveHandler(),this.initMouseupHandler(),this.initClicks()},initClicks:function(){this.on("dblclick",function(t){this.selectWord(this.getSelectionStartFromPointer(t.e))}),this.on("tripleclick",function(t){this.selectLine(this.getSelectionStartFromPointer(t.e))})},initMousedownHandler:function(){this.on("mousedown",function(t){var e=this.canvas.getPointer(t.e);this.__mousedownX=e.x,this.__mousedownY=e.y,this.__isMousedown=!0,this.hiddenTextarea&&this.canvas&&this.canvas.wrapperEl.appendChild(this.hiddenTextarea),this.selected&&this.setCursorByClick(t.e),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.initDelayedCursor(!0))})},initMousemoveHandler:function(){this.on("mousemove",function(t){if(this.__isMousedown&&this.isEditing){var e=this.getSelectionStartFromPointer(t.e);e>=this.__selectionStartOnMouseDown?(this.setSelectionStart(this.__selectionStartOnMouseDown),this.setSelectionEnd(e)):(this.setSelectionStart(e),this.setSelectionEnd(this.__selectionStartOnMouseDown))}})},_isObjectMoved:function(t){var e=this.canvas.getPointer(t);return this.__mousedownX!==e.x||this.__mousedownY!==e.y},initMouseupHandler:function(){this.on("mouseup",function(t){this.__isMousedown=!1,this._isObjectMoved(t.e)||(this.__lastSelected&&(this.enterEditing(),this.initDelayedCursor(!0)),this.selected=!0)})},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t);t.shiftKey?e<this.selectionStart?(this.setSelectionEnd(this.selectionStart),this.setSelectionStart(e)):this.setSelectionEnd(e):(this.setSelectionStart(e),this.setSelectionEnd(e))},_getLocalRotatedPointer:function(t){var e=this.canvas.getPointer(t),i=new fabric.Point(e.x,e.y),n=new fabric.Point(this.left,this.top),r=fabric.util.rotatePoint(i,n,fabric.util.degreesToRadians(-this.angle));return this.getLocalPointer(t,r)},getSelectionStartFromPointer:function(t){for(var e,i=this._getLocalRotatedPointer(t),n=this.text.split(this._reNewline),r=0,o=0,a=0,s=0,l=0,c=n.length;c>l;l++){a+=this._getHeightOfLine(this.ctx,l)*this.scaleY;var h=this._getWidthOfLine(this.ctx,l,n),u=this._getLineLeftOffset(h);o=u*this.scaleX,this.flipX&&(n[l]=n[l].split("").reverse().join(""));for(var f=0,d=n[l].length;d>f;f++){var p=n[l][f];if(r=o,o+=this._getWidthOfChar(this.ctx,p,l,this.flipX?d-f:f)*this.scaleX,!(a<=i.y||o<=i.x))return this._getNewSelectionStartFromOffset(i,r,o,s+l,d);s++}if(i.y<a)return this._getNewSelectionStartFromOffset(i,r,o,s+l,d)}return"undefined"==typeof e?this.text.length:void 0},_getNewSelectionStartFromOffset:function(t,e,i,n,r){var o=t.x-e,a=i-t.x,s=a>o?0:1,l=n+s;return this.flipX&&(l=r-l),l>this.text.length&&(l=this.text.length),l}}),fabric.util.object.extend(fabric.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=fabric.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.style.cssText="position: absolute; top: 0; left: -9999px",fabric.document.body.appendChild(this.hiddenTextarea),fabric.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),fabric.util.addListener(this.hiddenTextarea,"keypress",this.onKeyPress.bind(this)),fabric.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),fabric.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(fabric.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},_keysMap:{8:"removeChars",13:"insertNewline",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown",46:"forwardDelete"},_ctrlKeysMap:{65:"selectAll",88:"cut"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){if(t.keyCode in this._keysMap&&0===t.charCode)this[this._keysMap[t.keyCode]](t);else{if(!(t.keyCode in this._ctrlKeysMap&&(t.ctrlKey||t.metaKey)))return;this[this._ctrlKeysMap[t.keyCode]](t)}t.stopPropagation(),this.canvas&&this.canvas.renderAll()}},forwardDelete:function(t){this.selectionStart===this.selectionEnd&&this.moveCursorRight(t),this.removeChars(t)},copy:function(t){var e=this.getSelectedText(),i=this._getClipboardData(t);i&&i.setData("text",e),this.copiedText=e,this.copiedStyles=this.getSelectionStyles(this.selectionStart,this.selectionEnd)},paste:function(t){var e=null,i=this._getClipboardData(t);e=i?i.getData("text"):this.copiedText,e&&this.insertChars(e)},cut:function(t){this.selectionStart!==this.selectionEnd&&(this.copy(),this.removeChars(t))},_getClipboardData:function(t){return t&&(t.clipboardData||fabric.window.clipboardData)},onKeyPress:function(t){!this.isEditing||t.metaKey||t.ctrlKey||t.keyCode in this._keysMap&&0===t.charCode||(this.insertChars(String.fromCharCode(t.which)),t.stopPropagation())},getDownCursorOffset:function(t,e){var i,n,r=e?this.selectionEnd:this.selectionStart,o=this.text.split(this._reNewline),a=this.text.slice(0,r),s=this.text.slice(r),l=a.slice(a.lastIndexOf("\n")+1),c=s.match(/(.*)\n?/)[1],h=(s.match(/.*\n(.*)\n?/)||{})[1]||"",u=this.get2DCursorLocation(r);if(u.lineIndex===o.length-1||t.metaKey)return this.text.length-r;var f=this._getWidthOfLine(this.ctx,u.lineIndex,o);n=this._getLineLeftOffset(f);for(var d=n,p=u.lineIndex,g=0,v=l.length;v>g;g++)i=l[g],d+=this._getWidthOfChar(this.ctx,i,p,g);var m=this._getIndexOnNextLine(u,h,d,o);return c.length+1+m},_getIndexOnNextLine:function(t,e,i,n){for(var r,o=t.lineIndex+1,a=this._getWidthOfLine(this.ctx,o,n),s=this._getLineLeftOffset(a),l=s,c=0,h=0,u=e.length;u>h;h++){var f=e[h],d=this._getWidthOfChar(this.ctx,f,o,h);if(l+=d,l>i){r=!0;var p=l-d,g=l,v=Math.abs(p-i),m=Math.abs(g-i);c=v>m?h+1:h;break}}return r||(c=e.length),c},moveCursorDown:function(t){this.abortCursorAnimation(),this._currentCursorOpacity=1;var e=this.getDownCursorOffset(t,"right"===this._selectionDirection);t.shiftKey?this.moveCursorDownWithShift(e):this.moveCursorDownWithoutShift(e),this.initDelayedCursor()},moveCursorDownWithoutShift:function(t){this._selectionDirection="right",this.selectionStart+=t,this.selectionStart>this.text.length&&(this.selectionStart=this.text.length),this.selectionEnd=this.selectionStart},moveCursorDownWithShift:function(t){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?(this.selectionStart+=t,void(this._selectionDirection="left")):(this._selectionDirection="right",this.selectionEnd+=t,this.selectionEnd>this.text.length&&(this.selectionEnd=this.text.length),void 0)},getUpCursorOffset:function(t,e){var i=e?this.selectionEnd:this.selectionStart,n=this.get2DCursorLocation(i);if(0===n.lineIndex||t.metaKey)return i;for(var r,o=this.text.slice(0,i),a=o.slice(o.lastIndexOf("\n")+1),s=(o.match(/\n?(.*)\n.*$/)||{})[1]||"",l=this.text.split(this._reNewline),c=this._getWidthOfLine(this.ctx,n.lineIndex,l),h=this._getLineLeftOffset(c),u=h,f=n.lineIndex,d=0,p=a.length;p>d;d++)r=a[d],u+=this._getWidthOfChar(this.ctx,r,f,d);var g=this._getIndexOnPrevLine(n,s,u,l);return s.length-g+a.length},_getIndexOnPrevLine:function(t,e,i,n){for(var r,o=t.lineIndex-1,a=this._getWidthOfLine(this.ctx,o,n),s=this._getLineLeftOffset(a),l=s,c=0,h=0,u=e.length;u>h;h++){var f=e[h],d=this._getWidthOfChar(this.ctx,f,o,h);if(l+=d,l>i){r=!0;var p=l-d,g=l,v=Math.abs(p-i),m=Math.abs(g-i);c=v>m?h:h-1;break}}return r||(c=e.length-1),c},moveCursorUp:function(t){this.abortCursorAnimation(),this._currentCursorOpacity=1;var e=this.getUpCursorOffset(t,"right"===this._selectionDirection);t.shiftKey?this.moveCursorUpWithShift(e):this.moveCursorUpWithoutShift(e),this.initDelayedCursor()},moveCursorUpWithShift:function(t){if(this.selectionStart===this.selectionEnd)this.selectionStart-=t;else{if("right"===this._selectionDirection)return this.selectionEnd-=t,void(this._selectionDirection="right");this.selectionStart-=t}this.selectionStart<0&&(this.selectionStart=0),this._selectionDirection="left"},moveCursorUpWithoutShift:function(t){this.selectionStart===this.selectionEnd&&(this.selectionStart-=t),this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd=this.selectionStart,this._selectionDirection="left"},moveCursorLeft:function(t){(0!==this.selectionStart||0!==this.selectionEnd)&&(this.abortCursorAnimation(),this._currentCursorOpacity=1,t.shiftKey?this.moveCursorLeftWithShift(t):this.moveCursorLeftWithoutShift(t),this.initDelayedCursor())},_move:function(t,e,i){t.altKey?this[e]=this["findWordBoundary"+i](this[e]):t.metaKey?this[e]=this["findLineBoundary"+i](this[e]):this[e]+="Left"===i?-1:1},_moveLeft:function(t,e){this._move(t,e,"Left")},_moveRight:function(t,e){this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this._moveLeft(t,"selectionStart"),this.selectionEnd=this.selectionStart},moveCursorLeftWithShift:function(t){"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):(this._selectionDirection="left",this._moveLeft(t,"selectionStart"),"\n"===this.text.charAt(this.selectionStart)&&this.selectionStart--,this.selectionStart<0&&(this.selectionStart=0))},moveCursorRight:function(t){this.selectionStart>=this.text.length&&this.selectionEnd>=this.text.length||(this.abortCursorAnimation(),this._currentCursorOpacity=1,t.shiftKey?this.moveCursorRightWithShift(t):this.moveCursorRightWithoutShift(t),this.initDelayedCursor())},moveCursorRightWithShift:function(t){"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):(this._selectionDirection="right",this._moveRight(t,"selectionEnd"),"\n"===this.text.charAt(this.selectionEnd-1)&&this.selectionEnd++,this.selectionEnd>this.text.length&&(this.selectionEnd=this.text.length))},moveCursorRightWithoutShift:function(t){this._selectionDirection="right",this.selectionStart===this.selectionEnd?(this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):(this.selectionEnd+=this.getNumNewLinesInSelectedText(),this.selectionEnd>this.text.length&&(this.selectionEnd=this.text.length),this.selectionStart=this.selectionEnd)},removeChars:function(t){this.selectionStart===this.selectionEnd?this._removeCharsNearCursor(t):this._removeCharsFromTo(this.selectionStart,this.selectionEnd),this.selectionEnd=this.selectionStart,this._removeExtraneousStyles(),this.canvas&&this.canvas.renderAll().renderAll(),this.setCoords(),this.fire("changed"),this.canvas&&this.canvas.fire("text:changed",{target:this})},_removeCharsNearCursor:function(t){if(0!==this.selectionStart)if(t.metaKey){var e=this.findLineBoundaryLeft(this.selectionStart);this._removeCharsFromTo(e,this.selectionStart),this.selectionStart=e}else if(t.altKey){var i=this.findWordBoundaryLeft(this.selectionStart);this._removeCharsFromTo(i,this.selectionStart),this.selectionStart=i}else{var n="\n"===this.text.slice(this.selectionStart-1,this.selectionStart);this.removeStyleObject(n),this.selectionStart--,this.text=this.text.slice(0,this.selectionStart)+this.text.slice(this.selectionStart+1)}}}),fabric.util.object.extend(fabric.IText.prototype,{_setSVGTextLineText:function(t,e,i,n,r,o){this.styles[e]?this._setSVGTextLineChars(t,e,i,n,r,o):this.callSuper("_setSVGTextLineText",t,e,i,n,r)},_setSVGTextLineChars:function(t,e,i,n,r,o){for(var a=0===e||this.useNative?"y":"dy",s=t.split(""),l=0,c=this._getSVGLineLeftOffset(e),h=this._getSVGLineTopOffset(e),u=this._getHeightOfLine(this.ctx,e),f=0,d=s.length;d>f;f++){var p=this.styles[e][f]||{};i.push(this._createTextCharSpan(s[f],p,c,h,a,l));var g=this._getWidthOfChar(this.ctx,s[f],e,f);p.textBackgroundColor&&o.push(this._createTextCharBg(p,c,h,u,g,l)),l+=g}},_getSVGLineLeftOffset:function(t){return this._boundaries&&this._boundaries[t]?fabric.util.toFixed(this._boundaries[t].left,2):0},_getSVGLineTopOffset:function(t){for(var e=0,i=0;t>=i;i++)e+=this._getHeightOfLine(this.ctx,i);return e-this.height/2},_createTextCharBg:function(t,e,i,n,r,o){return['<rect fill="',t.textBackgroundColor,'" transform="translate(',-this.width/2," ",-this.height+n,")",'" x="',e+o,'" y="',i+n,'" width="',r,'" height="',n,'"></rect>'].join("")},_createTextCharSpan:function(t,e,i,n,r,o){var a=this.getSvgStyles.call(fabric.util.object.extend({visible:!0,fill:this.fill,stroke:this.stroke,type:"text"},e));return['<tspan x="',i+o,'" ',r,'="',n,'" ',e.fontFamily?'font-family="'+e.fontFamily.replace(/"/g,"'")+'" ':"",e.fontSize?'font-size="'+e.fontSize+'" ':"",e.fontStyle?'font-style="'+e.fontStyle+'" ':"",e.fontWeight?'font-weight="'+e.fontWeight+'" ':"",e.textDecoration?'text-decoration="'+e.textDecoration+'" ':"",'style="',a,'">',fabric.util.string.escapeXml(t),"</tspan>"].join("")}}),function(){function request(t,e,i){var n=URL.parse(t);n.port||(n.port=0===n.protocol.indexOf("https:")?443:80);var r=443===n.port?HTTPS:HTTP,o=r.request({hostname:n.hostname,port:n.port,path:n.path,method:"GET"},function(t){var n="";e&&t.setEncoding(e),t.on("end",function(){i(n)}),t.on("data",function(e){200===t.statusCode&&(n+=e)})});o.on("error",function(t){fabric.log(t.errno===process.ECONNREFUSED?"ECONNREFUSED: connection refused to "+n.hostname+":"+n.port:t.message)}),o.end()}function requestFs(t,e){var i=require("fs");i.readFile(t,function(t,i){if(t)throw fabric.log(t),t;e(i)})}if("undefined"==typeof document||"undefined"==typeof window){var DOMParser=require("xmldom").DOMParser,URL=require("url"),HTTP=require("http"),HTTPS=require("https"),Canvas=require("canvas"),Image=require("canvas").Image;fabric.util.loadImage=function(t,e,i){function n(n){r.src=new Buffer(n,"binary"),r._src=t,e&&e.call(i,r)}var r=new Image;t&&(t instanceof Buffer||0===t.indexOf("data"))?(r.src=r._src=t,e&&e.call(i,r)):t&&0!==t.indexOf("http")?requestFs(t,n):t?request(t,"binary",n):e&&e.call(i,t)},fabric.loadSVGFromURL=function(t,e,i){t=t.replace(/^\n\s*/,"").replace(/\?.*$/,"").trim(),0!==t.indexOf("http")?requestFs(t,function(t){fabric.loadSVGFromString(t.toString(),e,i)}):request(t,"",function(t){fabric.loadSVGFromString(t,e,i)})},fabric.loadSVGFromString=function(t,e,i){var n=(new DOMParser).parseFromString(t);fabric.parseSVGDocument(n.documentElement,function(t,i){e&&e(t,i)},i)},fabric.util.getScript=function(url,callback){request(url,"",function(body){eval(body),callback&&callback()})},fabric.Image.fromObject=function(t,e){fabric.util.loadImage(t.src,function(i){var n=new fabric.Image(i);n._initConfig(t),n._initFilters(t,function(t){n.filters=t||[],e&&e(n)})})},fabric.createCanvasForNode=function(t,e,i,n){n=n||i;var r=fabric.document.createElement("canvas"),o=new Canvas(t||600,e||600,n);r.style={},r.width=o.width,r.height=o.height;var a=fabric.Canvas||fabric.StaticCanvas,s=new a(r,i);return s.contextContainer=o.getContext("2d"),s.nodeCanvas=o,s.Font=Canvas.Font,s},fabric.StaticCanvas.prototype.createPNGStream=function(){return this.nodeCanvas.createPNGStream()},fabric.StaticCanvas.prototype.createJPEGStream=function(t){return this.nodeCanvas.createJPEGStream(t)};var origSetWidth=fabric.StaticCanvas.prototype.setWidth;fabric.StaticCanvas.prototype.setWidth=function(t,e){return origSetWidth.call(this,t,e),this.nodeCanvas.width=t,this},fabric.Canvas&&(fabric.Canvas.prototype.setWidth=fabric.StaticCanvas.prototype.setWidth);var origSetHeight=fabric.StaticCanvas.prototype.setHeight;fabric.StaticCanvas.prototype.setHeight=function(t,e){return origSetHeight.call(this,t,e),this.nodeCanvas.height=t,this},fabric.Canvas&&(fabric.Canvas.prototype.setHeight=fabric.StaticCanvas.prototype.setHeight)}}(),function(){var t=function(){try{var t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(t)return!0}catch(e){if(void 0!=navigator.mimeTypes["application/x-shockwave-flash"])return!0}return!1},e=function(t,e){window.XMLHttpRequest.prototype[t]=e(window.XMLHttpRequest.prototype[t])};if(window.XMLHttpRequest){if(!window.FormData||window.FileAPI&&FileAPI.forceLoad){var i=function(t){if(!t.__listeners){t.upload||(t.upload={}),t.__listeners=[];var e=t.upload.addEventListener;t.upload.addEventListener=function(i,n){t.__listeners[i]=n,e&&e.apply(this,arguments)}}};e("open",function(t){return function(e,n,r){i(this),this.__url=n;try{t.apply(this,[e,n,r])}catch(o){o.message.indexOf("Access is denied")>-1&&t.apply(this,[e,"_fix_for_ie_crossdomain__",r])}}}),e("getResponseHeader",function(t){return function(e){return this.__fileApiXHR&&this.__fileApiXHR.getResponseHeader?this.__fileApiXHR.getResponseHeader(e):null==t?null:t.apply(this,[e])}}),e("getAllResponseHeaders",function(t){return function(){return this.__fileApiXHR&&this.__fileApiXHR.getAllResponseHeaders?this.__fileApiXHR.getAllResponseHeaders():null==t?null:t.apply(this)}}),e("abort",function(t){return function(){return this.__fileApiXHR&&this.__fileApiXHR.abort?this.__fileApiXHR.abort():null==t?null:t.apply(this)}}),e("setRequestHeader",function(t){return function(e,n){if("__setXHR_"===e){i(this);var r=n(this);r instanceof Function&&r(this)}else this.__requestHeaders=this.__requestHeaders||{},this.__requestHeaders[e]=n,t.apply(this,arguments)}}),e("send",function(e){return function(){var i=this;if(arguments[0]&&arguments[0].__isShim){var n=arguments[0],r={url:i.__url,jsonp:!1,cache:!0,complete:function(t,e){i.__completed=!0,!t&&i.__listeners.load&&i.__listeners.load({type:"load",loaded:i.__loaded,total:i.__total,target:i,lengthComputable:!0}),!t&&i.__listeners.loadend&&i.__listeners.loadend({type:"loadend",loaded:i.__loaded,total:i.__total,target:i,lengthComputable:!0}),"abort"===t&&i.__listeners.abort&&i.__listeners.abort({type:"abort",loaded:i.__loaded,total:i.__total,target:i,lengthComputable:!0}),void 0!==e.status&&Object.defineProperty(i,"status",{get:function(){return 0==e.status&&t&&"abort"!==t?500:e.status}}),void 0!==e.statusText&&Object.defineProperty(i,"statusText",{get:function(){return e.statusText}}),Object.defineProperty(i,"readyState",{get:function(){return 4}}),void 0!==e.response&&Object.defineProperty(i,"response",{get:function(){return e.response}});var n=e.responseText||(t&&0==e.status&&"abort"!==t?t:void 0);Object.defineProperty(i,"responseText",{get:function(){return n}}),Object.defineProperty(i,"response",{get:function(){return n}}),t&&Object.defineProperty(i,"err",{get:function(){return t}}),i.__fileApiXHR=e,i.onreadystatechange&&i.onreadystatechange()},fileprogress:function(t){if(t.target=i,i.__listeners.progress&&i.__listeners.progress(t),i.__total=t.total,i.__loaded=t.loaded,t.total===t.loaded){var e=this;setTimeout(function(){i.__completed||(i.getAllResponseHeaders=function(){},e.complete(null,{status:204,statusText:"No Content"}))},1e4)}},headers:i.__requestHeaders};r.data={},r.files={};for(var o=0;o<n.data.length;o++){var a=n.data[o];null!=a.val&&null!=a.val.name&&null!=a.val.size&&null!=a.val.type?r.files[a.key]=a.val:r.data[a.key]=a.val}setTimeout(function(){if(!t())throw'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';i.__fileApiXHR=FileAPI.upload(r)},1)}else e.apply(i,arguments)}})}else e("setRequestHeader",function(t){return function(e,i){if("__setXHR_"===e){var n=i(this);n instanceof Function&&n(this)}else t.apply(this,arguments)}});window.XMLHttpRequest.__isShim=!0}if(!window.FormData||window.FileAPI&&FileAPI.forceLoad){var n=function(e){if(!t())throw'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';var i=angular.element(e);if(!(i.attr("disabled")||i.hasClass("js-fileapi-wrapper")||null==e.getAttribute("ng-file-select")&&null==e.getAttribute("data-ng-file-select")))if(FileAPI.wrapInsideDiv){var n=document.createElement("div");n.innerHTML='<div class="js-fileapi-wrapper" style="position:relative; overflow:hidden"></div>',n=n.firstChild;var r=e.parentNode;r.insertBefore(n,e),r.removeChild(e),n.appendChild(e)}else i.addClass("js-fileapi-wrapper"),i.parent()[0].__file_click_fn_delegate_&&((""===i.parent().css("position")||"static"===i.parent().css("position"))&&i.parent().css("position","relative"),i.css("top",0).css("bottom",0).css("left",0).css("right",0).css("width","100%").css("height","100%").css("padding",0).css("margin",0),i.parent().unbind("click",i.parent()[0].__file_click_fn_delegate_))},r=function(t){return function(e){for(var i=FileAPI.getFiles(e),n=0;n<i.length;n++)void 0===i[n].size&&(i[n].size=0),void 0===i[n].name&&(i[n].name="file"),void 0===i[n].type&&(i[n].type="undefined");e.target||(e.target={}),e.target.files=i,e.target.files!=i&&(e.__files_=i),(e.__files_||e.target.files).item=function(t){return(e.__files_||e.target.files)[t]||null},t&&t.apply(this,[e])}},o=function(t,e){return("change"===e.toLowerCase()||"onchange"===e.toLowerCase())&&"file"==t.getAttribute("type")};HTMLInputElement.prototype.addEventListener&&(HTMLInputElement.prototype.addEventListener=function(t){return function(e,i,a,s){o(this,e)?(n(this),t.apply(this,[e,r(i),a,s])):t.apply(this,[e,i,a,s])}}(HTMLInputElement.prototype.addEventListener)),HTMLInputElement.prototype.attachEvent&&(HTMLInputElement.prototype.attachEvent=function(t){return function(e,i){o(this,e)?(n(this),window.jQuery?angular.element(this).bind("change",r(null)):t.apply(this,[e,r(i)])):t.apply(this,[e,i])}}(HTMLInputElement.prototype.attachEvent)),window.FormData=FormData=function(){return{append:function(t,e,i){this.data.push({key:t,val:e,name:i})},data:[],__isShim:!0}},function(){if(window.FileAPI||(window.FileAPI={}),FileAPI.forceLoad&&(FileAPI.html5=!1),!FileAPI.upload){var e,i,n,r,o,a=document.createElement("script"),s=document.getElementsByTagName("script");if(window.FileAPI.jsUrl)e=window.FileAPI.jsUrl;else if(window.FileAPI.jsPath)i=window.FileAPI.jsPath;else for(n=0;n<s.length;n++)if(o=s[n].src,r=o.indexOf("angular-file-upload-shim.js"),-1==r&&(r=o.indexOf("angular-file-upload-shim.min.js")),r>-1){i=o.substring(0,r);break}null==FileAPI.staticPath&&(FileAPI.staticPath=i),a.setAttribute("src",e||i+"FileAPI.min.js"),document.getElementsByTagName("head")[0].appendChild(a),FileAPI.hasFlash=t()}}(),FileAPI.disableFileInput=function(t,e){e?t.removeClass("js-fileapi-wrapper"):t.addClass("js-fileapi-wrapper")
}}window.FileReader||(window.FileReader=function(){var t=this,e=!1;this.listeners={},this.addEventListener=function(e,i){t.listeners[e]=t.listeners[e]||[],t.listeners[e].push(i)},this.removeEventListener=function(e,i){t.listeners[e]&&t.listeners[e].splice(t.listeners[e].indexOf(i),1)},this.dispatchEvent=function(e){var i=t.listeners[e.type];if(i)for(var n=0;n<i.length;n++)i[n].call(t,e)},this.onabort=this.onerror=this.onload=this.onloadstart=this.onloadend=this.onprogress=null;var i=function(e,i){var n={type:e,target:t,loaded:i.loaded,total:i.total,error:i.error};return null!=i.result&&(n.target.result=i.result),n},n=function(n){if(e||(e=!0,t.onloadstart&&this.onloadstart(i("loadstart",n))),"load"===n.type){t.onloadend&&t.onloadend(i("loadend",n));var r=i("load",n);t.onload&&t.onload(r),t.dispatchEvent(r)}else if("progress"===n.type){var r=i("progress",n);t.onprogress&&t.onprogress(r),t.dispatchEvent(r)}else{var r=i("error",n);t.onerror&&t.onerror(r),t.dispatchEvent(r)}};this.readAsArrayBuffer=function(t){FileAPI.readAsBinaryString(t,n)},this.readAsBinaryString=function(t){FileAPI.readAsBinaryString(t,n)},this.readAsDataURL=function(t){FileAPI.readAsDataURL(t,n)},this.readAsText=function(t){FileAPI.readAsText(t,n)}})}(),function(t,e){"use strict";function i(t){return/^-?\d+\.?\d*$/.test(t.replace(/["']/g,""))}var n=e.isDefined,r=e.isUndefined,o=e.isNumber,a=e.isObject,s=e.isArray,l=e.extend,c=e.toJson,h=e.fromJson,u=e.module("LocalStorageModule",[]);u.provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(t){this.prefix=t},this.setStorageType=function(t){this.storageType=t},this.setStorageCookie=function(t,e){this.cookie={expiry:t,path:e}},this.setStorageCookieDomain=function(t){this.cookie.domain=t},this.setNotify=function(t,e){this.notify={setItem:t,removeItem:e}},this.$get=["$rootScope","$window","$document","$parse",function(t,e,u,f){var d,p=this,g=p.prefix,v=p.cookie,m=p.notify,b=p.storageType;u?u[0]&&(u=u[0]):u=document,"."!==g.substr(-1)&&(g=g?g+".":"");var y=function(t){return g+t},x=function(){try{var i=b in e&&null!==e[b],n=y("__"+Math.round(1e7*Math.random()));return i&&(d=e[b],d.setItem(n,""),d.removeItem(n)),i}catch(r){return b="cookie",t.$broadcast("LocalStorageModule.notification.error",r.message),!1}}(),w=function(e,i){if(r(i)?i=null:(a(i)||s(i)||o(+i||i))&&(i=c(i)),!x||"cookie"===p.storageType)return x||t.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),m.setItem&&t.$broadcast("LocalStorageModule.notification.setitem",{key:e,newvalue:i,storageType:"cookie"}),T(e,i);try{(a(i)||s(i))&&(i=c(i)),d&&d.setItem(y(e),i),m.setItem&&t.$broadcast("LocalStorageModule.notification.setitem",{key:e,newvalue:i,storageType:p.storageType})}catch(n){return t.$broadcast("LocalStorageModule.notification.error",n.message),T(e,i)}return!0},_=function(e){if(!x||"cookie"===p.storageType)return x||t.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),O(e);var n=d?d.getItem(y(e)):null;return n&&"null"!==n?"{"===n.charAt(0)||"["===n.charAt(0)||i(n)?h(n):n:null},C=function(e){if(!x||"cookie"===p.storageType)return x||t.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),m.removeItem&&t.$broadcast("LocalStorageModule.notification.removeitem",{key:e,storageType:"cookie"}),$(e);try{d.removeItem(y(e)),m.removeItem&&t.$broadcast("LocalStorageModule.notification.removeitem",{key:e,storageType:p.storageType})}catch(i){return t.$broadcast("LocalStorageModule.notification.error",i.message),$(e)}return!0},S=function(){if(!x)return t.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var e=g.length,i=[];for(var n in d)if(n.substr(0,e)===g)try{i.push(n.substr(e))}catch(r){return t.$broadcast("LocalStorageModule.notification.error",r.Description),[]}return i},A=function(e){e=e||"";var i=g.slice(0,-1),n=new RegExp(i+"."+e);if(!x||"cookie"===p.storageType)return x||t.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),D();var r=g.length;for(var o in d)if(n.test(o))try{C(o.substr(r))}catch(a){return t.$broadcast("LocalStorageModule.notification.error",a.message),D()}return!0},k=function(){try{return navigator.cookieEnabled||"cookie"in u&&(u.cookie.length>0||(u.cookie="test").indexOf.call(u.cookie,"test")>-1)}catch(e){return t.$broadcast("LocalStorageModule.notification.error",e.message),!1}},T=function(e,i){if(r(i))return!1;if((s(i)||a(i))&&(i=c(i)),!k())return t.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var n="",o=new Date,l="";if(null===i?(o.setTime(o.getTime()+-864e5),n="; expires="+o.toGMTString(),i=""):0!==v.expiry&&(o.setTime(o.getTime()+24*v.expiry*60*60*1e3),n="; expires="+o.toGMTString()),e){var h="; path="+v.path;v.domain&&(l="; domain="+v.domain),u.cookie=y(e)+"="+encodeURIComponent(i)+n+h+l}}catch(f){return t.$broadcast("LocalStorageModule.notification.error",f.message),!1}return!0},O=function(e){if(!k())return t.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var i=u.cookie&&u.cookie.split(";")||[],n=0;n<i.length;n++){for(var r=i[n];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(y(e)+"=")){var o=decodeURIComponent(r.substring(g.length+e.length+1,r.length));try{var a=JSON.parse(o);return h(a)}catch(s){return o}}}return null},$=function(t){T(t,null)},D=function(){for(var t=null,e=g.length,i=u.cookie.split(";"),n=0;n<i.length;n++){for(t=i[n];" "===t.charAt(0);)t=t.substring(1,t.length);var r=t.substring(e,t.indexOf("="));$(r)}},M=function(){return b},E=function(t,e,i,r){r=r||e;var o=_(r);return null===o&&n(i)?o=i:a(o)&&a(i)&&(o=l(i,o)),f(e).assign(t,o),t.$watch(e,function(t){w(r,t)},a(t[e]))},P=function(){for(var t=0,i=e[b],n=0;n<i.length;n++)0===i.key(n).indexOf(g)&&t++;return t};return{isSupported:x,getStorageType:M,set:w,add:w,get:_,keys:S,remove:C,clearAll:A,bind:E,deriveKey:y,length:P,cookie:{set:T,add:T,get:O,remove:$,clearAll:D}}}]})}(window,window.angular),function(){var t=angular.module("angularFileUpload",[]);t.service("$upload",["$http","$q","$timeout",function(t,e,i){function n(n){n.method=n.method||"POST",n.headers=n.headers||{},n.transformRequest=n.transformRequest||function(e,i){return window.ArrayBuffer&&e instanceof window.ArrayBuffer?e:t.defaults.transformRequest[0](e,i)};var r=e.defer();window.XMLHttpRequest.__isShim&&(n.headers.__setXHR_=function(){return function(t){t&&(n.__XHR=t,n.xhrFn&&n.xhrFn(t),t.upload.addEventListener("progress",function(t){r.notify(t)},!1),t.upload.addEventListener("load",function(t){t.lengthComputable&&r.notify(t)},!1))}}),t(n).then(function(t){r.resolve(t)},function(t){r.reject(t)},function(t){r.notify(t)});var o=r.promise;return o.success=function(t){return o.then(function(e){t(e.data,e.status,e.headers,n)}),o},o.error=function(t){return o.then(null,function(e){t(e.data,e.status,e.headers,n)}),o},o.progress=function(t){return o.then(null,null,function(e){t(e)}),o},o.abort=function(){return n.__XHR&&i(function(){n.__XHR.abort()}),o},o.xhr=function(t){return n.xhrFn=function(e){return function(){e&&e.apply(o,arguments),t.apply(o,arguments)}}(n.xhrFn),o},o}this.upload=function(e){e.headers=e.headers||{},e.headers["Content-Type"]=void 0,e.transformRequest=e.transformRequest||t.defaults.transformRequest;var i=new FormData,r=e.transformRequest,o=e.data;return e.transformRequest=function(t,i){if(o)if(e.formDataAppender)for(var n in o){var a=o[n];e.formDataAppender(t,n,a)}else for(var n in o){var a=o[n];if("function"==typeof r)a=r(a,i);else for(var s=0;s<r.length;s++){var l=r[s];"function"==typeof l&&(a=l(a,i))}t.append(n,a)}if(null!=e.file){var c=e.fileFormDataName||"file";if("[object Array]"===Object.prototype.toString.call(e.file))for(var h="[object String]"===Object.prototype.toString.call(c),s=0;s<e.file.length;s++)t.append(h?c:c[s],e.file[s],e.fileName&&e.fileName[s]||e.file[s].name);else t.append(c,e.file,e.fileName||e.file.name)}return t},e.data=i,n(e)},this.http=function(t){return n(t)}}]),t.directive("ngFileSelect",["$parse","$timeout",function(t,e){return function(i,n,r){var o=t(r.ngFileSelect);if("input"!==n[0].tagName.toLowerCase()||"file"!==(n.attr("type")&&n.attr("type").toLowerCase())){for(var a=angular.element('<input type="file">'),s=n[0].attributes,l=0;l<s.length;l++)"type"!==s[l].name.toLowerCase()&&a.attr(s[l].name,s[l].value);r.multiple&&a.attr("multiple","true"),a.css("width","1px").css("height","1px").css("opacity",0).css("position","absolute").css("filter","alpha(opacity=0)").css("padding",0).css("margin",0).css("overflow","hidden"),a.attr("__wrapper_for_parent_",!0),n.append(a),n[0].__file_click_fn_delegate_=function(){a[0].click()},n.bind("click",n[0].__file_click_fn_delegate_),n.css("overflow","hidden"),n=a}n.bind("change",function(t){var n,r,a=[];if(n=t.__files_||t.target.files,null!=n)for(r=0;r<n.length;r++)a.push(n.item(r));e(function(){o(i,{$files:a,$event:t})})})}}]),t.directive("ngFileDropAvailable",["$parse","$timeout",function(t,e){return function(i,n,r){if("draggable"in document.createElement("span")){var o=t(r.ngFileDropAvailable);e(function(){o(i)})}}}]),t.directive("ngFileDrop",["$parse","$timeout","$location",function(t,e,i){return function(n,r,o){function a(t){return/^[\000-\177]*$/.test(t)}function s(t,n){var r=[],o=t.dataTransfer.items;if(o&&o.length>0&&o[0].webkitGetAsEntry&&"file"!=i.protocol()&&o[0].webkitGetAsEntry().isDirectory)for(var s=0;s<o.length;s++){var c=o[s].webkitGetAsEntry();null!=c&&(a(c.name)?l(r,c):o[s].webkitGetAsEntry().isDirectory||r.push(o[s].getAsFile()))}else{var h=t.dataTransfer.files;if(null!=h)for(var s=0;s<h.length;s++)r.push(h.item(s))}!function f(t){e(function(){u?f(10):n(r)},t||0)}()}function l(t,e,i){if(null!=e)if(e.isDirectory){var n=e.createReader();u++,n.readEntries(function(n){for(var r=0;r<n.length;r++)l(t,n[r],(i?i:"")+e.name+"/");u--})}else u++,e.file(function(e){u--,e._relativePath=(i?i:"")+e.name,t.push(e)})}if("draggable"in document.createElement("span")){var c=null;r[0].addEventListener("dragover",function(i){if(i.preventDefault(),e.cancel(c),!r[0].__drag_over_class_)if(o.ngFileDragOverClass&&o.ngFileDragOverClass.search(/\) *$/)>-1){var a=t(o.ngFileDragOverClass)(n,{$event:i});r[0].__drag_over_class_=a}else r[0].__drag_over_class_=o.ngFileDragOverClass||"dragover";r.addClass(r[0].__drag_over_class_)},!1),r[0].addEventListener("dragenter",function(t){t.preventDefault()},!1),r[0].addEventListener("dragleave",function(){c=e(function(){r.removeClass(r[0].__drag_over_class_),r[0].__drag_over_class_=null},o.ngFileDragOverDelay||1)},!1);var h=t(o.ngFileDrop);r[0].addEventListener("drop",function(t){t.preventDefault(),r.removeClass(r[0].__drag_over_class_),r[0].__drag_over_class_=null,s(t,function(e){h(n,{$files:e,$event:t})})},!1);var u=0}}}])}(),function(t){function e(){this.fontFamily="fjs"+(999999*Math.random()|0)}if(!Object.defineProperty)throw"Font.js requires Object.defineProperty, which this browser does not support.";if(!document.createElement("canvas").getContext)throw"Font.js requires <canvas> and the Canvas2D API, which this browser does not support.";!function(t){function e(t,e){return this.slice(t,e)}function i(t,e){var i,n=t.length;for(arguments.length<2&&(e=0),i=0;n>i;++i,++e)this[e]=255&t[i]}function n(t){var n,r;if("number"==typeof t)for(n=new Array(t),r=0;t>r;++r)n[r]=0;else n=t.slice(0);return n.subarray=e,n.buffer=n,n.byteLength=n.length,n.set=i,"object"==typeof t&&t.buffer&&(n.buffer=t.buffer),n}try{{new Uint8Array(1)}return}catch(r){}t.Uint8Array=n,t.Uint32Array=n,t.Int32Array=n}(t),function(t){if(!t.opera&&!("response"in XMLHttpRequest.prototype||"mozResponseArrayBuffer"in XMLHttpRequest.prototype||"mozResponse"in XMLHttpRequest.prototype||"responseArrayBuffer"in XMLHttpRequest.prototype)){var e;e=t.VBArray?function(){return new Uint8Array(new VBArray(this.responseBody).toArray())}:function(){this.responseBody},Object.defineProperty(XMLHttpRequest.prototype,"response",{get:e})}}(t),t.btoa||(t.btoa=function(t){var e,i,n,r,o,a,s,l,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=0,u=0,f="",d=[];if(!t)return t;do e=t.charCodeAt(h++),i=t.charCodeAt(h++),n=t.charCodeAt(h++),l=e<<16|i<<8|n,r=l>>18&63,o=l>>12&63,a=l>>6&63,s=63&l,d[u++]=c.charAt(r)+c.charAt(o)+c.charAt(a)+c.charAt(s);while(h<t.length);f=d.join("");var p=t.length%3;return(p?f.slice(0,p-3):f)+"===".slice(p||3)}),e.prototype.url="",e.prototype.format="",e.prototype.data="",e.prototype.base64="AAEAAAAKAIAAAwAgT1MvMgAAAAAAAACsAAAAWGNtYXAAAAAAAAABBAAAACxnbHlmAAAAAAAAATAAAAAQaGVhZAAAAAAAAAFAAAAAOGhoZWEAAAAAAAABeAAAACRobXR4AAAAAAAAAZwAAAAIbG9jYQAAAAAAAAGkAAAACG1heHAAAAAAAAABrAAAACBuYW1lAAAAAAAAAcwAAAAgcG9zdAAAAAAAAAHsAAAAEAAEAAEAZAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAABAAMAAQAAAAwABAAgAAAABAAEAAEAAABB//8AAABB////wAABAAAAAAABAAAAAAAAAAAAAAAAMQAAAQAAAAAAAAAAAABfDzz1AAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAEAAgAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAIAAAAAQAAAAIAAQABAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAIAHgADAAEECQABAAAAAAADAAEECQACAAIAAAAAAAEAAAAAAAAAAAAAAAAAAA==",e.prototype.metrics={quadsize:0,leading:0,ascent:0,descent:0,weightclass:400},e.prototype.systemfont=!1,e.prototype.loaded=!1,e.prototype.onload=function(){},e.prototype.onerror=function(){},e.prototype.canvas=!1,e.prototype.context=!1,e.prototype.validate=function(t,e,i,n,r){if(r!==!1&&0>r)return void this.onerror("Requested system font '"+this.fontFamily+"' could not be loaded (it may not be installed).");var o=getComputedStyle(t,null).getPropertyValue("width").replace("px","");o>0?(document.head.removeChild(e),document.body.removeChild(t),this.loaded=!0,this.onload()):(console.log("timing out"),setTimeout(function(){n.validate(t,e,i,n,r===!1?!1:r-50)},1e3))},e.prototype.ondownloaded=function(){var t=this,e=function(t){return String.fromCharCode(t)},i=function(t){if(256>t)return e(0)+e(t);var i=t>>8,n=255&t;return e(i)+e(n)},n=function(t,e){return 256*t+e},r=function(t,e){var i,n=t>>7===1;return t=127&t,i=256*t+e,n?i-32768:i},o=function(t,e,i,n){return 16777216*t+65536*e+256*i+n},a=function(e){t.onerror(e)},s=e(0)+e(1)+e(0)+e(0),l="OTTO",c=this.data,h=e(c[0])+e(c[1])+e(c[2])+e(c[3]),u=h===s,f=u?!1:h===l;if(u)this.format="truetype";else{if(!f)return void a("Error: file at "+this.url+" cannot be interpreted as OpenType font.");this.format="opentype"}var d,p,g=n(c[4],c[5]),v=12,m=v+16*g,b={};for(d=v;m>d;d+=16)p=e(c[d])+e(c[d+1])+e(c[d+2])+e(c[d+3]),b[p]={name:p,checksum:o(c[d+4],c[d+5],c[d+6],c[d+7]),offset:o(c[d+8],c[d+9],c[d+10],c[d+11]),length:o(c[d+12],c[d+13],c[d+14],c[d+15])};var y=function(t){return b[t]?t:(a("Error: font is missing the required OpenType '"+t+"' table."),!1)};if(p=y("head"),p!==!1){d=b[p].offset,b[p].version=""+c[d]+c[d+1]+c[d+2]+c[d+3];var x=n(c[d+18],c[d+19]);if(this.metrics.quadsize=x,p=y("hhea"),p!==!1&&(d=b[p].offset,b[p].version=""+c[d]+c[d+1]+c[d+2]+c[d+3],this.metrics.ascent=r(c[d+4],c[d+5])/x,this.metrics.descent=r(c[d+6],c[d+7])/x,this.metrics.leading=r(c[d+8],c[d+9])/x,p=y("OS/2"),p!==!1&&(d=b[p].offset,b[p].version=""+c[d]+c[d+1],this.metrics.weightclass=n(c[d+4],c[d+5]),p=y("cmap"),p!==!1))){d=b[p].offset,b[p].version=""+c[d]+c[d+1],g=n(c[d+2],c[d+3]);for(var w,_,C,S,A,k=!1,w=0;g>w;w++)_=d+4+8*w,C=n(c[_],c[_+1]),S=n(c[_+2],c[_+3]),A=o(c[_+4],c[_+5],c[_+6],c[_+7]),3===C&&1===S&&(k=A);var T="A";if(k!==!1&&(d+=k,h=n(c[d],c[d+1]),4===h)){for(var O=n(c[d+6],c[d+7])/2,$=function(t){return-1===[9,10,11,12,13,32,133,160,5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288].indexOf(t)},D=d+14,M=d+14+2*O,E=!1;M>D&&(E=n(c[D],c[D+1]),!$(E));D+=2)E=!1;if(0!=E){T=String.fromCharCode(E);var P=(-(E-1)+65536)%65536,j=e(0)+i(E)+i(65535)+i(0)+i(E)+i(65535)+i(P)+i(1),L=btoa(j);this.base64=this.base64.substring(0,380)+L+this.base64.substring(380+L.length)}}this.bootstrapValidation(T,!1)}}},e.prototype.bootstrapValidation=function(t,e){var i=this.fontFamily+" testfont",n=document.createElement("style");n.setAttribute("type","text/css"),n.innerHTML="@font-face {\n  font-family: '"+i+"';\n  src: url('data:application/x-font-ttf;base64,"+this.base64+"')\n       format('truetype');}",document.head.appendChild(n);var r=!1;this.systemfont||(r=this.toStyleNode(),document.head.appendChild(r));var o=document.createElement("p");if(o.style.cssText="position: absolute; top: 0; left: 0; opacity: 0;",o.style.fontFamily="'"+this.fontFamily+"', '"+i+"'",o.innerHTML=t+t+t+t+t+t+t+t+t+t,document.body.appendChild(o),"undefined"==typeof getComputedStyle)this.onload(),error("Error: getComputedStyle is not supported by this browser.\nConsequently, Font.onload() cannot be trusted.");else{var a=this.systemfont?1e3:this.metrics.quadsize,s=document.createElement("canvas");s.width=a,s.height=a,this.canvas=s;var l=s.getContext("2d");l.font="1em '"+this.fontFamily+"'",l.fillStyle="white",l.fillRect(-1,-1,a+2,a+2),l.fillStyle="black",l.fillText("test text",50,a/2),this.context=l;var c=this,h=function(){c.validate(o,n,r,c,e)};setTimeout(h,50)}},e.prototype.processSystemFont=function(){this.systemfont=!0,this.metrics=!1,this.bootstrapValidation("A",1e3)},e.prototype.loadFont=function(){var t=this;if(-1===this.url.indexOf("."))return void setTimeout(function(){t.processSystemFont()},10);var e=new XMLHttpRequest;e.open("GET",t.url,!0),e.responseType="arraybuffer",e.onload=function(){var i=e.response;i?(t.data=new Uint8Array(i),t.ondownloaded()):t.onerror("Error downloading font resource from "+t.url)},e.onerror=function(){t.onerror("Error downloading font resource from "+t.url)},e.send(null)},e.prototype.styleNode=!1,e.prototype.toStyleNode=function(){if(this.styleNode)return this.styleNode;this.styleNode=document.createElement("style"),this.styleNode.type="text/css";var t="@font-face {\n";return t+="  font-family: '"+this.fontFamily+"';\n",t+="  src: url('"+this.url+"') format('"+this.format+"');\n",t+="}",this.styleNode.innerHTML=t,this.styleNode},e.prototype.measureText=function(t,e){if(!this.loaded)return this.onerror("measureText() was called while the font was not yet loaded"),!1;this.context.font=e+"px '"+this.fontFamily+"'";var i=this.context.measureText(t);i.fontsize=e,i.ascent=0,i.descent=0,i.bounds={minx:0,maxx:i.width,miny:0,maxy:0},i.height=0;var n=[],r=i.width/this.metrics.quadsize;n.push(1>=r?t:t);var o,a=n.length;for(o=0;a>o;o++)this.measureSegment(n[o],e,i);return i},e.prototype.measureSegment=function(t,e,i){var n,r=function(t,e){return document.defaultView.getComputedStyle(t,null).getPropertyValue(e)},o=document.createElement("div");o.style.position="absolute",o.style.opacity=0,o.style.font=e+"px '"+this.fontFamily+"'";var a=10;for(o.innerHTML=t,n=1;a>n;n++)o.innerHTML+="<br/>"+t;document.body.appendChild(o),i.leading=1.2*e;var s=r(o,"height");if(s=s.replace("px",""),s>=e*a&&(i.leading=s/a|0),document.body.removeChild(o),/^\s*$/.test(t))return i;var l=(this.canvas,this.context),c=this.systemfont?1e3:this.metrics.quadsize,h=c,u=c,f=c/2,d=50,p=(c-i.width)/2;p!==(0|p)&&(p=0|p),l.fillStyle="white",l.fillRect(-d,-d,h+2*d,u+2*d),l.fillStyle="black",l.fillText(t,p,f);for(var g=i.width+d|0,v=4*e,m=p-d/2,b=f-v/2,y=l.getImageData(m,b,g,v).data,n=0,x=0,w=4*g,_=y.length,C=v/2;++n<_&&255===y[n];);var S=n/w|0;for(n=_-1;--n>0&&255===y[n];);var A=n/w|0;for(n=0,x=0;g>x&&255===y[n];)n+=w,n>=_&&(x++,n=n-_+4);var k=x,T=1;for(n=_-3,x=0;g>x&&255===y[n];)n-=w,0>n&&(x++,n=_-3-4*T++);var O=g-x;return i.ascent=C-S,i.descent=A-C,i.bounds={minx:k-d/2,maxx:O-d/2,miny:-i.descent,maxy:i.ascent},i.height=1+(A-S),i},Object.defineProperty(e.prototype,"src",{set:function(t){this.url=t,this.loadFont()}}),"undefined"!=typeof define?define(function(){return e}):t.Font=e}(window),angular.module("ui.slider",[]).value("uiSliderConfig",{}).directive("uiSlider",["uiSliderConfig","$timeout",function(t,e){return t=t||{},{require:"ngModel",compile:function(){return function(i,n,r,o){function a(t,e){return e?parseFloat(t):parseInt(t)}function s(){n.slider("destroy")}var l=angular.extend(i.$eval(r.uiSlider)||{},t),c={min:null,max:null},h=["min","max","step"],u=angular.isUndefined(r.useDecimals)?!1:!0,f=function(){angular.isArray(o.$viewValue)&&l.range!==!0&&(console.warn("Change your range option of ui-slider. When assigning ngModel an array of values then the range option should be set to true."),l.range=!0),angular.forEach(h,function(t){angular.isDefined(r[t])&&(l[t]=a(r[t],u))}),n.slider(l),f=angular.noop};angular.forEach(h,function(t){r.$observe(t,function(e){e&&(f(),n.slider("option",t,a(e,u)),o.$render())})}),r.$observe("disabled",function(t){f(),n.slider("option","disabled",!!t)}),i.$watch(r.uiSlider,function(t){f(),void 0!=t&&n.slider("option",t)},!0),e(f,0,!0),n.bind("slide",function(t,e){o.$setViewValue(e.values||e.value),i.$apply()}),o.$render=function(){f();var t=l.range===!0?"values":"value";l.range||!isNaN(o.$viewValue)||o.$viewValue instanceof Array?l.range&&!angular.isDefined(o.$viewValue)&&(o.$viewValue=[0,0]):o.$viewValue=0,l.range===!0&&(angular.isDefined(l.min)&&l.min>o.$viewValue[0]&&(o.$viewValue[0]=l.min),angular.isDefined(l.max)&&l.max<o.$viewValue[1]&&(o.$viewValue[1]=l.max),o.$viewValue[0]>o.$viewValue[1]&&(c.min>=o.$viewValue[1]&&(o.$viewValue[0]=c.min),c.max<=o.$viewValue[0]&&(o.$viewValue[1]=c.max)),c.min=o.$viewValue[0],c.max=o.$viewValue[1]),n.slider(t,o.$viewValue)},i.$watch(r.ngModel,function(){l.range===!0&&o.$render()},!0),n.bind("$destroy",s)}}}}]),angular.module("rzModule",[]).value("throttle",function(t,e,i){var n,r,o,a=Date.now||function(){return(new Date).getTime()},s=null,l=0;i||(i={});var c=function(){l=i.leading===!1?0:a(),s=null,o=t.apply(n,r),n=r=null};return function(){var h=a();l||i.leading!==!1||(l=h);var u=e-(h-l);return n=this,r=arguments,0>=u?(clearTimeout(s),s=null,l=h,o=t.apply(n,r),n=r=null):s||i.trailing===!1||(s=setTimeout(c,u)),o}}).factory("Slider",["$timeout","$document","throttle",function(t,e,i){var n=function(t,e,i){this.scope=t,this.attributes=i,this.sliderElem=e,this.range=void 0!==i.rzSliderHigh&&void 0!==i.rzSliderModel,this.handleHalfWidth=0,this.maxLeft=0,this.precision=0,this.step=0,this.tracking="",this.minValue=0,this.maxValue=0,this.valueRange=0,this.initRun=!1,this.customTrFn=null,this.fullBar=null,this.selBar=null,this.minH=null,this.maxH=null,this.flrLab=null,this.ceilLab=null,this.minLab=null,this.maxLab=null,this.cmbLab=null,this.init()};return n.prototype={init:function(){var e=this;this.scope.rzSliderTranslate&&(this.customTrFn=this.scope.rzSliderTranslate()),this.initElemHandles(),this.calcViewDimensions(),this.setMinAndMax(),this.precision=void 0===this.scope.rzSliderPrecision?0:+this.scope.rzSliderPrecision,this.step=void 0===this.scope.rzSliderStep?1:+this.scope.rzSliderStep,t(function(){e.updateCeilLab(),e.updateFloorLab(),e.initHandles(),e.bindEvents()}),this.scope.$on("reCalcViewDimensions",angular.bind(this,this.calcViewDimensions)),angular.element(window).on("resize",angular.bind(this,this.calcViewDimensions)),this.initRun=!0;var n=i(function(){e.setMinAndMax(),e.updateLowHandle(e.valueToOffset(e.scope.rzSliderModel)),e.range&&(e.updateSelectionBar(),e.updateCmbLabel())},350,{leading:!1}),r=i(function(){e.setMinAndMax(),e.updateHighHandle(e.valueToOffset(e.scope.rzSliderHigh)),e.updateSelectionBar(),e.updateCmbLabel()},350,{leading:!1});this.scope.$on("rzSliderForceRender",function(){e.resetLabelsValue(),n(),r(),e.resetSlider()}),this.scope.$watch("rzSliderModel",function(t,e){t!==e&&n()}),this.scope.$watch("rzSliderHigh",function(t,e){t!==e&&r()}),this.scope.$watch("rzSliderFloor",function(t,i){t!==i&&e.resetSlider()}),this.scope.$watch("rzSliderCeil",function(t,i){t!==i&&e.resetSlider()})},resetSlider:function(){this.setMinAndMax(),this.calcViewDimensions(),this.updateCeilLab(),this.updateFloorLab()},resetLabelsValue:function(){this.minLab.rzsv=void 0,this.maxLab.rzsv=void 0},initHandles:function(){this.updateLowHandle(this.valueToOffset(this.scope.rzSliderModel)),this.range&&(this.updateHighHandle(this.valueToOffset(this.scope.rzSliderHigh)),this.updateSelectionBar(),this.updateCmbLabel())},translateFn:function(t,e,i){i=void 0===i?!0:i;var n=this.customTrFn&&i?""+this.customTrFn(t):""+t,r=!1;(void 0===e.rzsv||e.rzsv.length!=n.length||e.rzsv.length>0&&0==e.rzsw)&&(r=!0,e.rzsv=n),e.text(n),r&&this.getWidth(e)},setMinAndMax:function(){this.minValue=this.scope.rzSliderFloor?+this.scope.rzSliderFloor:this.scope.rzSliderFloor=0,this.scope.rzSliderCeil?this.maxValue=+this.scope.rzSliderCeil:this.scope.rzSliderCeil=this.maxValue=this.range?this.scope.rzSliderHigh:this.scope.rzSliderModel,this.valueRange=this.maxValue-this.minValue},initElemHandles:function(){angular.forEach(this.sliderElem.children(),function(t,e){var i=angular.element(t);switch(e){case 0:this.fullBar=i;break;case 1:this.selBar=i;break;case 2:this.minH=i;break;case 3:this.maxH=i;break;case 4:this.flrLab=i;break;case 5:this.ceilLab=i;break;case 6:this.minLab=i;break;case 7:this.maxLab=i;break;case 8:this.cmbLab=i}},this),this.fullBar.rzsl=0,this.selBar.rzsl=0,this.minH.rzsl=0,this.maxH.rzsl=0,this.flrLab.rzsl=0,this.ceilLab.rzsl=0,this.minLab.rzsl=0,this.maxLab.rzsl=0,this.cmbLab.rzsl=0,this.range||(this.cmbLab.remove(),this.maxLab.remove(),this.maxH.remove(),this.selBar.remove())},calcViewDimensions:function(){var t=this.getWidth(this.minH);this.handleHalfWidth=t/2,this.barWidth=this.getWidth(this.fullBar),this.maxLeft=this.barWidth-t,this.getWidth(this.sliderElem),this.sliderElem.rzsl=this.sliderElem[0].getBoundingClientRect().left,this.initRun&&(this.updateCeilLab(),this.initHandles())},updateCeilLab:function(){this.translateFn(this.scope.rzSliderCeil,this.ceilLab),this.setLeft(this.ceilLab,this.barWidth-this.ceilLab.rzsw),this.getWidth(this.ceilLab)},updateFloorLab:function(){this.translateFn(this.scope.rzSliderFloor,this.flrLab),this.getWidth(this.flrLab)},updateHandles:function(t,e){return"rzSliderModel"===t?(this.updateLowHandle(e),void(this.range&&(this.updateSelectionBar(),this.updateCmbLabel()))):"rzSliderHigh"===t?(this.updateHighHandle(e),void(this.range&&(this.updateSelectionBar(),this.updateCmbLabel()))):(this.updateLowHandle(e),this.updateHighHandle(e),this.updateSelectionBar(),void this.updateCmbLabel())},updateLowHandle:function(t){this.setLeft(this.minH,t),this.translateFn(this.scope.rzSliderModel,this.minLab),this.setLeft(this.minLab,t-this.minLab.rzsw/2+this.handleHalfWidth),this.shFloorCeil()},updateHighHandle:function(t){this.setLeft(this.maxH,t),this.translateFn(this.scope.rzSliderHigh,this.maxLab),this.setLeft(this.maxLab,t-this.maxLab.rzsw/2+this.handleHalfWidth),this.shFloorCeil()},shFloorCeil:function(){var t=!1,e=!1;this.minLab.rzsl<=this.flrLab.rzsl+this.flrLab.rzsw+5?(t=!0,this.hideEl(this.flrLab)):(t=!1,this.showEl(this.flrLab)),this.minLab.rzsl+this.minLab.rzsw>=this.ceilLab.rzsl-this.handleHalfWidth-10?(e=!0,this.hideEl(this.ceilLab)):(e=!1,this.showEl(this.ceilLab)),this.range&&(this.maxLab.rzsl+this.maxLab.rzsw>=this.ceilLab.rzsl-10?this.hideEl(this.ceilLab):e||this.showEl(this.ceilLab),this.maxLab.rzsl<=this.flrLab.rzsl+this.flrLab.rzsw+this.handleHalfWidth?this.hideEl(this.flrLab):t||this.showEl(this.flrLab))},updateSelectionBar:function(){this.setWidth(this.selBar,this.maxH.rzsl-this.minH.rzsl),this.setLeft(this.selBar,this.minH.rzsl+this.handleHalfWidth)},updateCmbLabel:function(){var t,e;this.minLab.rzsl+this.minLab.rzsw+10>=this.maxLab.rzsl?(this.customTrFn?(t=this.customTrFn(this.scope.rzSliderModel),e=this.customTrFn(this.scope.rzSliderHigh)):(t=this.scope.rzSliderModel,e=this.scope.rzSliderHigh),this.translateFn(t+" - "+e,this.cmbLab,!1),this.setLeft(this.cmbLab,this.selBar.rzsl+this.selBar.rzsw/2-this.cmbLab.rzsw/2),this.hideEl(this.minLab),this.hideEl(this.maxLab),this.showEl(this.cmbLab)):(this.showEl(this.maxLab),this.showEl(this.minLab),this.hideEl(this.cmbLab))},roundStep:function(t){var e=this.step,i=(t-this.minValue)%e,n=i>e/2?t+e-i:t-i;return+n.toFixed(this.precision)},hideEl:function(t){return t.css({opacity:0})},showEl:function(t){return t.css({opacity:1})},setLeft:function(t,e){return t.rzsl=e,t.css({left:e+"px"}),e},getWidth:function(t){var e=t[0].getBoundingClientRect();return t.rzsw=e.right-e.left,t.rzsw},setWidth:function(t,e){return t.rzsw=e,t.css({width:e+"px"}),e},valueToOffset:function(t){return(t-this.minValue)*this.maxLeft/this.valueRange},offsetToValue:function(t){return t/this.maxLeft*this.valueRange+this.minValue},bindEvents:function(){this.minH.on("mousedown",angular.bind(this,this.onStart,this.minH,"rzSliderModel")),this.range&&this.maxH.on("mousedown",angular.bind(this,this.onStart,this.maxH,"rzSliderHigh")),this.minH.on("touchstart",angular.bind(this,this.onStart,this.minH,"rzSliderModel")),this.range&&this.maxH.on("touchstart",angular.bind(this,this.onStart,this.maxH,"rzSliderHigh"))},onStart:function(t,i,n){n.stopPropagation(),n.preventDefault(),""===this.tracking&&(this.calcViewDimensions(),this.tracking=i,t.addClass("active"),n.touches||"undefined"!=typeof n.originalEvent&&n.originalEvent.touches?(e.on("touchmove.rzslider",angular.bind(this,this.onMove,t)),e.on("touchend.rzslider",angular.bind(this,this.onEnd))):(e.on("mousemove.rzslider",angular.bind(this,this.onMove,t)),e.on("mouseup.rzslider",angular.bind(this,this.onEnd))))},onMove:function(t,e){var i,n=e.clientX||("undefined"!=typeof e.originalEvent?e.originalEvent.touches[0].clientX:e.touches[0].clientX),r=this.sliderElem.rzsl,o=n-r-this.handleHalfWidth;return 0>=o?void(0!==t.rzsl&&(this.scope[this.tracking]=this.minValue,this.updateHandles(this.tracking,0),this.scope.$apply())):o>=this.maxLeft?void(t.rzsl!==this.maxLeft&&(this.scope[this.tracking]=this.maxValue,this.updateHandles(this.tracking,this.maxLeft),this.scope.$apply())):(i=this.offsetToValue(o),i=this.roundStep(i),this.range&&("rzSliderModel"===this.tracking&&i>=this.scope.rzSliderHigh?(this.scope[this.tracking]=this.scope.rzSliderHigh,this.updateHandles(this.tracking,this.maxH.rzsl),this.tracking="rzSliderHigh",this.minH.removeClass("active"),this.maxH.addClass("active")):"rzSliderHigh"===this.tracking&&i<=this.scope.rzSliderModel&&(this.scope[this.tracking]=this.scope.rzSliderModel,this.updateHandles(this.tracking,this.minH.rzsl),this.tracking="rzSliderModel",this.maxH.removeClass("active"),this.minH.addClass("active"))),void(this.scope[this.tracking]!==i&&(this.scope[this.tracking]=i,this.updateHandles(this.tracking,o),this.scope.$apply())))},onEnd:function(t){this.minH.removeClass("active"),this.maxH.removeClass("active"),t.touches||"undefined"!=typeof t.originalEvent&&t.originalEvent.touches?(e.unbind("touchmove.rzslider"),e.unbind("touchend.rzslider")):(e.unbind("mousemove.rzslider"),e.unbind("mouseup.rzslider")),this.scope.$emit("slideEnded"),this.tracking=""}},n}]).directive("rzslider",["Slider",function(t){return{restrict:"EA",scope:{rzSliderFloor:"=?",rzSliderCeil:"=?",rzSliderStep:"@",rzSliderPrecision:"@",rzSliderModel:"=?",rzSliderHigh:"=?",rzSliderTranslate:"&"},template:'<span class="bar"></span><span class="bar selection"></span><span class="pointer"></span><span class="pointer"></span><span class="bubble limit"></span><span class="bubble limit"></span><span class="bubble"></span><span class="bubble"></span><span class="bubble"></span>',link:function(e,i,n){return new t(e,i,n)}}}]),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function e(e){var a=e||window.event,s=l.call(arguments,1),c=0,h=0,u=0,f=0;if(e=t.event.fix(a),e.type="mousewheel","detail"in a&&(u=-1*a.detail),"wheelDelta"in a&&(u=a.wheelDelta),"wheelDeltaY"in a&&(u=a.wheelDeltaY),"wheelDeltaX"in a&&(h=-1*a.wheelDeltaX),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(h=-1*u,u=0),c=0===u?h:u,"deltaY"in a&&(u=-1*a.deltaY,c=u),"deltaX"in a&&(h=a.deltaX,0===u&&(c=-1*h)),0!==u||0!==h){if(1===a.deltaMode){var d=t.data(this,"mousewheel-line-height");
c*=d,u*=d,h*=d}else if(2===a.deltaMode){var p=t.data(this,"mousewheel-page-height");c*=p,u*=p,h*=p}return f=Math.max(Math.abs(u),Math.abs(h)),(!o||o>f)&&(o=f,n(a,f)&&(o/=40)),n(a,f)&&(c/=40,h/=40,u/=40),c=Math[c>=1?"floor":"ceil"](c/o),h=Math[h>=1?"floor":"ceil"](h/o),u=Math[u>=1?"floor":"ceil"](u/o),e.deltaX=h,e.deltaY=u,e.deltaFactor=o,e.deltaMode=0,s.unshift(e,c,h,u),r&&clearTimeout(r),r=setTimeout(i,200),(t.event.dispatch||t.event.handle).apply(this,s)}}function i(){o=null}function n(t,e){return h.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120===0}var r,o,a=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(t.event.fixHooks)for(var c=a.length;c;)t.event.fixHooks[a[--c]]=t.event.mouseHooks;var h=t.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var i=s.length;i;)this.addEventListener(s[--i],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",h.getLineHeight(this)),t.data(this,"mousewheel-page-height",h.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=s.length;t;)this.removeEventListener(s[--t],e,!1);else this.onmousewheel=null},getLineHeight:function(e){return parseInt(t(e)["offsetParent"in t.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";var e={wheelSpeed:10,wheelPropagation:!1,minScrollbarLength:null,maxScrollbarLength:null,useBothWheelAxes:!1,useKeyboard:!0,suppressScrollX:!1,suppressScrollY:!1,scrollXMarginOffset:0,scrollYMarginOffset:0,includePadding:!1},i=function(){var t=0;return function(){var e=t;return t+=1,".perfect-scrollbar-"+e}}();t.fn.perfectScrollbar=function(n,r){return this.each(function(){var o=t.extend(!0,{},e),a=t(this);if("object"==typeof n?t.extend(!0,o,n):r=n,"update"===r)return a.data("perfect-scrollbar-update")&&a.data("perfect-scrollbar-update")(),a;if("destroy"===r)return a.data("perfect-scrollbar-destroy")&&a.data("perfect-scrollbar-destroy")(),a;if(a.data("perfect-scrollbar"))return a.data("perfect-scrollbar");a.addClass("ps-container");var s,l,c,h,u,f,d,p,g,v,m=t("<div class='ps-scrollbar-x-rail'></div>").appendTo(a),b=t("<div class='ps-scrollbar-y-rail'></div>").appendTo(a),y=t("<div class='ps-scrollbar-x'></div>").appendTo(m),x=t("<div class='ps-scrollbar-y'></div>").appendTo(b),w=parseInt(m.css("bottom"),10),_=w===w,C=_?null:parseInt(m.css("top"),10),S=parseInt(b.css("right"),10),A=S===S,k=A?null:parseInt(b.css("left"),10),T="rtl"===a.css("direction"),O=i(),$=parseInt(m.css("borderLeftWidth"),10)+parseInt(m.css("borderRightWidth"),10),D=parseInt(m.css("borderTopWidth"),10)+parseInt(m.css("borderBottomWidth"),10),M=function(t,e){var i=t+e,n=h-g;v=0>i?0:i>n?n:i;var r=parseInt(v*(f-h)/(h-g),10);a.scrollTop(r),m.css(_?{bottom:w-r}:{top:C+r})},E=function(t,e){var i=t+e,n=c-d;p=0>i?0:i>n?n:i;var r=parseInt(p*(u-c)/(c-d),10);a.scrollLeft(r),b.css(A?{right:S-r}:{left:k+r})},P=function(t){return o.minScrollbarLength&&(t=Math.max(t,o.minScrollbarLength)),o.maxScrollbarLength&&(t=Math.min(t,o.maxScrollbarLength)),t},j=function(){var t={width:c,display:s?"inherit":"none"};t.left=T?a.scrollLeft()+c-u:a.scrollLeft(),_?t.bottom=w-a.scrollTop():t.top=C+a.scrollTop(),m.css(t);var e={top:a.scrollTop(),height:h,display:l?"inherit":"none"};A?e.right=T?u-a.scrollLeft()-S-x.outerWidth():S-a.scrollLeft():e.left=T?a.scrollLeft()+2*c-u-k-x.outerWidth():k+a.scrollLeft(),b.css(e),y.css({left:p,width:d-$}),x.css({top:v,height:g-D}),s?a.addClass("ps-active-x"):a.removeClass("ps-active-x"),l?a.addClass("ps-active-y"):a.removeClass("ps-active-y")},L=function(){c=o.includePadding?a.innerWidth():a.width(),h=o.includePadding?a.innerHeight():a.height(),u=a.prop("scrollWidth"),f=a.prop("scrollHeight"),!o.suppressScrollX&&c+o.scrollXMarginOffset<u?(s=!0,d=P(parseInt(c*c/u,10)),p=parseInt(a.scrollLeft()*(c-d)/(u-c),10)):(s=!1,d=0,p=0,a.scrollLeft(0)),!o.suppressScrollY&&h+o.scrollYMarginOffset<f?(l=!0,g=P(parseInt(h*h/f,10)),v=parseInt(a.scrollTop()*(h-g)/(f-h),10)):(l=!1,g=0,v=0,a.scrollTop(0)),v>=h-g&&(v=h-g),p>=c-d&&(p=c-d),j()},I=function(){var e,i;y.bind("mousedown"+O,function(t){i=t.pageX,e=y.position().left,m.addClass("in-scrolling"),t.stopPropagation(),t.preventDefault()}),t(document).bind("mousemove"+O,function(t){m.hasClass("in-scrolling")&&(E(e,t.pageX-i),t.stopPropagation(),t.preventDefault())}),t(document).bind("mouseup"+O,function(){m.hasClass("in-scrolling")&&m.removeClass("in-scrolling")}),e=i=null},F=function(){var e,i;x.bind("mousedown"+O,function(t){i=t.pageY,e=x.position().top,b.addClass("in-scrolling"),t.stopPropagation(),t.preventDefault()}),t(document).bind("mousemove"+O,function(t){b.hasClass("in-scrolling")&&(M(e,t.pageY-i),t.stopPropagation(),t.preventDefault())}),t(document).bind("mouseup"+O,function(){b.hasClass("in-scrolling")&&b.removeClass("in-scrolling")}),e=i=null},H=function(t,e){var i=a.scrollTop();if(0===t){if(!l)return!1;if(0===i&&e>0||i>=f-h&&0>e)return!o.wheelPropagation}var n=a.scrollLeft();if(0===e){if(!s)return!1;if(0===n&&0>t||n>=u-c&&t>0)return!o.wheelPropagation}return!0},R=function(){o.wheelSpeed/=10;var t=!1;a.bind("mousewheel"+O,function(e,i,n,r){var c=e.deltaX*e.deltaFactor||n,h=e.deltaY*e.deltaFactor||r;t=!1,o.useBothWheelAxes?l&&!s?(a.scrollTop(h?a.scrollTop()-h*o.wheelSpeed:a.scrollTop()+c*o.wheelSpeed),t=!0):s&&!l&&(a.scrollLeft(c?a.scrollLeft()+c*o.wheelSpeed:a.scrollLeft()-h*o.wheelSpeed),t=!0):(a.scrollTop(a.scrollTop()-h*o.wheelSpeed),a.scrollLeft(a.scrollLeft()+c*o.wheelSpeed)),L(),t=t||H(c,h),t&&(e.stopPropagation(),e.preventDefault())}),a.bind("MozMousePixelScroll"+O,function(e){t&&e.preventDefault()})},B=function(){var e=!1;a.bind("mouseenter"+O,function(){e=!0}),a.bind("mouseleave"+O,function(){e=!1});var i=!1;t(document).bind("keydown"+O,function(n){if(!(n.isDefaultPrevented&&n.isDefaultPrevented()||!e||t(document.activeElement).is(":input,[contenteditable]"))){var r=0,o=0;switch(n.which){case 37:r=-30;break;case 38:o=30;break;case 39:r=30;break;case 40:o=-30;break;case 33:o=90;break;case 32:case 34:o=-90;break;case 35:o=-h;break;case 36:o=h;break;default:return}a.scrollTop(a.scrollTop()-o),a.scrollLeft(a.scrollLeft()+r),i=H(r,o),i&&n.preventDefault()}})},V=function(){var t=function(t){t.stopPropagation()};x.bind("click"+O,t),b.bind("click"+O,function(t){var e=parseInt(g/2,10),i=t.pageY-b.offset().top-e,n=h-g,r=i/n;0>r?r=0:r>1&&(r=1),a.scrollTop((f-h)*r)}),y.bind("click"+O,t),m.bind("click"+O,function(t){var e=parseInt(d/2,10),i=t.pageX-m.offset().left-e,n=c-d,r=i/n;0>r?r=0:r>1&&(r=1),a.scrollLeft((u-c)*r)})},z=function(){var e=function(t,e){a.scrollTop(a.scrollTop()-e),a.scrollLeft(a.scrollLeft()-t),L()},i={},n=0,r={},o=null,s=!1;t(window).bind("touchstart"+O,function(){s=!0}),t(window).bind("touchend"+O,function(){s=!1}),a.bind("touchstart"+O,function(t){var e=t.originalEvent.targetTouches[0];i.pageX=e.pageX,i.pageY=e.pageY,n=(new Date).getTime(),null!==o&&clearInterval(o),t.stopPropagation()}),a.bind("touchmove"+O,function(t){if(!s&&1===t.originalEvent.targetTouches.length){var o=t.originalEvent.targetTouches[0],a={};a.pageX=o.pageX,a.pageY=o.pageY;var l=a.pageX-i.pageX,c=a.pageY-i.pageY;e(l,c),i=a;var h=(new Date).getTime(),u=h-n;u>0&&(r.x=l/u,r.y=c/u,n=h),t.preventDefault()}}),a.bind("touchend"+O,function(){clearInterval(o),o=setInterval(function(){return Math.abs(r.x)<.01&&Math.abs(r.y)<.01?void clearInterval(o):(e(30*r.x,30*r.y),r.x*=.8,void(r.y*=.8))},10)})},W=function(){a.bind("scroll"+O,function(){L()})},N=function(){a.unbind(O),t(window).unbind(O),t(document).unbind(O),a.data("perfect-scrollbar",null),a.data("perfect-scrollbar-update",null),a.data("perfect-scrollbar-destroy",null),y.remove(),x.remove(),m.remove(),b.remove(),m=b=y=x=s=l=c=h=u=f=d=p=w=_=C=g=v=S=A=k=T=O=null},X=function(e){a.addClass("ie").addClass("ie"+e);var i=function(){var e=function(){t(this).addClass("hover")},i=function(){t(this).removeClass("hover")};a.bind("mouseenter"+O,e).bind("mouseleave"+O,i),m.bind("mouseenter"+O,e).bind("mouseleave"+O,i),b.bind("mouseenter"+O,e).bind("mouseleave"+O,i),y.bind("mouseenter"+O,e).bind("mouseleave"+O,i),x.bind("mouseenter"+O,e).bind("mouseleave"+O,i)},n=function(){j=function(){var t={left:p+a.scrollLeft(),width:d};_?t.bottom=w:t.top=C,y.css(t);var e={top:v+a.scrollTop(),height:g};A?e.right=S:e.left=k,x.css(e),y.hide().show(),x.hide().show()}};6===e&&(i(),n())},Y="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,G=function(){var t=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/);t&&"msie"===t[1]&&X(parseInt(t[2],10)),L(),W(),I(),F(),V(),Y&&z(),a.mousewheel&&R(),o.useKeyboard&&B(),a.data("perfect-scrollbar",a),a.data("perfect-scrollbar-update",L),a.data("perfect-scrollbar-destroy",N)};return G(),a})}}),angular.module("perfect_scrollbar",[]).directive("perfectScrollbar",["$parse","$window",function(t,e){var i=["wheelSpeed","wheelPropagation","minScrollbarLength","useBothWheelAxes","useKeyboard","suppressScrollX","suppressScrollY","scrollXMarginOffset","scrollYMarginOffset","includePadding"];return{restrict:"EA",transclude:!0,template:"<div><div ng-transclude></div></div>",replace:!0,link:function(n,r,o){function a(){n.$evalAsync(function(){r.perfectScrollbar("update")}),n.$$phase||n.$apply()}for(var s=angular.element(e),l={},c=0,h=i.length;h>c;c++){var u=i[c];void 0!==o[u]&&(l[u]=t(o[u])())}n.$evalAsync(function(){r.perfectScrollbar(l)}),r.bind("mouseenter",a),o.refreshOnChange&&n.$watchCollection(o.refreshOnChange,function(){a()}),o.refreshOnResize&&s.on("resize",a),r.bind("$destroy",function(){s.off("resize",a),r.perfectScrollbar("destroy")})}}}]),angular.module("ui.bootstrap",["ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(t,e,i){function n(t){for(var e in t)if(void 0!==o.style[e])return t[e]}var r=function(n,o,a){a=a||{};var s=t.defer(),l=r[a.animation?"animationEndEventName":"transitionEndEventName"],c=function(){i.$apply(function(){n.unbind(l,c),s.resolve(n)})};return l&&n.bind(l,c),e(function(){angular.isString(o)?n.addClass(o):angular.isFunction(o)?o(n):angular.isObject(o)&&n.css(o),l||s.resolve(n)}),s.promise.cancel=function(){l&&n.unbind(l,c),s.reject("Transition cancelled")},s.promise},o=document.createElement("trans"),a={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},s={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return r.transitionEndEventName=n(a),r.animationEndEventName=n(s),r}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(t){return{link:function(e,i,n){function r(e){function n(){c===r&&(c=void 0)}var r=t(i,e);return c&&c.cancel(),c=r,r.then(n,n),r}function o(){h?(h=!1,a()):(i.removeClass("collapse").addClass("collapsing"),r({height:i[0].scrollHeight+"px"}).then(a))}function a(){i.removeClass("collapsing"),i.addClass("collapse in"),i.css({height:"auto"})}function s(){if(h)h=!1,l(),i.css({height:0});else{i.css({height:i[0].scrollHeight+"px"});{i[0].offsetWidth}i.removeClass("collapse in").addClass("collapsing"),r({height:0}).then(l)}}function l(){i.removeClass("collapsing"),i.addClass("collapse")}var c,h=!0;e.$watch(n.collapse,function(t){t?s():o()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(t,e,i){this.groups=[],this.closeOthers=function(n){var r=angular.isDefined(e.closeOthers)?t.$eval(e.closeOthers):i.closeOthers;r&&angular.forEach(this.groups,function(t){t!==n&&(t.isOpen=!1)})},this.addGroup=function(t){var e=this;this.groups.push(t),t.$on("$destroy",function(){e.removeGroup(t)})},this.removeGroup=function(t){var e=this.groups.indexOf(t);-1!==e&&this.groups.splice(e,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(t){this.heading=t}},link:function(t,e,i,n){n.addGroup(t),t.$watch("isOpen",function(e){e&&n.closeOthers(t)}),t.toggleOpen=function(){t.isDisabled||(t.isOpen=!t.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(t,e,i,n,r){n.setHeading(r(t,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(t,e,i,n){t.$watch(function(){return n[i.accordionTransclude]},function(t){t&&(e.html(""),e.append(t))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function(t,e){t.closeable="close"in e}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(t,e,i){e.addClass("ng-binding").data("$binding",i.bindHtmlUnsafe),t.$watch(i.bindHtmlUnsafe,function(t){e.html(t||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(t){this.activeClass=t.activeClass||"active",this.toggleEvent=t.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(t,e,i,n){var r=n[0],o=n[1];o.$render=function(){e.toggleClass(r.activeClass,angular.equals(o.$modelValue,t.$eval(i.btnRadio)))},e.bind(r.toggleEvent,function(){var n=e.hasClass(r.activeClass);(!n||angular.isDefined(i.uncheckable))&&t.$apply(function(){o.$setViewValue(n?null:t.$eval(i.btnRadio)),o.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(t,e,i,n){function r(){return a(i.btnCheckboxTrue,!0)}function o(){return a(i.btnCheckboxFalse,!1)}function a(e,i){var n=t.$eval(e);return angular.isDefined(n)?n:i}var s=n[0],l=n[1];l.$render=function(){e.toggleClass(s.activeClass,angular.equals(l.$modelValue,r()))},e.bind(s.toggleEvent,function(){t.$apply(function(){l.$setViewValue(e.hasClass(s.activeClass)?o():r()),l.$render()})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition",function(t,e,i){function n(){r();var i=+t.interval;!isNaN(i)&&i>=0&&(a=e(o,i))}function r(){a&&(e.cancel(a),a=null)}function o(){s?(t.next(),n()):t.pause()}var a,s,l=this,c=l.slides=t.slides=[],h=-1;l.currentSlide=null;var u=!1;l.select=t.select=function(r,o){function a(){if(!u){if(l.currentSlide&&angular.isString(o)&&!t.noTransition&&r.$element){r.$element.addClass(o);{r.$element[0].offsetWidth}angular.forEach(c,function(t){angular.extend(t,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(r,{direction:o,active:!0,entering:!0}),angular.extend(l.currentSlide||{},{direction:o,leaving:!0}),t.$currentTransition=i(r.$element,{}),function(e,i){t.$currentTransition.then(function(){s(e,i)},function(){s(e,i)})}(r,l.currentSlide)}else s(r,l.currentSlide);l.currentSlide=r,h=f,n()}}function s(e,i){angular.extend(e,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(i||{},{direction:"",active:!1,leaving:!1,entering:!1}),t.$currentTransition=null}var f=c.indexOf(r);void 0===o&&(o=f>h?"next":"prev"),r&&r!==l.currentSlide&&(t.$currentTransition?(t.$currentTransition.cancel(),e(a)):a())},t.$on("$destroy",function(){u=!0}),l.indexOfSlide=function(t){return c.indexOf(t)},t.next=function(){var e=(h+1)%c.length;return t.$currentTransition?void 0:l.select(c[e],"next")},t.prev=function(){var e=0>h-1?c.length-1:h-1;return t.$currentTransition?void 0:l.select(c[e],"prev")},t.isActive=function(t){return l.currentSlide===t},t.$watch("interval",n),t.$on("$destroy",r),t.play=function(){s||(s=!0,n())},t.pause=function(){t.noPause||(s=!1,r())},l.addSlide=function(e,i){e.$element=i,c.push(e),1===c.length||e.active?(l.select(c[c.length-1]),1==c.length&&t.play()):e.active=!1},l.removeSlide=function(t){var e=c.indexOf(t);c.splice(e,1),c.length>0&&t.active?l.select(e>=c.length?c[e-1]:c[e]):h>e&&h--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(t,e,i,n){n.addSlide(t,e),t.$on("$destroy",function(){n.removeSlide(t)}),t.$watch("active",function(e){e&&n.select(t)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function(t,e){function i(t){var i=[],n=t.split("");return angular.forEach(r,function(e,r){var o=t.indexOf(r);if(o>-1){t=t.split(""),n[o]="("+e.regex+")",t[o]="$";for(var a=o+1,s=o+r.length;s>a;a++)n[a]="",t[a]="$";t=t.join(""),i.push({index:o,apply:e.apply})}}),{regex:new RegExp("^"+n.join("")+"$"),map:e(i,"index")}}function n(t,e,i){return 1===e&&i>28?29===i&&(t%4===0&&t%100!==0||t%400===0):3===e||5===e||8===e||10===e?31>i:!0}this.parsers={};var r={yyyy:{regex:"\\d{4}",apply:function(t){this.year=+t}},yy:{regex:"\\d{2}",apply:function(t){this.year=+t+2e3}},y:{regex:"\\d{1,4}",apply:function(t){this.year=+t}},MMMM:{regex:t.DATETIME_FORMATS.MONTH.join("|"),apply:function(e){this.month=t.DATETIME_FORMATS.MONTH.indexOf(e)}},MMM:{regex:t.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(e){this.month=t.DATETIME_FORMATS.SHORTMONTH.indexOf(e)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(t){this.month=t-1}},M:{regex:"[1-9]|1[0-2]",apply:function(t){this.month=t-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(t){this.date=+t}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(t){this.date=+t}},EEEE:{regex:t.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:t.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(e,r){if(!angular.isString(e)||!r)return e;r=t.DATETIME_FORMATS[r]||r,this.parsers[r]||(this.parsers[r]=i(r));var o=this.parsers[r],a=o.regex,s=o.map,l=e.match(a);if(l&&l.length){for(var c,h={year:1900,month:0,date:1,hours:0},u=1,f=l.length;f>u;u++){var d=s[u-1];d.apply&&d.apply.call(h,l[u])}return n(h.year,h.month,h.date)&&(c=new Date(h.year,h.month,h.date,h.hours)),c}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(t,e){function i(t,i){return t.currentStyle?t.currentStyle[i]:e.getComputedStyle?e.getComputedStyle(t)[i]:t.style[i]}function n(t){return"static"===(i(t,"position")||"static")}var r=function(e){for(var i=t[0],r=e.offsetParent||i;r&&r!==i&&n(r);)r=r.offsetParent;return r||i};return{position:function(e){var i=this.offset(e),n={top:0,left:0},o=r(e[0]);o!=t[0]&&(n=this.offset(angular.element(o)),n.top+=o.clientTop-o.scrollTop,n.left+=o.clientLeft-o.scrollLeft);var a=e[0].getBoundingClientRect();return{width:a.width||e.prop("offsetWidth"),height:a.height||e.prop("offsetHeight"),top:i.top-n.top,left:i.left-n.left}},offset:function(i){var n=i[0].getBoundingClientRect();return{width:n.width||i.prop("offsetWidth"),height:n.height||i.prop("offsetHeight"),top:n.top+(e.pageYOffset||t[0].documentElement.scrollTop),left:n.left+(e.pageXOffset||t[0].documentElement.scrollLeft)}},positionElements:function(t,e,i,n){var r,o,a,s,l=i.split("-"),c=l[0],h=l[1]||"center";r=n?this.offset(t):this.position(t),o=e.prop("offsetWidth"),a=e.prop("offsetHeight");var u={center:function(){return r.left+r.width/2-o/2},left:function(){return r.left},right:function(){return r.left+r.width}},f={center:function(){return r.top+r.height/2-a/2},top:function(){return r.top},bottom:function(){return r.top+r.height}};switch(c){case"right":s={top:f[h](),left:u[c]()};break;case"left":s={top:f[h](),left:r.left-o};break;case"bottom":s={top:f[c](),left:u[h]()};break;default:s={top:r.top-a,left:u[h]()}}return s}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function(t,e,i,n,r,o,a,s){var l=this,c={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(i,r){l[i]=angular.isDefined(e[i])?8>r?n(e[i])(t.$parent):t.$parent.$eval(e[i]):s[i]}),angular.forEach(["minDate","maxDate"],function(n){e[n]?t.$parent.$watch(i(e[n]),function(t){l[n]=t?new Date(t):null,l.refreshView()}):l[n]=s[n]?new Date(s[n]):null}),t.datepickerMode=t.datepickerMode||s.datepickerMode,t.uniqueId="datepicker-"+t.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined(e.initDate)?t.$parent.$eval(e.initDate):new Date,t.isActive=function(e){return 0===l.compare(e.date,l.activeDate)?(t.activeDateId=e.uid,!0):!1},this.init=function(t){c=t,c.$render=function(){l.render()}},this.render=function(){if(c.$modelValue){var t=new Date(c.$modelValue),e=!isNaN(t);e?this.activeDate=t:o.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),c.$setValidity("date",e)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var t=c.$modelValue?new Date(c.$modelValue):null;c.$setValidity("date-disabled",!t||this.element&&!this.isDisabled(t))}},this.createDateObject=function(t,e){var i=c.$modelValue?new Date(c.$modelValue):null;return{date:t,label:a(t,e),selected:i&&0===this.compare(t,i),disabled:this.isDisabled(t),current:0===this.compare(t,new Date)}},this.isDisabled=function(i){return this.minDate&&this.compare(i,this.minDate)<0||this.maxDate&&this.compare(i,this.maxDate)>0||e.dateDisabled&&t.dateDisabled({date:i,mode:t.datepickerMode})},this.split=function(t,e){for(var i=[];t.length>0;)i.push(t.splice(0,e));return i},t.select=function(e){if(t.datepickerMode===l.minMode){var i=c.$modelValue?new Date(c.$modelValue):new Date(0,0,0,0,0,0,0);i.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),c.$setViewValue(i),c.$render()}else l.activeDate=e,t.datepickerMode=l.modes[l.modes.indexOf(t.datepickerMode)-1]},t.move=function(t){var e=l.activeDate.getFullYear()+t*(l.step.years||0),i=l.activeDate.getMonth()+t*(l.step.months||0);l.activeDate.setFullYear(e,i,1),l.refreshView()},t.toggleMode=function(e){e=e||1,t.datepickerMode===l.maxMode&&1===e||t.datepickerMode===l.minMode&&-1===e||(t.datepickerMode=l.modes[l.modes.indexOf(t.datepickerMode)+e])},t.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var h=function(){r(function(){l.element[0].focus()},0,!1)};t.$on("datepicker.focus",h),t.keydown=function(e){var i=t.keys[e.which];if(i&&!e.shiftKey&&!e.altKey)if(e.preventDefault(),e.stopPropagation(),"enter"===i||"space"===i){if(l.isDisabled(l.activeDate))return;t.select(l.activeDate),h()}else!e.ctrlKey||"up"!==i&&"down"!==i?(l.handleKeyDown(i,e),l.refreshView()):(t.toggleMode("up"===i?1:-1),h())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(t,e,i,n){var r=n[0],o=n[1];o&&r.init(o)}}}).directive("daypicker",["dateFilter",function(t){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(e,i,n,r){function o(t,e){return 1!==e||t%4!==0||t%100===0&&t%400!==0?l[e]:29}function a(t,e){var i=new Array(e),n=new Date(t),r=0;for(n.setHours(12);e>r;)i[r++]=new Date(n),n.setDate(n.getDate()+1);return i}function s(t){var e=new Date(t);e.setDate(e.getDate()+4-(e.getDay()||7));var i=e.getTime();return e.setMonth(0),e.setDate(1),Math.floor(Math.round((i-e)/864e5)/7)+1}e.showWeeks=r.showWeeks,r.step={months:1},r.element=i;var l=[31,28,31,30,31,30,31,31,30,31,30,31];r._refreshView=function(){var i=r.activeDate.getFullYear(),n=r.activeDate.getMonth(),o=new Date(i,n,1),l=r.startingDay-o.getDay(),c=l>0?7-l:-l,h=new Date(o);c>0&&h.setDate(-c+1);for(var u=a(h,42),f=0;42>f;f++)u[f]=angular.extend(r.createDateObject(u[f],r.formatDay),{secondary:u[f].getMonth()!==n,uid:e.uniqueId+"-"+f});e.labels=new Array(7);for(var d=0;7>d;d++)e.labels[d]={abbr:t(u[d].date,r.formatDayHeader),full:t(u[d].date,"EEEE")};if(e.title=t(r.activeDate,r.formatDayTitle),e.rows=r.split(u,7),e.showWeeks){e.weekNumbers=[];for(var p=s(e.rows[0][0].date),g=e.rows.length;e.weekNumbers.push(p++)<g;);}},r.compare=function(t,e){return new Date(t.getFullYear(),t.getMonth(),t.getDate())-new Date(e.getFullYear(),e.getMonth(),e.getDate())},r.handleKeyDown=function(t){var e=r.activeDate.getDate();if("left"===t)e-=1;else if("up"===t)e-=7;else if("right"===t)e+=1;else if("down"===t)e+=7;else if("pageup"===t||"pagedown"===t){var i=r.activeDate.getMonth()+("pageup"===t?-1:1);r.activeDate.setMonth(i,1),e=Math.min(o(r.activeDate.getFullYear(),r.activeDate.getMonth()),e)}else"home"===t?e=1:"end"===t&&(e=o(r.activeDate.getFullYear(),r.activeDate.getMonth()));r.activeDate.setDate(e)},r.refreshView()}}}]).directive("monthpicker",["dateFilter",function(t){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(e,i,n,r){r.step={years:1},r.element=i,r._refreshView=function(){for(var i=new Array(12),n=r.activeDate.getFullYear(),o=0;12>o;o++)i[o]=angular.extend(r.createDateObject(new Date(n,o,1),r.formatMonth),{uid:e.uniqueId+"-"+o});e.title=t(r.activeDate,r.formatMonthTitle),e.rows=r.split(i,3)},r.compare=function(t,e){return new Date(t.getFullYear(),t.getMonth())-new Date(e.getFullYear(),e.getMonth())},r.handleKeyDown=function(t){var e=r.activeDate.getMonth();if("left"===t)e-=1;else if("up"===t)e-=3;else if("right"===t)e+=1;else if("down"===t)e+=3;else if("pageup"===t||"pagedown"===t){var i=r.activeDate.getFullYear()+("pageup"===t?-1:1);r.activeDate.setFullYear(i)}else"home"===t?e=0:"end"===t&&(e=11);r.activeDate.setMonth(e)},r.refreshView()}}}]).directive("yearpicker",["dateFilter",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(t,e,i,n){function r(t){return parseInt((t-1)/o,10)*o+1}var o=n.yearRange;n.step={years:o},n.element=e,n._refreshView=function(){for(var e=new Array(o),i=0,a=r(n.activeDate.getFullYear());o>i;i++)e[i]=angular.extend(n.createDateObject(new Date(a+i,0,1),n.formatYear),{uid:t.uniqueId+"-"+i});t.title=[e[0].label,e[o-1].label].join(" - "),t.rows=n.split(e,5)},n.compare=function(t,e){return t.getFullYear()-e.getFullYear()},n.handleKeyDown=function(t){var e=n.activeDate.getFullYear();"left"===t?e-=1:"up"===t?e-=5:"right"===t?e+=1:"down"===t?e+=5:"pageup"===t||"pagedown"===t?e+=("pageup"===t?-1:1)*n.step.years:"home"===t?e=r(n.activeDate.getFullYear()):"end"===t&&(e=r(n.activeDate.getFullYear())+o-1),n.activeDate.setFullYear(e)},n.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function(t,e,i,n,r,o,a){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(s,l,c,h){function u(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}function f(t){if(t){if(angular.isDate(t)&&!isNaN(t))return h.$setValidity("date",!0),t;if(angular.isString(t)){var e=o.parse(t,d)||new Date(t);return isNaN(e)?void h.$setValidity("date",!1):(h.$setValidity("date",!0),e)}return void h.$setValidity("date",!1)}return h.$setValidity("date",!0),null}var d,p=angular.isDefined(c.closeOnDateSelection)?s.$parent.$eval(c.closeOnDateSelection):a.closeOnDateSelection,g=angular.isDefined(c.datepickerAppendToBody)?s.$parent.$eval(c.datepickerAppendToBody):a.appendToBody;s.showButtonBar=angular.isDefined(c.showButtonBar)?s.$parent.$eval(c.showButtonBar):a.showButtonBar,s.getText=function(t){return s[t+"Text"]||a[t+"Text"]},c.$observe("datepickerPopup",function(t){d=t||a.datepickerPopup,h.$render()});var v=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");v.attr({"ng-model":"date","ng-change":"dateSelection()"});var m=angular.element(v.children()[0]);c.datepickerOptions&&angular.forEach(s.$parent.$eval(c.datepickerOptions),function(t,e){m.attr(u(e),t)}),s.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(t){if(c[t]){var i=e(c[t]);if(s.$parent.$watch(i,function(e){s.watchData[t]=e}),m.attr(u(t),"watchData."+t),"datepickerMode"===t){var n=i.assign;s.$watch("watchData."+t,function(t,e){t!==e&&n(s.$parent,t)})}}}),c.dateDisabled&&m.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),h.$parsers.unshift(f),s.dateSelection=function(t){angular.isDefined(t)&&(s.date=t),h.$setViewValue(s.date),h.$render(),p&&(s.isOpen=!1,l[0].focus())},l.bind("input change keyup",function(){s.$apply(function(){s.date=h.$modelValue})}),h.$render=function(){var t=h.$viewValue?r(h.$viewValue,d):"";l.val(t),s.date=f(h.$modelValue)};var b=function(t){s.isOpen&&t.target!==l[0]&&s.$apply(function(){s.isOpen=!1})},y=function(t){s.keydown(t)};l.bind("keydown",y),s.keydown=function(t){27===t.which?(t.preventDefault(),t.stopPropagation(),s.close()):40!==t.which||s.isOpen||(s.isOpen=!0)},s.$watch("isOpen",function(t){t?(s.$broadcast("datepicker.focus"),s.position=g?n.offset(l):n.position(l),s.position.top=s.position.top+l.prop("offsetHeight"),i.bind("click",b)):i.unbind("click",b)}),s.select=function(t){if("today"===t){var e=new Date;angular.isDate(h.$modelValue)?(t=new Date(h.$modelValue),t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate())):t=new Date(e.setHours(0,0,0,0))}s.dateSelection(t)},s.close=function(){s.isOpen=!1,l[0].focus()};var x=t(v)(s);v.remove(),g?i.find("body").append(x):l.after(x),s.$on("$destroy",function(){x.remove(),l.unbind("keydown",y),i.unbind("click",b)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(t,e){e.bind("click",function(t){t.preventDefault(),t.stopPropagation()
})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(t){var e=null;this.open=function(r){e||(t.bind("click",i),t.bind("keydown",n)),e&&e!==r&&(e.isOpen=!1),e=r},this.close=function(r){e===r&&(e=null,t.unbind("click",i),t.unbind("keydown",n))};var i=function(t){var i=e.getToggleElement();t&&i&&i[0].contains(t.target)||e.$apply(function(){e.isOpen=!1})},n=function(t){27===t.which&&(e.focusToggleElement(),i())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(t,e,i,n,r,o){var a,s=this,l=t.$new(),c=n.openClass,h=angular.noop,u=e.onToggle?i(e.onToggle):angular.noop;this.init=function(n){s.$element=n,e.isOpen&&(a=i(e.isOpen),h=a.assign,t.$watch(a,function(t){l.isOpen=!!t}))},this.toggle=function(t){return l.isOpen=arguments.length?!!t:!l.isOpen},this.isOpen=function(){return l.isOpen},l.getToggleElement=function(){return s.toggleElement},l.focusToggleElement=function(){s.toggleElement&&s.toggleElement[0].focus()},l.$watch("isOpen",function(e,i){o[e?"addClass":"removeClass"](s.$element,c),e?(l.focusToggleElement(),r.open(l)):r.close(l),h(t,e),angular.isDefined(e)&&e!==i&&u(t,{open:!!e})}),t.$on("$locationChangeSuccess",function(){l.isOpen=!1}),t.$on("$destroy",function(){l.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(t,e,i,n){n.init(e)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(t,e,i,n){if(n){n.toggleElement=e;var r=function(r){r.preventDefault(),e.hasClass("disabled")||i.disabled||t.$apply(function(){n.toggle()})};e.bind("click",r),e.attr({"aria-haspopup":!0,"aria-expanded":!1}),t.$watch(n.isOpen,function(t){e.attr("aria-expanded",!!t)}),t.$on("$destroy",function(){e.unbind("click",r)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var t=[];return{add:function(e,i){t.push({key:e,value:i})},get:function(e){for(var i=0;i<t.length;i++)if(e==t[i].key)return t[i]},keys:function(){for(var e=[],i=0;i<t.length;i++)e.push(t[i].key);return e},top:function(){return t[t.length-1]},remove:function(e){for(var i=-1,n=0;n<t.length;n++)if(e==t[n].key){i=n;break}return t.splice(i,1)[0]},removeTop:function(){return t.splice(t.length-1,1)[0]},length:function(){return t.length}}}}}).directive("modalBackdrop",["$timeout",function(t){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(e,i,n){e.backdropClass=n.backdropClass||"",e.animate=!1,t(function(){e.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function(t,e){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(t,e){return e.templateUrl||"template/modal/window.html"},link:function(i,n,r){n.addClass(r.windowClass||""),i.size=r.size,e(function(){i.animate=!0,n[0].querySelectorAll("[autofocus]").length||n[0].focus()}),i.close=function(e){var i=t.getTop();i&&i.value.backdrop&&"static"!=i.value.backdrop&&e.target===e.currentTarget&&(e.preventDefault(),e.stopPropagation(),t.dismiss(i.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function(t,e,i,n,r){r(t.$parent,function(t){e.empty(),e.append(t)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function(t,e,i,n,r,o){function a(){for(var t=-1,e=d.keys(),i=0;i<e.length;i++)d.get(e[i]).value.backdrop&&(t=i);return t}function s(t){var e=i.find("body").eq(0),n=d.get(t).value;d.remove(t),c(n.modalDomEl,n.modalScope,300,function(){n.modalScope.$destroy(),e.toggleClass(f,d.length()>0),l()})}function l(){if(h&&-1==a()){var t=u;c(h,u,150,function(){t.$destroy(),t=null}),h=void 0,u=void 0}}function c(i,n,r,o){function a(){a.done||(a.done=!0,i.remove(),o&&o())}n.animate=!1;var s=t.transitionEndEventName;if(s){var l=e(a,r);i.bind(s,function(){e.cancel(l),a(),n.$apply()})}else e(a)}var h,u,f="modal-open",d=o.createNew(),p={};return r.$watch(a,function(t){u&&(u.index=t)}),i.bind("keydown",function(t){var e;27===t.which&&(e=d.top(),e&&e.value.keyboard&&(t.preventDefault(),r.$apply(function(){p.dismiss(e.key,"escape key press")})))}),p.open=function(t,e){d.add(t,{deferred:e.deferred,modalScope:e.scope,backdrop:e.backdrop,keyboard:e.keyboard});var o=i.find("body").eq(0),s=a();if(s>=0&&!h){u=r.$new(!0),u.index=s;var l=angular.element("<div modal-backdrop></div>");l.attr("backdrop-class",e.backdropClass),h=n(l)(u),o.append(h)}var c=angular.element("<div modal-window></div>");c.attr({"template-url":e.windowTemplateUrl,"window-class":e.windowClass,size:e.size,index:d.length()-1,animate:"animate"}).html(e.content);var p=n(c)(e.scope);d.top().value.modalDomEl=p,o.append(p),o.addClass(f)},p.close=function(t,e){var i=d.get(t);i&&(i.value.deferred.resolve(e),s(t))},p.dismiss=function(t,e){var i=d.get(t);i&&(i.value.deferred.reject(e),s(t))},p.dismissAll=function(t){for(var e=this.getTop();e;)this.dismiss(e.key,t),e=this.getTop()},p.getTop=function(){return d.top()},p}]).provider("$modal",function(){var t={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(e,i,n,r,o,a,s){function l(t){return t.template?n.when(t.template):r.get(angular.isFunction(t.templateUrl)?t.templateUrl():t.templateUrl,{cache:o}).then(function(t){return t.data})}function c(t){var i=[];return angular.forEach(t,function(t){(angular.isFunction(t)||angular.isArray(t))&&i.push(n.when(e.invoke(t)))}),i}var h={};return h.open=function(e){var r=n.defer(),o=n.defer(),h={result:r.promise,opened:o.promise,close:function(t){s.close(h,t)},dismiss:function(t){s.dismiss(h,t)}};if(e=angular.extend({},t.options,e),e.resolve=e.resolve||{},!e.template&&!e.templateUrl)throw new Error("One of template or templateUrl options is required.");var u=n.all([l(e)].concat(c(e.resolve)));return u.then(function(t){var n=(e.scope||i).$new();n.$close=h.close,n.$dismiss=h.dismiss;var o,l={},c=1;e.controller&&(l.$scope=n,l.$modalInstance=h,angular.forEach(e.resolve,function(e,i){l[i]=t[c++]}),o=a(e.controller,l),e.controllerAs&&(n[e.controllerAs]=o)),s.open(h,{scope:n,deferred:r,content:t[0],backdrop:e.backdrop,keyboard:e.keyboard,backdropClass:e.backdropClass,windowClass:e.windowClass,windowTemplateUrl:e.windowTemplateUrl,size:e.size})},function(t){r.reject(t)}),u.then(function(){o.resolve(!0)},function(){o.reject(!1)}),h},h}]};return t}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function(t,e,i){var n=this,r={$setViewValue:angular.noop},o=e.numPages?i(e.numPages).assign:angular.noop;this.init=function(o,a){r=o,this.config=a,r.$render=function(){n.render()},e.itemsPerPage?t.$parent.$watch(i(e.itemsPerPage),function(e){n.itemsPerPage=parseInt(e,10),t.totalPages=n.calculateTotalPages()}):this.itemsPerPage=a.itemsPerPage},this.calculateTotalPages=function(){var e=this.itemsPerPage<1?1:Math.ceil(t.totalItems/this.itemsPerPage);return Math.max(e||0,1)},this.render=function(){t.page=parseInt(r.$viewValue,10)||1},t.selectPage=function(e){t.page!==e&&e>0&&e<=t.totalPages&&(r.$setViewValue(e),r.$render())},t.getText=function(e){return t[e+"Text"]||n.config[e+"Text"]},t.noPrevious=function(){return 1===t.page},t.noNext=function(){return t.page===t.totalPages},t.$watch("totalItems",function(){t.totalPages=n.calculateTotalPages()}),t.$watch("totalPages",function(e){o(t.$parent,e),t.page>e?t.selectPage(e):r.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function(t,e){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(i,n,r,o){function a(t,e,i){return{number:t,text:e,active:i}}function s(t,e){var i=[],n=1,r=e,o=angular.isDefined(h)&&e>h;o&&(u?(n=Math.max(t-Math.floor(h/2),1),r=n+h-1,r>e&&(r=e,n=r-h+1)):(n=(Math.ceil(t/h)-1)*h+1,r=Math.min(n+h-1,e)));for(var s=n;r>=s;s++){var l=a(s,s,s===t);i.push(l)}if(o&&!u){if(n>1){var c=a(n-1,"...",!1);i.unshift(c)}if(e>r){var f=a(r+1,"...",!1);i.push(f)}}return i}var l=o[0],c=o[1];if(c){var h=angular.isDefined(r.maxSize)?i.$parent.$eval(r.maxSize):e.maxSize,u=angular.isDefined(r.rotate)?i.$parent.$eval(r.rotate):e.rotate;i.boundaryLinks=angular.isDefined(r.boundaryLinks)?i.$parent.$eval(r.boundaryLinks):e.boundaryLinks,i.directionLinks=angular.isDefined(r.directionLinks)?i.$parent.$eval(r.directionLinks):e.directionLinks,l.init(c,e),r.maxSize&&i.$parent.$watch(t(r.maxSize),function(t){h=parseInt(t,10),l.render()});var f=l.render;l.render=function(){f(),i.page>0&&i.page<=i.totalPages&&(i.pages=s(i.page,i.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:" Previous",nextText:"Next ",align:!0}).directive("pager",["pagerConfig",function(t){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(e,i,n,r){var o=r[0],a=r[1];a&&(e.align=angular.isDefined(n.align)?e.$parent.$eval(n.align):t.align,o.init(a,t))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function t(t){var e=/[A-Z]/g,i="-";return t.replace(e,function(t,e){return(e?i:"")+t.toLowerCase()})}var e={placement:"top",animation:!0,popupDelay:0},i={mouseenter:"mouseleave",click:"click",focus:"blur"},n={};this.options=function(t){angular.extend(n,t)},this.setTriggers=function(t){angular.extend(i,t)},this.$get=["$window","$compile","$timeout","$parse","$document","$position","$interpolate",function(r,o,a,s,l,c,h){return function(r,u,f){function d(t){var e=t||p.trigger||f,n=i[e]||e;return{show:e,hide:n}}var p=angular.extend({},e,n),g=t(r),v=h.startSymbol(),m=h.endSymbol(),b="<div "+g+'-popup title="'+v+"tt_title"+m+'" content="'+v+"tt_content"+m+'" placement="'+v+"tt_placement"+m+'" animation="tt_animation" is-open="tt_isOpen"></div>';return{restrict:"EA",scope:!0,compile:function(){var t=o(b);return function(e,i,n){function o(){e.tt_isOpen?f():h()}function h(){(!S||e.$eval(n[u+"Enable"]))&&(e.tt_popupDelay?w||(w=a(g,e.tt_popupDelay,!1),w.then(function(t){t()})):g()())}function f(){e.$apply(function(){v()})}function g(){return w=null,x&&(a.cancel(x),x=null),e.tt_content?(m(),y.css({top:0,left:0,display:"block"}),_?l.find("body").append(y):i.after(y),A(),e.tt_isOpen=!0,e.$digest(),A):angular.noop}function v(){e.tt_isOpen=!1,a.cancel(w),w=null,e.tt_animation?x||(x=a(b,500)):b()}function m(){y&&b(),y=t(e,function(){}),e.$digest()}function b(){x=null,y&&(y.remove(),y=null)}var y,x,w,_=angular.isDefined(p.appendToBody)?p.appendToBody:!1,C=d(void 0),S=angular.isDefined(n[u+"Enable"]),A=function(){var t=c.positionElements(i,y,e.tt_placement,_);t.top+="px",t.left+="px",y.css(t)};e.tt_isOpen=!1,n.$observe(r,function(t){e.tt_content=t,!t&&e.tt_isOpen&&v()}),n.$observe(u+"Title",function(t){e.tt_title=t}),n.$observe(u+"Placement",function(t){e.tt_placement=angular.isDefined(t)?t:p.placement}),n.$observe(u+"PopupDelay",function(t){var i=parseInt(t,10);e.tt_popupDelay=isNaN(i)?p.popupDelay:i});var k=function(){i.unbind(C.show,h),i.unbind(C.hide,f)};n.$observe(u+"Trigger",function(t){k(),C=d(t),C.show===C.hide?i.bind(C.show,o):(i.bind(C.show,h),i.bind(C.hide,f))});var T=e.$eval(n[u+"Animation"]);e.tt_animation=angular.isDefined(T)?!!T:p.animation,n.$observe(u+"AppendToBody",function(t){_=angular.isDefined(t)?s(t)(e):_}),_&&e.$on("$locationChangeSuccess",function(){e.tt_isOpen&&v()}),e.$on("$destroy",function(){a.cancel(x),a.cancel(w),k(),b()})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(t){return t("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function(t){return t("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function(t){return t("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function(t,e,i){var n=this,r=angular.isDefined(e.animate)?t.$parent.$eval(e.animate):i.animate;this.bars=[],t.max=angular.isDefined(e.max)?t.$parent.$eval(e.max):i.max,this.addBar=function(e,i){r||i.css({transition:"none"}),this.bars.push(e),e.$watch("value",function(i){e.percent=+(100*i/t.max).toFixed(2)}),e.$on("$destroy",function(){i=null,n.removeBar(e)})},this.removeBar=function(t){this.bars.splice(this.bars.indexOf(t),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(t,e,i,n){n.addBar(t,e)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(t,e,i,n){n.addBar(t,angular.element(e.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function(t,e,i){var n={$setViewValue:angular.noop};this.init=function(r){n=r,n.$render=this.render,this.stateOn=angular.isDefined(e.stateOn)?t.$parent.$eval(e.stateOn):i.stateOn,this.stateOff=angular.isDefined(e.stateOff)?t.$parent.$eval(e.stateOff):i.stateOff;var o=angular.isDefined(e.ratingStates)?t.$parent.$eval(e.ratingStates):new Array(angular.isDefined(e.max)?t.$parent.$eval(e.max):i.max);t.range=this.buildTemplateObjects(o)},this.buildTemplateObjects=function(t){for(var e=0,i=t.length;i>e;e++)t[e]=angular.extend({index:e},{stateOn:this.stateOn,stateOff:this.stateOff},t[e]);return t},t.rate=function(e){!t.readonly&&e>=0&&e<=t.range.length&&(n.$setViewValue(e),n.$render())},t.enter=function(e){t.readonly||(t.value=e),t.onHover({value:e})},t.reset=function(){t.value=n.$viewValue,t.onLeave()},t.onKeydown=function(e){/(37|38|39|40)/.test(e.which)&&(e.preventDefault(),e.stopPropagation(),t.rate(t.value+(38===e.which||39===e.which?1:-1)))},this.render=function(){t.value=n.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(t,e,i,n){var r=n[0],o=n[1];o&&r.init(o)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function(t){var e=this,i=e.tabs=t.tabs=[];e.select=function(t){angular.forEach(i,function(e){e.active&&e!==t&&(e.active=!1,e.onDeselect())}),t.active=!0,t.onSelect()},e.addTab=function(t){i.push(t),1===i.length?t.active=!0:t.active&&e.select(t)},e.removeTab=function(t){var n=i.indexOf(t);if(t.active&&i.length>1){var r=n==i.length-1?n-1:n+1;e.select(i[r])}i.splice(n,1)}}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(t,e,i){t.vertical=angular.isDefined(i.vertical)?t.$parent.$eval(i.vertical):!1,t.justified=angular.isDefined(i.justified)?t.$parent.$eval(i.justified):!1}}}).directive("tab",["$parse",function(t){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(e,i,n){return function(e,i,r,o){e.$watch("active",function(t){t&&o.select(e)}),e.disabled=!1,r.disabled&&e.$parent.$watch(t(r.disabled),function(t){e.disabled=!!t}),e.select=function(){e.disabled||(e.active=!0)},o.addTab(e),e.$on("$destroy",function(){o.removeTab(e)}),e.$transcludeFn=n}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(t,e){t.$watch("headingElement",function(t){t&&(e.html(""),e.append(t))})}}}]).directive("tabContentTransclude",function(){function t(t){return t.tagName&&(t.hasAttribute("tab-heading")||t.hasAttribute("data-tab-heading")||"tab-heading"===t.tagName.toLowerCase()||"data-tab-heading"===t.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(e,i,n){var r=e.$eval(n.tabContentTransclude);r.$transcludeFn(r.$parent,function(e){angular.forEach(e,function(e){t(e)?r.headingElement=e:i.append(e)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function(t,e,i,n,r,o){function a(){var e=parseInt(t.hours,10),i=t.showMeridian?e>0&&13>e:e>=0&&24>e;return i?(t.showMeridian&&(12===e&&(e=0),t.meridian===g[1]&&(e+=12)),e):void 0}function s(){var e=parseInt(t.minutes,10);return e>=0&&60>e?e:void 0}function l(t){return angular.isDefined(t)&&t.toString().length<2?"0"+t:t}function c(t){h(),p.$setViewValue(new Date(d)),u(t)}function h(){p.$setValidity("time",!0),t.invalidHours=!1,t.invalidMinutes=!1}function u(e){var i=d.getHours(),n=d.getMinutes();t.showMeridian&&(i=0===i||12===i?12:i%12),t.hours="h"===e?i:l(i),t.minutes="m"===e?n:l(n),t.meridian=d.getHours()<12?g[0]:g[1]}function f(t){var e=new Date(d.getTime()+6e4*t);d.setHours(e.getHours(),e.getMinutes()),c()}var d=new Date,p={$setViewValue:angular.noop},g=angular.isDefined(e.meridians)?t.$parent.$eval(e.meridians):o.meridians||r.DATETIME_FORMATS.AMPMS;this.init=function(i,n){p=i,p.$render=this.render;var r=n.eq(0),a=n.eq(1),s=angular.isDefined(e.mousewheel)?t.$parent.$eval(e.mousewheel):o.mousewheel;s&&this.setupMousewheelEvents(r,a),t.readonlyInput=angular.isDefined(e.readonlyInput)?t.$parent.$eval(e.readonlyInput):o.readonlyInput,this.setupInputEvents(r,a)};var v=o.hourStep;e.hourStep&&t.$parent.$watch(i(e.hourStep),function(t){v=parseInt(t,10)});var m=o.minuteStep;e.minuteStep&&t.$parent.$watch(i(e.minuteStep),function(t){m=parseInt(t,10)}),t.showMeridian=o.showMeridian,e.showMeridian&&t.$parent.$watch(i(e.showMeridian),function(e){if(t.showMeridian=!!e,p.$error.time){var i=a(),n=s();angular.isDefined(i)&&angular.isDefined(n)&&(d.setHours(i),c())}else u()}),this.setupMousewheelEvents=function(e,i){var n=function(t){t.originalEvent&&(t=t.originalEvent);var e=t.wheelDelta?t.wheelDelta:-t.deltaY;return t.detail||e>0};e.bind("mousewheel wheel",function(e){t.$apply(n(e)?t.incrementHours():t.decrementHours()),e.preventDefault()}),i.bind("mousewheel wheel",function(e){t.$apply(n(e)?t.incrementMinutes():t.decrementMinutes()),e.preventDefault()})},this.setupInputEvents=function(e,i){if(t.readonlyInput)return t.updateHours=angular.noop,void(t.updateMinutes=angular.noop);var n=function(e,i){p.$setViewValue(null),p.$setValidity("time",!1),angular.isDefined(e)&&(t.invalidHours=e),angular.isDefined(i)&&(t.invalidMinutes=i)};t.updateHours=function(){var t=a();angular.isDefined(t)?(d.setHours(t),c("h")):n(!0)},e.bind("blur",function(){!t.invalidHours&&t.hours<10&&t.$apply(function(){t.hours=l(t.hours)})}),t.updateMinutes=function(){var t=s();angular.isDefined(t)?(d.setMinutes(t),c("m")):n(void 0,!0)},i.bind("blur",function(){!t.invalidMinutes&&t.minutes<10&&t.$apply(function(){t.minutes=l(t.minutes)})})},this.render=function(){var t=p.$modelValue?new Date(p.$modelValue):null;isNaN(t)?(p.$setValidity("time",!1),n.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(t&&(d=t),h(),u())},t.incrementHours=function(){f(60*v)},t.decrementHours=function(){f(60*-v)},t.incrementMinutes=function(){f(m)},t.decrementMinutes=function(){f(-m)},t.toggleMeridian=function(){f(720*(d.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(t,e,i,n){var r=n[0],o=n[1];o&&r.init(o,e.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function(t){var e=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(i){var n=i.match(e);if(!n)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+i+'".');return{itemName:n[3],source:t(n[4]),viewMapper:t(n[2]||n[1]),modelMapper:t(n[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(t,e,i,n,r,o,a){var s=[9,13,27,38,40];return{require:"ngModel",link:function(l,c,h,u){var f,d=l.$eval(h.typeaheadMinLength)||1,p=l.$eval(h.typeaheadWaitMs)||0,g=l.$eval(h.typeaheadEditable)!==!1,v=e(h.typeaheadLoading).assign||angular.noop,m=e(h.typeaheadOnSelect),b=h.typeaheadInputFormatter?e(h.typeaheadInputFormatter):void 0,y=h.typeaheadAppendToBody?l.$eval(h.typeaheadAppendToBody):!1,x=e(h.ngModel).assign,w=a.parse(h.typeahead),_=l.$new();l.$on("$destroy",function(){_.$destroy()});var C="typeahead-"+_.$id+"-"+Math.floor(1e4*Math.random());c.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":C});var S=angular.element("<div typeahead-popup></div>");S.attr({id:C,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(h.typeaheadTemplateUrl)&&S.attr("template-url",h.typeaheadTemplateUrl);var A=function(){_.matches=[],_.activeIdx=-1,c.attr("aria-expanded",!1)},k=function(t){return C+"-option-"+t};_.$watch("activeIdx",function(t){0>t?c.removeAttr("aria-activedescendant"):c.attr("aria-activedescendant",k(t))});var T=function(t){var e={$viewValue:t};v(l,!0),i.when(w.source(l,e)).then(function(i){var n=t===u.$viewValue;if(n&&f)if(i.length>0){_.activeIdx=0,_.matches.length=0;for(var r=0;r<i.length;r++)e[w.itemName]=i[r],_.matches.push({id:k(r),label:w.viewMapper(_,e),model:i[r]});_.query=t,_.position=y?o.offset(c):o.position(c),_.position.top=_.position.top+c.prop("offsetHeight"),c.attr("aria-expanded",!0)}else A();n&&v(l,!1)},function(){A(),v(l,!1)})};A(),_.query=void 0;var O,$=function(t){O=n(function(){T(t)},p)},D=function(){O&&n.cancel(O)};u.$parsers.unshift(function(t){return f=!0,t&&t.length>=d?p>0?(D(),$(t)):T(t):(v(l,!1),D(),A()),g?t:t?void u.$setValidity("editable",!1):(u.$setValidity("editable",!0),t)}),u.$formatters.push(function(t){var e,i,n={};return b?(n.$model=t,b(l,n)):(n[w.itemName]=t,e=w.viewMapper(l,n),n[w.itemName]=void 0,i=w.viewMapper(l,n),e!==i?e:t)}),_.select=function(t){var e,i,r={};r[w.itemName]=i=_.matches[t].model,e=w.modelMapper(l,r),x(l,e),u.$setValidity("editable",!0),m(l,{$item:i,$model:e,$label:w.viewMapper(l,r)}),A(),n(function(){c[0].focus()},0,!1)},c.bind("keydown",function(t){0!==_.matches.length&&-1!==s.indexOf(t.which)&&(t.preventDefault(),40===t.which?(_.activeIdx=(_.activeIdx+1)%_.matches.length,_.$digest()):38===t.which?(_.activeIdx=(_.activeIdx?_.activeIdx:_.matches.length)-1,_.$digest()):13===t.which||9===t.which?_.$apply(function(){_.select(_.activeIdx)}):27===t.which&&(t.stopPropagation(),A(),_.$digest()))}),c.bind("blur",function(){f=!1});var M=function(t){c[0]!==t.target&&(A(),_.$digest())};r.bind("click",M),l.$on("$destroy",function(){r.unbind("click",M)});var E=t(S)(_);y?r.find("body").append(E):c.after(E)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(t,e,i){t.templateUrl=i.templateUrl,t.isOpen=function(){return t.matches.length>0},t.isActive=function(e){return t.active==e},t.selectActive=function(e){t.active=e},t.selectMatch=function(e){t.select({activeIdx:e})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function(t,e,i,n){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(r,o,a){var s=n(a.templateUrl)(r.$parent)||"template/typeahead/typeahead-match.html";t.get(s,{cache:e}).success(function(t){o.replaceWith(i(t.trim())(r))})}}}]).filter("typeaheadHighlight",function(){function t(t){return t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(e,i){return i?(""+e).replace(new RegExp(t(i),"gi"),"<strong>$&</strong>"):e}}),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.position","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/alert/alert.html","template/carousel/carousel.html","template/carousel/slide.html","template/datepicker/datepicker.html","template/datepicker/day.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/modal/backdrop.html","template/modal/window.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/popover/popover.html","template/progressbar/bar.html","template/progressbar/progress.html","template/progressbar/progressbar.html","template/rating/rating.html","template/tabs/tab.html","template/tabs/tabset.html","template/timepicker/timepicker.html","template/typeahead/typeahead-match.html","template/typeahead/typeahead-popup.html"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(t,e,i){function n(t){for(var e in t)if(void 0!==o.style[e])return t[e]}var r=function(n,o,a){a=a||{};var s=t.defer(),l=r[a.animation?"animationEndEventName":"transitionEndEventName"],c=function(){i.$apply(function(){n.unbind(l,c),s.resolve(n)})};return l&&n.bind(l,c),e(function(){angular.isString(o)?n.addClass(o):angular.isFunction(o)?o(n):angular.isObject(o)&&n.css(o),l||s.resolve(n)}),s.promise.cancel=function(){l&&n.unbind(l,c),s.reject("Transition cancelled")},s.promise},o=document.createElement("trans"),a={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},s={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return r.transitionEndEventName=n(a),r.animationEndEventName=n(s),r}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(t){return{link:function(e,i,n){function r(e){function n(){c===r&&(c=void 0)}var r=t(i,e);return c&&c.cancel(),c=r,r.then(n,n),r}function o(){h?(h=!1,a()):(i.removeClass("collapse").addClass("collapsing"),r({height:i[0].scrollHeight+"px"}).then(a))}function a(){i.removeClass("collapsing"),i.addClass("collapse in"),i.css({height:"auto"})}function s(){if(h)h=!1,l(),i.css({height:0});else{i.css({height:i[0].scrollHeight+"px"});{i[0].offsetWidth}i.removeClass("collapse in").addClass("collapsing"),r({height:0}).then(l)}}function l(){i.removeClass("collapsing"),i.addClass("collapse")}var c,h=!0;e.$watch(n.collapse,function(t){t?s():o()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(t,e,i){this.groups=[],this.closeOthers=function(n){var r=angular.isDefined(e.closeOthers)?t.$eval(e.closeOthers):i.closeOthers;r&&angular.forEach(this.groups,function(t){t!==n&&(t.isOpen=!1)})},this.addGroup=function(t){var e=this;this.groups.push(t),t.$on("$destroy",function(){e.removeGroup(t)})},this.removeGroup=function(t){var e=this.groups.indexOf(t);-1!==e&&this.groups.splice(e,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(t){this.heading=t}},link:function(t,e,i,n){n.addGroup(t),t.$watch("isOpen",function(e){e&&n.closeOthers(t)}),t.toggleOpen=function(){t.isDisabled||(t.isOpen=!t.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(t,e,i,n,r){n.setHeading(r(t,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(t,e,i,n){t.$watch(function(){return n[i.accordionTransclude]},function(t){t&&(e.html(""),e.append(t))})}}}),angular.module("ui.bootstrap.alert",[]).controller("AlertController",["$scope","$attrs",function(t,e){t.closeable="close"in e}]).directive("alert",function(){return{restrict:"EA",controller:"AlertController",templateUrl:"template/alert/alert.html",transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(t,e,i){e.addClass("ng-binding").data("$binding",i.bindHtmlUnsafe),t.$watch(i.bindHtmlUnsafe,function(t){e.html(t||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(t){this.activeClass=t.activeClass||"active",this.toggleEvent=t.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(t,e,i,n){var r=n[0],o=n[1];o.$render=function(){e.toggleClass(r.activeClass,angular.equals(o.$modelValue,t.$eval(i.btnRadio)))},e.bind(r.toggleEvent,function(){var n=e.hasClass(r.activeClass);(!n||angular.isDefined(i.uncheckable))&&t.$apply(function(){o.$setViewValue(n?null:t.$eval(i.btnRadio)),o.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(t,e,i,n){function r(){return a(i.btnCheckboxTrue,!0)}function o(){return a(i.btnCheckboxFalse,!1)}function a(e,i){var n=t.$eval(e);return angular.isDefined(n)?n:i}var s=n[0],l=n[1];l.$render=function(){e.toggleClass(s.activeClass,angular.equals(l.$modelValue,r()))},e.bind(s.toggleEvent,function(){t.$apply(function(){l.$setViewValue(e.hasClass(s.activeClass)?o():r()),l.$render()
})})}}}),angular.module("ui.bootstrap.carousel",["ui.bootstrap.transition"]).controller("CarouselController",["$scope","$timeout","$transition",function(t,e,i){function n(){r();var i=+t.interval;!isNaN(i)&&i>=0&&(a=e(o,i))}function r(){a&&(e.cancel(a),a=null)}function o(){s?(t.next(),n()):t.pause()}var a,s,l=this,c=l.slides=t.slides=[],h=-1;l.currentSlide=null;var u=!1;l.select=t.select=function(r,o){function a(){if(!u){if(l.currentSlide&&angular.isString(o)&&!t.noTransition&&r.$element){r.$element.addClass(o);{r.$element[0].offsetWidth}angular.forEach(c,function(t){angular.extend(t,{direction:"",entering:!1,leaving:!1,active:!1})}),angular.extend(r,{direction:o,active:!0,entering:!0}),angular.extend(l.currentSlide||{},{direction:o,leaving:!0}),t.$currentTransition=i(r.$element,{}),function(e,i){t.$currentTransition.then(function(){s(e,i)},function(){s(e,i)})}(r,l.currentSlide)}else s(r,l.currentSlide);l.currentSlide=r,h=f,n()}}function s(e,i){angular.extend(e,{direction:"",active:!0,leaving:!1,entering:!1}),angular.extend(i||{},{direction:"",active:!1,leaving:!1,entering:!1}),t.$currentTransition=null}var f=c.indexOf(r);void 0===o&&(o=f>h?"next":"prev"),r&&r!==l.currentSlide&&(t.$currentTransition?(t.$currentTransition.cancel(),e(a)):a())},t.$on("$destroy",function(){u=!0}),l.indexOfSlide=function(t){return c.indexOf(t)},t.next=function(){var e=(h+1)%c.length;return t.$currentTransition?void 0:l.select(c[e],"next")},t.prev=function(){var e=0>h-1?c.length-1:h-1;return t.$currentTransition?void 0:l.select(c[e],"prev")},t.isActive=function(t){return l.currentSlide===t},t.$watch("interval",n),t.$on("$destroy",r),t.play=function(){s||(s=!0,n())},t.pause=function(){t.noPause||(s=!1,r())},l.addSlide=function(e,i){e.$element=i,c.push(e),1===c.length||e.active?(l.select(c[c.length-1]),1==c.length&&t.play()):e.active=!1},l.removeSlide=function(t){var e=c.indexOf(t);c.splice(e,1),c.length>0&&t.active?l.select(e>=c.length?c[e-1]:c[e]):h>e&&h--}}]).directive("carousel",[function(){return{restrict:"EA",transclude:!0,replace:!0,controller:"CarouselController",require:"carousel",templateUrl:"template/carousel/carousel.html",scope:{interval:"=",noTransition:"=",noPause:"="}}}]).directive("slide",function(){return{require:"^carousel",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/carousel/slide.html",scope:{active:"=?"},link:function(t,e,i,n){n.addSlide(t,e),t.$on("$destroy",function(){n.removeSlide(t)}),t.$watch("active",function(e){e&&n.select(t)})}}}),angular.module("ui.bootstrap.dateparser",[]).service("dateParser",["$locale","orderByFilter",function(t,e){function i(t){var i=[],n=t.split("");return angular.forEach(r,function(e,r){var o=t.indexOf(r);if(o>-1){t=t.split(""),n[o]="("+e.regex+")",t[o]="$";for(var a=o+1,s=o+r.length;s>a;a++)n[a]="",t[a]="$";t=t.join(""),i.push({index:o,apply:e.apply})}}),{regex:new RegExp("^"+n.join("")+"$"),map:e(i,"index")}}function n(t,e,i){return 1===e&&i>28?29===i&&(t%4===0&&t%100!==0||t%400===0):3===e||5===e||8===e||10===e?31>i:!0}this.parsers={};var r={yyyy:{regex:"\\d{4}",apply:function(t){this.year=+t}},yy:{regex:"\\d{2}",apply:function(t){this.year=+t+2e3}},y:{regex:"\\d{1,4}",apply:function(t){this.year=+t}},MMMM:{regex:t.DATETIME_FORMATS.MONTH.join("|"),apply:function(e){this.month=t.DATETIME_FORMATS.MONTH.indexOf(e)}},MMM:{regex:t.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(e){this.month=t.DATETIME_FORMATS.SHORTMONTH.indexOf(e)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(t){this.month=t-1}},M:{regex:"[1-9]|1[0-2]",apply:function(t){this.month=t-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(t){this.date=+t}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(t){this.date=+t}},EEEE:{regex:t.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:t.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(e,r){if(!angular.isString(e)||!r)return e;r=t.DATETIME_FORMATS[r]||r,this.parsers[r]||(this.parsers[r]=i(r));var o=this.parsers[r],a=o.regex,s=o.map,l=e.match(a);if(l&&l.length){for(var c,h={year:1900,month:0,date:1,hours:0},u=1,f=l.length;f>u;u++){var d=s[u-1];d.apply&&d.apply.call(h,l[u])}return n(h.year,h.month,h.date)&&(c=new Date(h.year,h.month,h.date,h.hours)),c}}}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(t,e){function i(t,i){return t.currentStyle?t.currentStyle[i]:e.getComputedStyle?e.getComputedStyle(t)[i]:t.style[i]}function n(t){return"static"===(i(t,"position")||"static")}var r=function(e){for(var i=t[0],r=e.offsetParent||i;r&&r!==i&&n(r);)r=r.offsetParent;return r||i};return{position:function(e){var i=this.offset(e),n={top:0,left:0},o=r(e[0]);o!=t[0]&&(n=this.offset(angular.element(o)),n.top+=o.clientTop-o.scrollTop,n.left+=o.clientLeft-o.scrollLeft);var a=e[0].getBoundingClientRect();return{width:a.width||e.prop("offsetWidth"),height:a.height||e.prop("offsetHeight"),top:i.top-n.top,left:i.left-n.left}},offset:function(i){var n=i[0].getBoundingClientRect();return{width:n.width||i.prop("offsetWidth"),height:n.height||i.prop("offsetHeight"),top:n.top+(e.pageYOffset||t[0].documentElement.scrollTop),left:n.left+(e.pageXOffset||t[0].documentElement.scrollLeft)}},positionElements:function(t,e,i,n){var r,o,a,s,l=i.split("-"),c=l[0],h=l[1]||"center";r=n?this.offset(t):this.position(t),o=e.prop("offsetWidth"),a=e.prop("offsetHeight");var u={center:function(){return r.left+r.width/2-o/2},left:function(){return r.left},right:function(){return r.left+r.width}},f={center:function(){return r.top+r.height/2-a/2},top:function(){return r.top},bottom:function(){return r.top+r.height}};switch(c){case"right":s={top:f[h](),left:u[c]()};break;case"left":s={top:f[h](),left:r.left-o};break;case"bottom":s={top:f[c](),left:u[h]()};break;default:s={top:r.top-a,left:u[h]()}}return s}}}]),angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).constant("datepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null}).controller("DatepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig",function(t,e,i,n,r,o,a,s){var l=this,c={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange"],function(i,r){l[i]=angular.isDefined(e[i])?8>r?n(e[i])(t.$parent):t.$parent.$eval(e[i]):s[i]}),angular.forEach(["minDate","maxDate"],function(n){e[n]?t.$parent.$watch(i(e[n]),function(t){l[n]=t?new Date(t):null,l.refreshView()}):l[n]=s[n]?new Date(s[n]):null}),t.datepickerMode=t.datepickerMode||s.datepickerMode,t.uniqueId="datepicker-"+t.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined(e.initDate)?t.$parent.$eval(e.initDate):new Date,t.isActive=function(e){return 0===l.compare(e.date,l.activeDate)?(t.activeDateId=e.uid,!0):!1},this.init=function(t){c=t,c.$render=function(){l.render()}},this.render=function(){if(c.$modelValue){var t=new Date(c.$modelValue),e=!isNaN(t);e?this.activeDate=t:o.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),c.$setValidity("date",e)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var t=c.$modelValue?new Date(c.$modelValue):null;c.$setValidity("date-disabled",!t||this.element&&!this.isDisabled(t))}},this.createDateObject=function(t,e){var i=c.$modelValue?new Date(c.$modelValue):null;return{date:t,label:a(t,e),selected:i&&0===this.compare(t,i),disabled:this.isDisabled(t),current:0===this.compare(t,new Date)}},this.isDisabled=function(i){return this.minDate&&this.compare(i,this.minDate)<0||this.maxDate&&this.compare(i,this.maxDate)>0||e.dateDisabled&&t.dateDisabled({date:i,mode:t.datepickerMode})},this.split=function(t,e){for(var i=[];t.length>0;)i.push(t.splice(0,e));return i},t.select=function(e){if(t.datepickerMode===l.minMode){var i=c.$modelValue?new Date(c.$modelValue):new Date(0,0,0,0,0,0,0);i.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),c.$setViewValue(i),c.$render()}else l.activeDate=e,t.datepickerMode=l.modes[l.modes.indexOf(t.datepickerMode)-1]},t.move=function(t){var e=l.activeDate.getFullYear()+t*(l.step.years||0),i=l.activeDate.getMonth()+t*(l.step.months||0);l.activeDate.setFullYear(e,i,1),l.refreshView()},t.toggleMode=function(e){e=e||1,t.datepickerMode===l.maxMode&&1===e||t.datepickerMode===l.minMode&&-1===e||(t.datepickerMode=l.modes[l.modes.indexOf(t.datepickerMode)+e])},t.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var h=function(){r(function(){l.element[0].focus()},0,!1)};t.$on("datepicker.focus",h),t.keydown=function(e){var i=t.keys[e.which];if(i&&!e.shiftKey&&!e.altKey)if(e.preventDefault(),e.stopPropagation(),"enter"===i||"space"===i){if(l.isDisabled(l.activeDate))return;t.select(l.activeDate),h()}else!e.ctrlKey||"up"!==i&&"down"!==i?(l.handleKeyDown(i,e),l.refreshView()):(t.toggleMode("up"===i?1:-1),h())}}]).directive("datepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",dateDisabled:"&"},require:["datepicker","?^ngModel"],controller:"DatepickerController",link:function(t,e,i,n){var r=n[0],o=n[1];o&&r.init(o)}}}).directive("daypicker",["dateFilter",function(t){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^datepicker",link:function(e,i,n,r){function o(t,e){return 1!==e||t%4!==0||t%100===0&&t%400!==0?l[e]:29}function a(t,e){var i=new Array(e),n=new Date(t),r=0;for(n.setHours(12);e>r;)i[r++]=new Date(n),n.setDate(n.getDate()+1);return i}function s(t){var e=new Date(t);e.setDate(e.getDate()+4-(e.getDay()||7));var i=e.getTime();return e.setMonth(0),e.setDate(1),Math.floor(Math.round((i-e)/864e5)/7)+1}e.showWeeks=r.showWeeks,r.step={months:1},r.element=i;var l=[31,28,31,30,31,30,31,31,30,31,30,31];r._refreshView=function(){var i=r.activeDate.getFullYear(),n=r.activeDate.getMonth(),o=new Date(i,n,1),l=r.startingDay-o.getDay(),c=l>0?7-l:-l,h=new Date(o);c>0&&h.setDate(-c+1);for(var u=a(h,42),f=0;42>f;f++)u[f]=angular.extend(r.createDateObject(u[f],r.formatDay),{secondary:u[f].getMonth()!==n,uid:e.uniqueId+"-"+f});e.labels=new Array(7);for(var d=0;7>d;d++)e.labels[d]={abbr:t(u[d].date,r.formatDayHeader),full:t(u[d].date,"EEEE")};if(e.title=t(r.activeDate,r.formatDayTitle),e.rows=r.split(u,7),e.showWeeks){e.weekNumbers=[];for(var p=s(e.rows[0][0].date),g=e.rows.length;e.weekNumbers.push(p++)<g;);}},r.compare=function(t,e){return new Date(t.getFullYear(),t.getMonth(),t.getDate())-new Date(e.getFullYear(),e.getMonth(),e.getDate())},r.handleKeyDown=function(t){var e=r.activeDate.getDate();if("left"===t)e-=1;else if("up"===t)e-=7;else if("right"===t)e+=1;else if("down"===t)e+=7;else if("pageup"===t||"pagedown"===t){var i=r.activeDate.getMonth()+("pageup"===t?-1:1);r.activeDate.setMonth(i,1),e=Math.min(o(r.activeDate.getFullYear(),r.activeDate.getMonth()),e)}else"home"===t?e=1:"end"===t&&(e=o(r.activeDate.getFullYear(),r.activeDate.getMonth()));r.activeDate.setDate(e)},r.refreshView()}}}]).directive("monthpicker",["dateFilter",function(t){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^datepicker",link:function(e,i,n,r){r.step={years:1},r.element=i,r._refreshView=function(){for(var i=new Array(12),n=r.activeDate.getFullYear(),o=0;12>o;o++)i[o]=angular.extend(r.createDateObject(new Date(n,o,1),r.formatMonth),{uid:e.uniqueId+"-"+o});e.title=t(r.activeDate,r.formatMonthTitle),e.rows=r.split(i,3)},r.compare=function(t,e){return new Date(t.getFullYear(),t.getMonth())-new Date(e.getFullYear(),e.getMonth())},r.handleKeyDown=function(t){var e=r.activeDate.getMonth();if("left"===t)e-=1;else if("up"===t)e-=3;else if("right"===t)e+=1;else if("down"===t)e+=3;else if("pageup"===t||"pagedown"===t){var i=r.activeDate.getFullYear()+("pageup"===t?-1:1);r.activeDate.setFullYear(i)}else"home"===t?e=0:"end"===t&&(e=11);r.activeDate.setMonth(e)},r.refreshView()}}}]).directive("yearpicker",["dateFilter",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^datepicker",link:function(t,e,i,n){function r(t){return parseInt((t-1)/o,10)*o+1}var o=n.yearRange;n.step={years:o},n.element=e,n._refreshView=function(){for(var e=new Array(o),i=0,a=r(n.activeDate.getFullYear());o>i;i++)e[i]=angular.extend(n.createDateObject(new Date(a+i,0,1),n.formatYear),{uid:t.uniqueId+"-"+i});t.title=[e[0].label,e[o-1].label].join(" - "),t.rows=n.split(e,5)},n.compare=function(t,e){return t.getFullYear()-e.getFullYear()},n.handleKeyDown=function(t){var e=n.activeDate.getFullYear();"left"===t?e-=1:"up"===t?e-=5:"right"===t?e+=1:"down"===t?e+=5:"pageup"===t||"pagedown"===t?e+=("pageup"===t?-1:1)*n.step.years:"home"===t?e=r(n.activeDate.getFullYear()):"end"===t&&(e=r(n.activeDate.getFullYear())+o-1),n.activeDate.setFullYear(e)},n.refreshView()}}}]).constant("datepickerPopupConfig",{datepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",closeOnDateSelection:!0,appendToBody:!1,showButtonBar:!0}).directive("datepickerPopup",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function(t,e,i,n,r,o,a){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(s,l,c,h){function u(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}function f(t){if(t){if(angular.isDate(t)&&!isNaN(t))return h.$setValidity("date",!0),t;if(angular.isString(t)){var e=o.parse(t,d)||new Date(t);return isNaN(e)?void h.$setValidity("date",!1):(h.$setValidity("date",!0),e)}return void h.$setValidity("date",!1)}return h.$setValidity("date",!0),null}var d,p=angular.isDefined(c.closeOnDateSelection)?s.$parent.$eval(c.closeOnDateSelection):a.closeOnDateSelection,g=angular.isDefined(c.datepickerAppendToBody)?s.$parent.$eval(c.datepickerAppendToBody):a.appendToBody;s.showButtonBar=angular.isDefined(c.showButtonBar)?s.$parent.$eval(c.showButtonBar):a.showButtonBar,s.getText=function(t){return s[t+"Text"]||a[t+"Text"]},c.$observe("datepickerPopup",function(t){d=t||a.datepickerPopup,h.$render()});var v=angular.element("<div datepicker-popup-wrap><div datepicker></div></div>");v.attr({"ng-model":"date","ng-change":"dateSelection()"});var m=angular.element(v.children()[0]);c.datepickerOptions&&angular.forEach(s.$parent.$eval(c.datepickerOptions),function(t,e){m.attr(u(e),t)}),s.watchData={},angular.forEach(["minDate","maxDate","datepickerMode"],function(t){if(c[t]){var i=e(c[t]);if(s.$parent.$watch(i,function(e){s.watchData[t]=e}),m.attr(u(t),"watchData."+t),"datepickerMode"===t){var n=i.assign;s.$watch("watchData."+t,function(t,e){t!==e&&n(s.$parent,t)})}}}),c.dateDisabled&&m.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),h.$parsers.unshift(f),s.dateSelection=function(t){angular.isDefined(t)&&(s.date=t),h.$setViewValue(s.date),h.$render(),p&&(s.isOpen=!1,l[0].focus())},l.bind("input change keyup",function(){s.$apply(function(){s.date=h.$modelValue})}),h.$render=function(){var t=h.$viewValue?r(h.$viewValue,d):"";l.val(t),s.date=f(h.$modelValue)};var b=function(t){s.isOpen&&t.target!==l[0]&&s.$apply(function(){s.isOpen=!1})},y=function(t){s.keydown(t)};l.bind("keydown",y),s.keydown=function(t){27===t.which?(t.preventDefault(),t.stopPropagation(),s.close()):40!==t.which||s.isOpen||(s.isOpen=!0)},s.$watch("isOpen",function(t){t?(s.$broadcast("datepicker.focus"),s.position=g?n.offset(l):n.position(l),s.position.top=s.position.top+l.prop("offsetHeight"),i.bind("click",b)):i.unbind("click",b)}),s.select=function(t){if("today"===t){var e=new Date;angular.isDate(h.$modelValue)?(t=new Date(h.$modelValue),t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate())):t=new Date(e.setHours(0,0,0,0))}s.dateSelection(t)},s.close=function(){s.isOpen=!1,l[0].focus()};var x=t(v)(s);v.remove(),g?i.find("body").append(x):l.after(x),s.$on("$destroy",function(){x.remove(),l.unbind("keydown",y),i.unbind("click",b)})}}}]).directive("datepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(t,e){e.bind("click",function(t){t.preventDefault(),t.stopPropagation()})}}}),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(t){var e=null;this.open=function(r){e||(t.bind("click",i),t.bind("keydown",n)),e&&e!==r&&(e.isOpen=!1),e=r},this.close=function(r){e===r&&(e=null,t.unbind("click",i),t.unbind("keydown",n))};var i=function(t){var i=e.getToggleElement();t&&i&&i[0].contains(t.target)||e.$apply(function(){e.isOpen=!1})},n=function(t){27===t.which&&(e.focusToggleElement(),i())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(t,e,i,n,r,o){var a,s=this,l=t.$new(),c=n.openClass,h=angular.noop,u=e.onToggle?i(e.onToggle):angular.noop;this.init=function(n){s.$element=n,e.isOpen&&(a=i(e.isOpen),h=a.assign,t.$watch(a,function(t){l.isOpen=!!t}))},this.toggle=function(t){return l.isOpen=arguments.length?!!t:!l.isOpen},this.isOpen=function(){return l.isOpen},l.getToggleElement=function(){return s.toggleElement},l.focusToggleElement=function(){s.toggleElement&&s.toggleElement[0].focus()},l.$watch("isOpen",function(e,i){o[e?"addClass":"removeClass"](s.$element,c),e?(l.focusToggleElement(),r.open(l)):r.close(l),h(t,e),angular.isDefined(e)&&e!==i&&u(t,{open:!!e})}),t.$on("$locationChangeSuccess",function(){l.isOpen=!1}),t.$on("$destroy",function(){l.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(t,e,i,n){n.init(e)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(t,e,i,n){if(n){n.toggleElement=e;var r=function(r){r.preventDefault(),e.hasClass("disabled")||i.disabled||t.$apply(function(){n.toggle()})};e.bind("click",r),e.attr({"aria-haspopup":!0,"aria-expanded":!1}),t.$watch(n.isOpen,function(t){e.attr("aria-expanded",!!t)}),t.$on("$destroy",function(){e.unbind("click",r)})}}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var t=[];return{add:function(e,i){t.push({key:e,value:i})},get:function(e){for(var i=0;i<t.length;i++)if(e==t[i].key)return t[i]},keys:function(){for(var e=[],i=0;i<t.length;i++)e.push(t[i].key);return e},top:function(){return t[t.length-1]},remove:function(e){for(var i=-1,n=0;n<t.length;n++)if(e==t[n].key){i=n;break}return t.splice(i,1)[0]},removeTop:function(){return t.splice(t.length-1,1)[0]},length:function(){return t.length}}}}}).directive("modalBackdrop",["$timeout",function(t){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(e,i,n){e.backdropClass=n.backdropClass||"",e.animate=!1,t(function(){e.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function(t,e){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(t,e){return e.templateUrl||"template/modal/window.html"},link:function(i,n,r){n.addClass(r.windowClass||""),i.size=r.size,e(function(){i.animate=!0,n[0].querySelectorAll("[autofocus]").length||n[0].focus()}),i.close=function(e){var i=t.getTop();i&&i.value.backdrop&&"static"!=i.value.backdrop&&e.target===e.currentTarget&&(e.preventDefault(),e.stopPropagation(),t.dismiss(i.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function(t,e,i,n,r){r(t.$parent,function(t){e.empty(),e.append(t)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function(t,e,i,n,r,o){function a(){for(var t=-1,e=d.keys(),i=0;i<e.length;i++)d.get(e[i]).value.backdrop&&(t=i);return t}function s(t){var e=i.find("body").eq(0),n=d.get(t).value;d.remove(t),c(n.modalDomEl,n.modalScope,300,function(){n.modalScope.$destroy(),e.toggleClass(f,d.length()>0),l()})}function l(){if(h&&-1==a()){var t=u;c(h,u,150,function(){t.$destroy(),t=null}),h=void 0,u=void 0}}function c(i,n,r,o){function a(){a.done||(a.done=!0,i.remove(),o&&o())}n.animate=!1;var s=t.transitionEndEventName;if(s){var l=e(a,r);i.bind(s,function(){e.cancel(l),a(),n.$apply()})}else e(a)}var h,u,f="modal-open",d=o.createNew(),p={};return r.$watch(a,function(t){u&&(u.index=t)}),i.bind("keydown",function(t){var e;27===t.which&&(e=d.top(),e&&e.value.keyboard&&(t.preventDefault(),r.$apply(function(){p.dismiss(e.key,"escape key press")})))}),p.open=function(t,e){d.add(t,{deferred:e.deferred,modalScope:e.scope,backdrop:e.backdrop,keyboard:e.keyboard});var o=i.find("body").eq(0),s=a();if(s>=0&&!h){u=r.$new(!0),u.index=s;var l=angular.element("<div modal-backdrop></div>");l.attr("backdrop-class",e.backdropClass),h=n(l)(u),o.append(h)}var c=angular.element("<div modal-window></div>");c.attr({"template-url":e.windowTemplateUrl,"window-class":e.windowClass,size:e.size,index:d.length()-1,animate:"animate"}).html(e.content);var p=n(c)(e.scope);d.top().value.modalDomEl=p,o.append(p),o.addClass(f)},p.close=function(t,e){var i=d.get(t);i&&(i.value.deferred.resolve(e),s(t))},p.dismiss=function(t,e){var i=d.get(t);i&&(i.value.deferred.reject(e),s(t))},p.dismissAll=function(t){for(var e=this.getTop();e;)this.dismiss(e.key,t),e=this.getTop()},p.getTop=function(){return d.top()},p}]).provider("$modal",function(){var t={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(e,i,n,r,o,a,s){function l(t){return t.template?n.when(t.template):r.get(angular.isFunction(t.templateUrl)?t.templateUrl():t.templateUrl,{cache:o}).then(function(t){return t.data})}function c(t){var i=[];return angular.forEach(t,function(t){(angular.isFunction(t)||angular.isArray(t))&&i.push(n.when(e.invoke(t)))}),i}var h={};return h.open=function(e){var r=n.defer(),o=n.defer(),h={result:r.promise,opened:o.promise,close:function(t){s.close(h,t)},dismiss:function(t){s.dismiss(h,t)}};if(e=angular.extend({},t.options,e),e.resolve=e.resolve||{},!e.template&&!e.templateUrl)throw new Error("One of template or templateUrl options is required.");var u=n.all([l(e)].concat(c(e.resolve)));return u.then(function(t){var n=(e.scope||i).$new();n.$close=h.close,n.$dismiss=h.dismiss;var o,l={},c=1;e.controller&&(l.$scope=n,l.$modalInstance=h,angular.forEach(e.resolve,function(e,i){l[i]=t[c++]}),o=a(e.controller,l),e.controllerAs&&(n[e.controllerAs]=o)),s.open(h,{scope:n,deferred:r,content:t[0],backdrop:e.backdrop,keyboard:e.keyboard,backdropClass:e.backdropClass,windowClass:e.windowClass,windowTemplateUrl:e.windowTemplateUrl,size:e.size})},function(t){r.reject(t)}),u.then(function(){o.resolve(!0)},function(){o.reject(!1)}),h},h}]};return t}),angular.module("ui.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function(t,e,i){var n=this,r={$setViewValue:angular.noop},o=e.numPages?i(e.numPages).assign:angular.noop;this.init=function(o,a){r=o,this.config=a,r.$render=function(){n.render()},e.itemsPerPage?t.$parent.$watch(i(e.itemsPerPage),function(e){n.itemsPerPage=parseInt(e,10),t.totalPages=n.calculateTotalPages()}):this.itemsPerPage=a.itemsPerPage},this.calculateTotalPages=function(){var e=this.itemsPerPage<1?1:Math.ceil(t.totalItems/this.itemsPerPage);return Math.max(e||0,1)},this.render=function(){t.page=parseInt(r.$viewValue,10)||1},t.selectPage=function(e){t.page!==e&&e>0&&e<=t.totalPages&&(r.$setViewValue(e),r.$render())},t.getText=function(e){return t[e+"Text"]||n.config[e+"Text"]},t.noPrevious=function(){return 1===t.page},t.noNext=function(){return t.page===t.totalPages},t.$watch("totalItems",function(){t.totalPages=n.calculateTotalPages()}),t.$watch("totalPages",function(e){o(t.$parent,e),t.page>e?t.selectPage(e):r.$render()})}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function(t,e){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(i,n,r,o){function a(t,e,i){return{number:t,text:e,active:i}}function s(t,e){var i=[],n=1,r=e,o=angular.isDefined(h)&&e>h;o&&(u?(n=Math.max(t-Math.floor(h/2),1),r=n+h-1,r>e&&(r=e,n=r-h+1)):(n=(Math.ceil(t/h)-1)*h+1,r=Math.min(n+h-1,e)));for(var s=n;r>=s;s++){var l=a(s,s,s===t);i.push(l)}if(o&&!u){if(n>1){var c=a(n-1,"...",!1);i.unshift(c)}if(e>r){var f=a(r+1,"...",!1);i.push(f)}}return i}var l=o[0],c=o[1];if(c){var h=angular.isDefined(r.maxSize)?i.$parent.$eval(r.maxSize):e.maxSize,u=angular.isDefined(r.rotate)?i.$parent.$eval(r.rotate):e.rotate;i.boundaryLinks=angular.isDefined(r.boundaryLinks)?i.$parent.$eval(r.boundaryLinks):e.boundaryLinks,i.directionLinks=angular.isDefined(r.directionLinks)?i.$parent.$eval(r.directionLinks):e.directionLinks,l.init(c,e),r.maxSize&&i.$parent.$watch(t(r.maxSize),function(t){h=parseInt(t,10),l.render()});var f=l.render;l.render=function(){f(),i.page>0&&i.page<=i.totalPages&&(i.pages=s(i.page,i.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:" Previous",nextText:"Next ",align:!0}).directive("pager",["pagerConfig",function(t){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(e,i,n,r){var o=r[0],a=r[1];a&&(e.align=angular.isDefined(n.align)?e.$parent.$eval(n.align):t.align,o.init(a,t))}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function t(t){var e=/[A-Z]/g,i="-";return t.replace(e,function(t,e){return(e?i:"")+t.toLowerCase()})}var e={placement:"top",animation:!0,popupDelay:0},i={mouseenter:"mouseleave",click:"click",focus:"blur"},n={};this.options=function(t){angular.extend(n,t)},this.setTriggers=function(t){angular.extend(i,t)},this.$get=["$window","$compile","$timeout","$parse","$document","$position","$interpolate",function(r,o,a,s,l,c,h){return function(r,u,f){function d(t){var e=t||p.trigger||f,n=i[e]||e;return{show:e,hide:n}}var p=angular.extend({},e,n),g=t(r),v=h.startSymbol(),m=h.endSymbol(),b="<div "+g+'-popup title="'+v+"tt_title"+m+'" content="'+v+"tt_content"+m+'" placement="'+v+"tt_placement"+m+'" animation="tt_animation" is-open="tt_isOpen"></div>';return{restrict:"EA",scope:!0,compile:function(){var t=o(b);return function(e,i,n){function o(){e.tt_isOpen?f():h()}function h(){(!S||e.$eval(n[u+"Enable"]))&&(e.tt_popupDelay?w||(w=a(g,e.tt_popupDelay,!1),w.then(function(t){t()})):g()())}function f(){e.$apply(function(){v()})}function g(){return w=null,x&&(a.cancel(x),x=null),e.tt_content?(m(),y.css({top:0,left:0,display:"block"}),_?l.find("body").append(y):i.after(y),A(),e.tt_isOpen=!0,e.$digest(),A):angular.noop}function v(){e.tt_isOpen=!1,a.cancel(w),w=null,e.tt_animation?x||(x=a(b,500)):b()}function m(){y&&b(),y=t(e,function(){}),e.$digest()}function b(){x=null,y&&(y.remove(),y=null)}var y,x,w,_=angular.isDefined(p.appendToBody)?p.appendToBody:!1,C=d(void 0),S=angular.isDefined(n[u+"Enable"]),A=function(){var t=c.positionElements(i,y,e.tt_placement,_);t.top+="px",t.left+="px",y.css(t)};e.tt_isOpen=!1,n.$observe(r,function(t){e.tt_content=t,!t&&e.tt_isOpen&&v()}),n.$observe(u+"Title",function(t){e.tt_title=t}),n.$observe(u+"Placement",function(t){e.tt_placement=angular.isDefined(t)?t:p.placement}),n.$observe(u+"PopupDelay",function(t){var i=parseInt(t,10);e.tt_popupDelay=isNaN(i)?p.popupDelay:i});var k=function(){i.unbind(C.show,h),i.unbind(C.hide,f)};n.$observe(u+"Trigger",function(t){k(),C=d(t),C.show===C.hide?i.bind(C.show,o):(i.bind(C.show,h),i.bind(C.hide,f))});var T=e.$eval(n[u+"Animation"]);e.tt_animation=angular.isDefined(T)?!!T:p.animation,n.$observe(u+"AppendToBody",function(t){_=angular.isDefined(t)?s(t)(e):_}),_&&e.$on("$locationChangeSuccess",function(){e.tt_isOpen&&v()}),e.$on("$destroy",function(){a.cancel(x),a.cancel(w),k(),b()})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(t){return t("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function(t){return t("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function(t){return t("popover","popover","click")}]),angular.module("ui.bootstrap.progressbar",[]).constant("progressConfig",{animate:!0,max:100}).controller("ProgressController",["$scope","$attrs","progressConfig",function(t,e,i){var n=this,r=angular.isDefined(e.animate)?t.$parent.$eval(e.animate):i.animate;this.bars=[],t.max=angular.isDefined(e.max)?t.$parent.$eval(e.max):i.max,this.addBar=function(e,i){r||i.css({transition:"none"}),this.bars.push(e),e.$watch("value",function(i){e.percent=+(100*i/t.max).toFixed(2)}),e.$on("$destroy",function(){i=null,n.removeBar(e)})},this.removeBar=function(t){this.bars.splice(this.bars.indexOf(t),1)}}]).directive("progress",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",require:"progress",scope:{},templateUrl:"template/progressbar/progress.html"}}).directive("bar",function(){return{restrict:"EA",replace:!0,transclude:!0,require:"^progress",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/bar.html",link:function(t,e,i,n){n.addBar(t,e)}}}).directive("progressbar",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"ProgressController",scope:{value:"=",type:"@"},templateUrl:"template/progressbar/progressbar.html",link:function(t,e,i,n){n.addBar(t,angular.element(e.children()[0]))}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function(t,e,i){var n={$setViewValue:angular.noop};this.init=function(r){n=r,n.$render=this.render,this.stateOn=angular.isDefined(e.stateOn)?t.$parent.$eval(e.stateOn):i.stateOn,this.stateOff=angular.isDefined(e.stateOff)?t.$parent.$eval(e.stateOff):i.stateOff;var o=angular.isDefined(e.ratingStates)?t.$parent.$eval(e.ratingStates):new Array(angular.isDefined(e.max)?t.$parent.$eval(e.max):i.max);t.range=this.buildTemplateObjects(o)},this.buildTemplateObjects=function(t){for(var e=0,i=t.length;i>e;e++)t[e]=angular.extend({index:e},{stateOn:this.stateOn,stateOff:this.stateOff},t[e]);return t},t.rate=function(e){!t.readonly&&e>=0&&e<=t.range.length&&(n.$setViewValue(e),n.$render())},t.enter=function(e){t.readonly||(t.value=e),t.onHover({value:e})},t.reset=function(){t.value=n.$viewValue,t.onLeave()},t.onKeydown=function(e){/(37|38|39|40)/.test(e.which)&&(e.preventDefault(),e.stopPropagation(),t.rate(t.value+(38===e.which||39===e.which?1:-1)))},this.render=function(){t.value=n.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(t,e,i,n){var r=n[0],o=n[1];
o&&r.init(o)}}}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function(t){var e=this,i=e.tabs=t.tabs=[];e.select=function(t){angular.forEach(i,function(e){e.active&&e!==t&&(e.active=!1,e.onDeselect())}),t.active=!0,t.onSelect()},e.addTab=function(t){i.push(t),1===i.length?t.active=!0:t.active&&e.select(t)},e.removeTab=function(t){var n=i.indexOf(t);if(t.active&&i.length>1){var r=n==i.length-1?n-1:n+1;e.select(i[r])}i.splice(n,1)}}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(t,e,i){t.vertical=angular.isDefined(i.vertical)?t.$parent.$eval(i.vertical):!1,t.justified=angular.isDefined(i.justified)?t.$parent.$eval(i.justified):!1}}}).directive("tab",["$parse",function(t){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(e,i,n){return function(e,i,r,o){e.$watch("active",function(t){t&&o.select(e)}),e.disabled=!1,r.disabled&&e.$parent.$watch(t(r.disabled),function(t){e.disabled=!!t}),e.select=function(){e.disabled||(e.active=!0)},o.addTab(e),e.$on("$destroy",function(){o.removeTab(e)}),e.$transcludeFn=n}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(t,e){t.$watch("headingElement",function(t){t&&(e.html(""),e.append(t))})}}}]).directive("tabContentTransclude",function(){function t(t){return t.tagName&&(t.hasAttribute("tab-heading")||t.hasAttribute("data-tab-heading")||"tab-heading"===t.tagName.toLowerCase()||"data-tab-heading"===t.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(e,i,n){var r=e.$eval(n.tabContentTransclude);r.$transcludeFn(r.$parent,function(e){angular.forEach(e,function(e){t(e)?r.headingElement=e:i.append(e)})})}}}),angular.module("ui.bootstrap.timepicker",[]).constant("timepickerConfig",{hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0}).controller("TimepickerController",["$scope","$attrs","$parse","$log","$locale","timepickerConfig",function(t,e,i,n,r,o){function a(){var e=parseInt(t.hours,10),i=t.showMeridian?e>0&&13>e:e>=0&&24>e;return i?(t.showMeridian&&(12===e&&(e=0),t.meridian===g[1]&&(e+=12)),e):void 0}function s(){var e=parseInt(t.minutes,10);return e>=0&&60>e?e:void 0}function l(t){return angular.isDefined(t)&&t.toString().length<2?"0"+t:t}function c(t){h(),p.$setViewValue(new Date(d)),u(t)}function h(){p.$setValidity("time",!0),t.invalidHours=!1,t.invalidMinutes=!1}function u(e){var i=d.getHours(),n=d.getMinutes();t.showMeridian&&(i=0===i||12===i?12:i%12),t.hours="h"===e?i:l(i),t.minutes="m"===e?n:l(n),t.meridian=d.getHours()<12?g[0]:g[1]}function f(t){var e=new Date(d.getTime()+6e4*t);d.setHours(e.getHours(),e.getMinutes()),c()}var d=new Date,p={$setViewValue:angular.noop},g=angular.isDefined(e.meridians)?t.$parent.$eval(e.meridians):o.meridians||r.DATETIME_FORMATS.AMPMS;this.init=function(i,n){p=i,p.$render=this.render;var r=n.eq(0),a=n.eq(1),s=angular.isDefined(e.mousewheel)?t.$parent.$eval(e.mousewheel):o.mousewheel;s&&this.setupMousewheelEvents(r,a),t.readonlyInput=angular.isDefined(e.readonlyInput)?t.$parent.$eval(e.readonlyInput):o.readonlyInput,this.setupInputEvents(r,a)};var v=o.hourStep;e.hourStep&&t.$parent.$watch(i(e.hourStep),function(t){v=parseInt(t,10)});var m=o.minuteStep;e.minuteStep&&t.$parent.$watch(i(e.minuteStep),function(t){m=parseInt(t,10)}),t.showMeridian=o.showMeridian,e.showMeridian&&t.$parent.$watch(i(e.showMeridian),function(e){if(t.showMeridian=!!e,p.$error.time){var i=a(),n=s();angular.isDefined(i)&&angular.isDefined(n)&&(d.setHours(i),c())}else u()}),this.setupMousewheelEvents=function(e,i){var n=function(t){t.originalEvent&&(t=t.originalEvent);var e=t.wheelDelta?t.wheelDelta:-t.deltaY;return t.detail||e>0};e.bind("mousewheel wheel",function(e){t.$apply(n(e)?t.incrementHours():t.decrementHours()),e.preventDefault()}),i.bind("mousewheel wheel",function(e){t.$apply(n(e)?t.incrementMinutes():t.decrementMinutes()),e.preventDefault()})},this.setupInputEvents=function(e,i){if(t.readonlyInput)return t.updateHours=angular.noop,void(t.updateMinutes=angular.noop);var n=function(e,i){p.$setViewValue(null),p.$setValidity("time",!1),angular.isDefined(e)&&(t.invalidHours=e),angular.isDefined(i)&&(t.invalidMinutes=i)};t.updateHours=function(){var t=a();angular.isDefined(t)?(d.setHours(t),c("h")):n(!0)},e.bind("blur",function(){!t.invalidHours&&t.hours<10&&t.$apply(function(){t.hours=l(t.hours)})}),t.updateMinutes=function(){var t=s();angular.isDefined(t)?(d.setMinutes(t),c("m")):n(void 0,!0)},i.bind("blur",function(){!t.invalidMinutes&&t.minutes<10&&t.$apply(function(){t.minutes=l(t.minutes)})})},this.render=function(){var t=p.$modelValue?new Date(p.$modelValue):null;isNaN(t)?(p.$setValidity("time",!1),n.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(t&&(d=t),h(),u())},t.incrementHours=function(){f(60*v)},t.decrementHours=function(){f(60*-v)},t.incrementMinutes=function(){f(m)},t.decrementMinutes=function(){f(-m)},t.toggleMeridian=function(){f(720*(d.getHours()<12?1:-1))}}]).directive("timepicker",function(){return{restrict:"EA",require:["timepicker","?^ngModel"],controller:"TimepickerController",replace:!0,scope:{},templateUrl:"template/timepicker/timepicker.html",link:function(t,e,i,n){var r=n[0],o=n[1];o&&r.init(o,e.find("input"))}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function(t){var e=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(i){var n=i.match(e);if(!n)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+i+'".');return{itemName:n[3],source:t(n[4]),viewMapper:t(n[2]||n[1]),modelMapper:t(n[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(t,e,i,n,r,o,a){var s=[9,13,27,38,40];return{require:"ngModel",link:function(l,c,h,u){var f,d=l.$eval(h.typeaheadMinLength)||1,p=l.$eval(h.typeaheadWaitMs)||0,g=l.$eval(h.typeaheadEditable)!==!1,v=e(h.typeaheadLoading).assign||angular.noop,m=e(h.typeaheadOnSelect),b=h.typeaheadInputFormatter?e(h.typeaheadInputFormatter):void 0,y=h.typeaheadAppendToBody?l.$eval(h.typeaheadAppendToBody):!1,x=e(h.ngModel).assign,w=a.parse(h.typeahead),_=l.$new();l.$on("$destroy",function(){_.$destroy()});var C="typeahead-"+_.$id+"-"+Math.floor(1e4*Math.random());c.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":C});var S=angular.element("<div typeahead-popup></div>");S.attr({id:C,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(h.typeaheadTemplateUrl)&&S.attr("template-url",h.typeaheadTemplateUrl);var A=function(){_.matches=[],_.activeIdx=-1,c.attr("aria-expanded",!1)},k=function(t){return C+"-option-"+t};_.$watch("activeIdx",function(t){0>t?c.removeAttr("aria-activedescendant"):c.attr("aria-activedescendant",k(t))});var T=function(t){var e={$viewValue:t};v(l,!0),i.when(w.source(l,e)).then(function(i){var n=t===u.$viewValue;if(n&&f)if(i.length>0){_.activeIdx=0,_.matches.length=0;for(var r=0;r<i.length;r++)e[w.itemName]=i[r],_.matches.push({id:k(r),label:w.viewMapper(_,e),model:i[r]});_.query=t,_.position=y?o.offset(c):o.position(c),_.position.top=_.position.top+c.prop("offsetHeight"),c.attr("aria-expanded",!0)}else A();n&&v(l,!1)},function(){A(),v(l,!1)})};A(),_.query=void 0;var O,$=function(t){O=n(function(){T(t)},p)},D=function(){O&&n.cancel(O)};u.$parsers.unshift(function(t){return f=!0,t&&t.length>=d?p>0?(D(),$(t)):T(t):(v(l,!1),D(),A()),g?t:t?void u.$setValidity("editable",!1):(u.$setValidity("editable",!0),t)}),u.$formatters.push(function(t){var e,i,n={};return b?(n.$model=t,b(l,n)):(n[w.itemName]=t,e=w.viewMapper(l,n),n[w.itemName]=void 0,i=w.viewMapper(l,n),e!==i?e:t)}),_.select=function(t){var e,i,r={};r[w.itemName]=i=_.matches[t].model,e=w.modelMapper(l,r),x(l,e),u.$setValidity("editable",!0),m(l,{$item:i,$model:e,$label:w.viewMapper(l,r)}),A(),n(function(){c[0].focus()},0,!1)},c.bind("keydown",function(t){0!==_.matches.length&&-1!==s.indexOf(t.which)&&(t.preventDefault(),40===t.which?(_.activeIdx=(_.activeIdx+1)%_.matches.length,_.$digest()):38===t.which?(_.activeIdx=(_.activeIdx?_.activeIdx:_.matches.length)-1,_.$digest()):13===t.which||9===t.which?_.$apply(function(){_.select(_.activeIdx)}):27===t.which&&(t.stopPropagation(),A(),_.$digest()))}),c.bind("blur",function(){f=!1});var M=function(t){c[0]!==t.target&&(A(),_.$digest())};r.bind("click",M),l.$on("$destroy",function(){r.unbind("click",M)});var E=t(S)(_);y?r.find("body").append(E):c.after(E)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(t,e,i){t.templateUrl=i.templateUrl,t.isOpen=function(){return t.matches.length>0},t.isActive=function(e){return t.active==e},t.selectActive=function(e){t.active=e},t.selectMatch=function(e){t.select({activeIdx:e})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function(t,e,i,n){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(r,o,a){var s=n(a.templateUrl)(r.$parent)||"template/typeahead/typeahead-match.html";t.get(s,{cache:e}).success(function(t){o.replaceWith(i(t.trim())(r))})}}}]).filter("typeaheadHighlight",function(){function t(t){return t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(e,i){return i?(""+e).replace(new RegExp(t(i),"gi"),"<strong>$&</strong>"):e}}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function(t){t.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading">\n    <h4 class="panel-title">\n      <a class="accordion-toggle" ng-click="toggleOpen()" accordion-transclude="heading"><span ng-class="{\'text-muted\': isDisabled}">{{heading}}</span></a>\n    </h4>\n  </div>\n  <div class="panel-collapse" collapse="!isOpen">\n	  <div class="panel-body" ng-transclude></div>\n  </div>\n</div>')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function(t){t.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/alert/alert.html",[]).run(["$templateCache",function(t){t.put("template/alert/alert.html",'<div class="alert" ng-class="[\'alert-\' + (type || \'warning\'), closeable ? \'alert-dismissable\' : null]" role="alert">\n    <button ng-show="closeable" type="button" class="close" ng-click="close()">\n        <span aria-hidden="true">&times;</span>\n        <span class="sr-only">Close</span>\n    </button>\n    <div ng-transclude></div>\n</div>\n')}]),angular.module("template/carousel/carousel.html",[]).run(["$templateCache",function(t){t.put("template/carousel/carousel.html",'<div ng-mouseenter="pause()" ng-mouseleave="play()" class="carousel" ng-swipe-right="prev()" ng-swipe-left="next()">\n    <ol class="carousel-indicators" ng-show="slides.length > 1">\n        <li ng-repeat="slide in slides track by $index" ng-class="{active: isActive(slide)}" ng-click="select(slide)"></li>\n    </ol>\n    <div class="carousel-inner" ng-transclude></div>\n    <a class="left carousel-control" ng-click="prev()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-left"></span></a>\n    <a class="right carousel-control" ng-click="next()" ng-show="slides.length > 1"><span class="glyphicon glyphicon-chevron-right"></span></a>\n</div>\n')}]),angular.module("template/carousel/slide.html",[]).run(["$templateCache",function(t){t.put("template/carousel/slide.html","<div ng-class=\"{\n    'active': leaving || (active && !entering),\n    'prev': (next || active) && direction=='prev',\n    'next': (next || active) && direction=='next',\n    'right': direction=='prev',\n    'left': direction=='next'\n  }\" class=\"item text-center\" ng-transclude></div>\n")}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function(t){t.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)">\n  <daypicker ng-switch-when="day" tabindex="0"></daypicker>\n  <monthpicker ng-switch-when="month" tabindex="0"></monthpicker>\n  <yearpicker ng-switch-when="year" tabindex="0"></yearpicker>\n</div>')}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function(t){t.put("template/datepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center"></th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function(t){t.put("template/datepicker/month.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function(t){t.put("template/datepicker/popup.html",'<ul class="dropdown-menu" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n	<li ng-transclude></li>\n	<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n		<span class="btn-group">\n			<button type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n			<button type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n		</span>\n		<button type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n	</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function(t){t.put("template/datepicker/year.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-left"></i></button></th>\n      <th colspan="3"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="glyphicon glyphicon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function(t){t.put("template/modal/backdrop.html",'<div class="modal-backdrop fade {{ backdropClass }}"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function(t){t.put("template/modal/window.html",'<div tabindex="-1" role="dialog" class="modal fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="{\'modal-sm\': size == \'sm\', \'modal-lg\': size == \'lg\'}"><div class="modal-content" modal-transclude></div></div>\n</div>')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function(t){t.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function(t){t.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function(t){t.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(t){t.put("template/tooltip/tooltip-popup.html",'<div class="tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="tooltip-arrow"></div>\n  <div class="tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/popover/popover.html",[]).run(["$templateCache",function(t){t.put("template/popover/popover.html",'<div class="popover {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="arrow"></div>\n\n  <div class="popover-inner">\n      <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n      <div class="popover-content" ng-bind="content"></div>\n  </div>\n</div>\n')}]),angular.module("template/progressbar/bar.html",[]).run(["$templateCache",function(t){t.put("template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>')}]),angular.module("template/progressbar/progress.html",[]).run(["$templateCache",function(t){t.put("template/progressbar/progress.html",'<div class="progress" ng-transclude></div>')}]),angular.module("template/progressbar/progressbar.html",[]).run(["$templateCache",function(t){t.put("template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: percent + \'%\'}" aria-valuetext="{{percent | number:0}}%" ng-transclude></div>\n</div>')}]),angular.module("template/rating/rating.html",[]).run(["$templateCache",function(t){t.put("template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}">\n    <i ng-repeat="r in range track by $index" ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')">\n        <span class="sr-only">({{ $index < value ? \'*\' : \' \' }})</span>\n    </i>\n</span>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function(t){t.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n  <a ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function(t){t.put("template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n  <div class="tab-content">\n    <div class="tab-pane" \n         ng-repeat="tab in tabs" \n         ng-class="{active: tab.active}"\n         tab-content-transclude="tab">\n    </div>\n  </div>\n</div>\n')}]),angular.module("template/timepicker/timepicker.html",[]).run(["$templateCache",function(t){t.put("template/timepicker/timepicker.html",'<table>\n	<tbody>\n		<tr class="text-center">\n			<td><a ng-click="incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n		<tr>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidHours}">\n				<input type="text" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-mousewheel="incrementHours()" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td>:</td>\n			<td style="width:50px;" class="form-group" ng-class="{\'has-error\': invalidMinutes}">\n				<input type="text" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2">\n			</td>\n			<td ng-show="showMeridian"><button type="button" class="btn btn-default text-center" ng-click="toggleMeridian()">{{meridian}}</button></td>\n		</tr>\n		<tr class="text-center">\n			<td><a ng-click="decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td>&nbsp;</td>\n			<td><a ng-click="decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n			<td ng-show="showMeridian"></td>\n		</tr>\n	</tbody>\n</table>\n')}]),angular.module("template/typeahead/typeahead-match.html",[]).run(["$templateCache",function(t){t.put("template/typeahead/typeahead-match.html",'<a tabindex="-1" bind-html-unsafe="match.label | typeaheadHighlight:query"></a>')}]),angular.module("template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function(t){t.put("template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen()" ng-style="{top: position.top+\'px\', left: position.left+\'px\'}" style="display: block;" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index)" role="option" id="{{match.id}}">\n        <div typeahead-match index="$index" match="match" query="query" template-url="templateUrl"></div>\n    </li>\n</ul>\n')}]),function(){function t(t){var i={r:0,g:0,b:0},r=1,a=!1,s=!1;return"string"==typeof t&&(t=E(t)),"object"==typeof t&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(i=e(t.r,t.g,t.b),a=!0,s="%"===String(t.r).substr(-1)?"prgb":"rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(t.s=$(t.s),t.v=$(t.v),i=o(t.h,t.s,t.v),a=!0,s="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(t.s=$(t.s),t.l=$(t.l),i=n(t.h,t.s,t.l),a=!0,s="hsl"),t.hasOwnProperty("a")&&(r=t.a)),r=_(r),{ok:a,format:t.format||s,r:H(255,R(i.r,0)),g:H(255,R(i.g,0)),b:H(255,R(i.b,0)),a:r}}function e(t,e,i){return{r:255*C(t,255),g:255*C(e,255),b:255*C(i,255)}}function i(t,e,i){t=C(t,255),e=C(e,255),i=C(i,255);var n,r,o=R(t,e,i),a=H(t,e,i),s=(o+a)/2;if(o==a)n=r=0;else{var l=o-a;switch(r=s>.5?l/(2-o-a):l/(o+a),o){case t:n=(e-i)/l+(i>e?6:0);break;case e:n=(i-t)/l+2;break;case i:n=(t-e)/l+4}n/=6}return{h:n,s:r,l:s}}function n(t,e,i){function n(t,e,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?t+6*(e-t)*i:.5>i?e:2/3>i?t+(e-t)*(2/3-i)*6:t}var r,o,a;if(t=C(t,360),e=C(e,100),i=C(i,100),0===e)r=o=a=i;else{var s=.5>i?i*(1+e):i+e-i*e,l=2*i-s;r=n(l,s,t+1/3),o=n(l,s,t),a=n(l,s,t-1/3)}return{r:255*r,g:255*o,b:255*a}}function r(t,e,i){t=C(t,255),e=C(e,255),i=C(i,255);var n,r,o=R(t,e,i),a=H(t,e,i),s=o,l=o-a;if(r=0===o?0:l/o,o==a)n=0;else{switch(o){case t:n=(e-i)/l+(i>e?6:0);break;case e:n=(i-t)/l+2;break;case i:n=(t-e)/l+4}n/=6}return{h:n,s:r,v:s}}function o(t,e,i){t=6*C(t,360),e=C(e,100),i=C(i,100);var n=I.floor(t),r=t-n,o=i*(1-e),a=i*(1-r*e),s=i*(1-(1-r)*e),l=n%6,c=[i,a,o,o,s,i][l],h=[s,i,i,a,o,o][l],u=[o,o,s,i,i,a][l];return{r:255*c,g:255*h,b:255*u}}function a(t,e,i,n){var r=[O(F(t).toString(16)),O(F(e).toString(16)),O(F(i).toString(16))];return n&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function s(t,e,i,n){var r=[O(D(n)),O(F(t).toString(16)),O(F(e).toString(16)),O(F(i).toString(16))];return r.join("")}function l(t,e){e=0===e?0:e||10;var i=V(t).toHsl();return i.s-=e/100,i.s=S(i.s),V(i)}function c(t,e){e=0===e?0:e||10;var i=V(t).toHsl();return i.s+=e/100,i.s=S(i.s),V(i)}function h(t){return V(t).desaturate(100)}function u(t,e){e=0===e?0:e||10;var i=V(t).toHsl();return i.l+=e/100,i.l=S(i.l),V(i)}function f(t,e){e=0===e?0:e||10;var i=V(t).toRgb();return i.r=R(0,H(255,i.r-F(255*-(e/100)))),i.g=R(0,H(255,i.g-F(255*-(e/100)))),i.b=R(0,H(255,i.b-F(255*-(e/100)))),V(i)}function d(t,e){e=0===e?0:e||10;var i=V(t).toHsl();return i.l-=e/100,i.l=S(i.l),V(i)}function p(t,e){var i=V(t).toHsl(),n=(F(i.h)+e)%360;return i.h=0>n?360+n:n,V(i)}function g(t){var e=V(t).toHsl();return e.h=(e.h+180)%360,V(e)}function v(t){var e=V(t).toHsl(),i=e.h;return[V(t),V({h:(i+120)%360,s:e.s,l:e.l}),V({h:(i+240)%360,s:e.s,l:e.l})]}function m(t){var e=V(t).toHsl(),i=e.h;return[V(t),V({h:(i+90)%360,s:e.s,l:e.l}),V({h:(i+180)%360,s:e.s,l:e.l}),V({h:(i+270)%360,s:e.s,l:e.l})]}function b(t){var e=V(t).toHsl(),i=e.h;return[V(t),V({h:(i+72)%360,s:e.s,l:e.l}),V({h:(i+216)%360,s:e.s,l:e.l})]}function y(t,e,i){e=e||6,i=i||30;var n=V(t).toHsl(),r=360/i,o=[V(t)];for(n.h=(n.h-(r*e>>1)+720)%360;--e;)n.h=(n.h+r)%360,o.push(V(n));return o}function x(t,e){e=e||6;for(var i=V(t).toHsv(),n=i.h,r=i.s,o=i.v,a=[],s=1/e;e--;)a.push(V({h:n,s:r,v:o})),o=(o+s)%1;return a}function w(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[t[i]]=i);return e}function _(t){return t=parseFloat(t),(isNaN(t)||0>t||t>1)&&(t=1),t}function C(t,e){k(t)&&(t="100%");var i=T(t);return t=H(e,R(0,parseFloat(t))),i&&(t=parseInt(t*e,10)/100),I.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function S(t){return H(1,R(0,t))}function A(t){return parseInt(t,16)}function k(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)}function T(t){return"string"==typeof t&&-1!=t.indexOf("%")}function O(t){return 1==t.length?"0"+t:""+t}function $(t){return 1>=t&&(t=100*t+"%"),t}function D(t){return Math.round(255*parseFloat(t)).toString(16)}function M(t){return A(t)/255}function E(t){t=t.replace(P,"").replace(j,"").toLowerCase();var e=!1;if(z[t])t=z[t],e=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};var i;return(i=N.rgb.exec(t))?{r:i[1],g:i[2],b:i[3]}:(i=N.rgba.exec(t))?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=N.hsl.exec(t))?{h:i[1],s:i[2],l:i[3]}:(i=N.hsla.exec(t))?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=N.hsv.exec(t))?{h:i[1],s:i[2],v:i[3]}:(i=N.hex8.exec(t))?{a:M(i[1]),r:A(i[2]),g:A(i[3]),b:A(i[4]),format:e?"name":"hex8"}:(i=N.hex6.exec(t))?{r:A(i[1]),g:A(i[2]),b:A(i[3]),format:e?"name":"hex"}:(i=N.hex3.exec(t))?{r:A(i[1]+""+i[1]),g:A(i[2]+""+i[2]),b:A(i[3]+""+i[3]),format:e?"name":"hex"}:!1}var P=/^[\s,#]+/,j=/\s+$/,L=0,I=Math,F=I.round,H=I.min,R=I.max,B=I.random,V=function X(e,i){if(e=e?e:"",i=i||{},e instanceof X)return e;if(!(this instanceof X))return new X(e,i);var n=t(e);this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=F(100*this._a)/100,this._format=i.format||n.format,this._gradientType=i.gradientType,this._r<1&&(this._r=F(this._r)),this._g<1&&(this._g=F(this._g)),this._b<1&&(this._b=F(this._b)),this._ok=n.ok,this._tc_id=L++};V.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},setAlpha:function(t){return this._a=_(t),this._roundA=F(100*this._a)/100,this},toHsv:function(){var t=r(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=r(this._r,this._g,this._b),e=F(360*t.h),i=F(100*t.s),n=F(100*t.v);return 1==this._a?"hsv("+e+", "+i+"%, "+n+"%)":"hsva("+e+", "+i+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var t=i(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=i(this._r,this._g,this._b),e=F(360*t.h),n=F(100*t.s),r=F(100*t.l);
return 1==this._a?"hsl("+e+", "+n+"%, "+r+"%)":"hsla("+e+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(t){return a(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return s(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:F(this._r),g:F(this._g),b:F(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+F(this._r)+", "+F(this._g)+", "+F(this._b)+")":"rgba("+F(this._r)+", "+F(this._g)+", "+F(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:F(100*C(this._r,255))+"%",g:F(100*C(this._g,255))+"%",b:F(100*C(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+F(100*C(this._r,255))+"%, "+F(100*C(this._g,255))+"%, "+F(100*C(this._b,255))+"%)":"rgba("+F(100*C(this._r,255))+"%, "+F(100*C(this._g,255))+"%, "+F(100*C(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:W[a(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var e="#"+s(this._r,this._g,this._b,this._a),i=e,n=this._gradientType?"GradientType = 1, ":"";if(t){var r=V(t);i=r.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+e+",endColorstr="+i+")"},toString:function(t){var e=!!t;t=t||this._format;var i=!1,n=this._a<1&&this._a>=0,r=!e&&n&&("hex"===t||"hex6"===t||"hex3"===t||"name"===t);return r?"name"===t&&0===this._a?this.toName():this.toRgbString():("rgb"===t&&(i=this.toRgbString()),"prgb"===t&&(i=this.toPercentageRgbString()),("hex"===t||"hex6"===t)&&(i=this.toHexString()),"hex3"===t&&(i=this.toHexString(!0)),"hex8"===t&&(i=this.toHex8String()),"name"===t&&(i=this.toName()),"hsl"===t&&(i=this.toHslString()),"hsv"===t&&(i=this.toHsvString()),i||this.toHexString())},_applyModification:function(t,e){var i=t.apply(null,[this].concat([].slice.call(e)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(u,arguments)},brighten:function(){return this._applyModification(f,arguments)},darken:function(){return this._applyModification(d,arguments)},desaturate:function(){return this._applyModification(l,arguments)},saturate:function(){return this._applyModification(c,arguments)},greyscale:function(){return this._applyModification(h,arguments)},spin:function(){return this._applyModification(p,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(y,arguments)},complement:function(){return this._applyCombination(g,arguments)},monochromatic:function(){return this._applyCombination(x,arguments)},splitcomplement:function(){return this._applyCombination(b,arguments)},triad:function(){return this._applyCombination(v,arguments)},tetrad:function(){return this._applyCombination(m,arguments)}},V.fromRatio=function(t,e){if("object"==typeof t){var i={};for(var n in t)t.hasOwnProperty(n)&&(i[n]="a"===n?t[n]:$(t[n]));t=i}return V(t,e)},V.equals=function(t,e){return t&&e?V(t).toRgbString()==V(e).toRgbString():!1},V.random=function(){return V.fromRatio({r:B(),g:B(),b:B()})},V.mix=function(t,e,i){i=0===i?0:i||50;var n,r=V(t).toRgb(),o=V(e).toRgb(),a=i/100,s=2*a-1,l=o.a-r.a;n=s*l==-1?s:(s+l)/(1+s*l),n=(n+1)/2;var c=1-n,h={r:o.r*n+r.r*c,g:o.g*n+r.g*c,b:o.b*n+r.b*c,a:o.a*a+r.a*(1-a)};return V(h)},V.readability=function(t,e){var i=V(t),n=V(e),r=i.toRgb(),o=n.toRgb(),a=i.getBrightness(),s=n.getBrightness(),l=Math.max(r.r,o.r)-Math.min(r.r,o.r)+Math.max(r.g,o.g)-Math.min(r.g,o.g)+Math.max(r.b,o.b)-Math.min(r.b,o.b);return{brightness:Math.abs(a-s),color:l}},V.isReadable=function(t,e){var i=V.readability(t,e);return i.brightness>125&&i.color>500},V.mostReadable=function(t,e){for(var i=null,n=0,r=!1,o=0;o<e.length;o++){var a=V.readability(t,e[o]),s=a.brightness>125&&a.color>500,l=3*(a.brightness/125)+a.color/500;(s&&!r||s&&r&&l>n||!s&&!r&&l>n)&&(r=s,n=l,i=V(e[o]))}return i};var z=V.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},W=V.hexNames=w(z),N=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",i="(?:"+e+")|(?:"+t+")",n="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?",r="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?";return{rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+n),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();"undefined"!=typeof module&&module.exports?module.exports=V:"function"==typeof define&&define.amd?define(function(){return V}):window.tinycolor=V}(),function(t){t.fn.confirm=function(e){return"undefined"==typeof e&&(e={}),this.click(function(i){i.preventDefault();var n=t.extend({button:t(this)},e);t.confirm(n,i)}),this},t.confirm=function(e,i){if(!(t(".confirmation-modal").length>0)){var n={};if(e.button){var r={title:"title",text:"text","confirm-button":"confirmButton","cancel-button":"cancelButton","confirm-button-class":"confirmButtonClass"};t.each(r,function(t,i){var r=e.button.data(t);r&&(n[i]=r)})}var o=t.extend({},t.confirm.options,{confirm:function(){var n=i&&("string"==typeof i&&i||i.currentTarget&&i.currentTarget.attributes.href.value);if(n)if(e.post){var r=t('<form method="post" class="hide" action="'+n+'"></form>');t("body").append(r),r.submit()}else window.location=n},cancel:function(){},button:null},n,e),a="";""!==o.title&&(a='<div class=modal-header><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">'+o.title+"</h4></div>");var s='<div class="confirmation-modal modal fade" tabindex="-1" role="dialog"><div class="modal-dialog"><div class="modal-content">'+a+'<div class="modal-body">'+o.text+'</div><div class="modal-footer"><button class="confirm btn '+o.confirmButtonClass+'" type="button" data-dismiss="modal">'+o.confirmButton+'</button><button class="cancel btn btn-default" type="button" data-dismiss="modal">'+o.cancelButton+"</button></div></div></div></div>",l=t(s);l.on("shown.bs.modal",function(){l.find(".btn-primary:first").focus()}),l.on("hidden.bs.modal",function(){l.remove()}),l.find(".confirm").click(function(){o.confirm(o.button)}),l.find(".cancel").click(function(){o.cancel(o.button)}),t("body").append(l),l.modal("show")}},t.confirm.options={text:"Are you sure?",title:"",confirmButton:"Yes",cancelButton:"Cancel",post:!1,confirmButtonClass:"btn-primary"}}(jQuery),function(t){"use strict";var e=t.module("angularSpectrumColorpicker",[]);!function(){e.directive("spectrumColorpicker",function(){return{restrict:"E",require:"ngModel",scope:{fallbackValue:"=",disabled:"=?",format:"=?",options:"=?",triggerId:"@?",onChange:"&?",onShow:"&?",onHide:"&?",onMove:"&?",onBeforeShow:"&?"},replace:!0,templateUrl:"directive.html",link:function(e,i,n,r){function o(t){var i=t;return i&&(i=t.toString(e.format)),i}function a(i){t.isFunction(e.onChange)&&e.onChange({color:i})}function s(i){var n=e.fallbackValue;i?n=o(i):t.isUndefined(e.fallbackValue)&&(n=i),r.$setViewValue(n),a(n)}var l=i.find("input"),c=function(t){e.$apply(function(){s(t)})},h=function(){return l.spectrum("toggle"),!1},u={color:r.$viewValue},f={};t.forEach({change:"onChange",move:"onMove",hide:"onHide",show:"onShow"},function(i,n){f[n]=function(n){return c(n),"change"!==i&&t.isFunction(e[i])?e[i]({color:o(n)}):void 0}}),t.isFunction(e.onBeforeShow)&&(f.beforeShow=function(t){return e.onBeforeShow({color:o(t)})});var d=t.extend({},u,e.options,f);e.triggerId&&t.element(document.body).on("click","#"+e.triggerId,h),r.$render=function(){l.spectrum("set",r.$viewValue||""),a(r.$viewValue)},d.color&&(l.spectrum("set",d.color||""),s(d.color)),l.spectrum(d),e.$on("$destroy",function(){e.triggerId&&t.element(document.body).off("click","#"+e.triggerId,h),l.spectrum("destroy")}),t.isDefined(d.disabled)&&(e.disabled=!!d.disabled),e.$watch("disabled",function(t){l.spectrum(t?"disable":"enable")})}}})}(),t.module("angularSpectrumColorpicker").run(["$templateCache",function(t){t.put("directive.html","<span><input class=input-small></span>")}])}(window.angular),function(){"use strict";angular.module("rn-lazy",[]).directive("rnLazyBackground",["$document","$parse",function(t,e){return{restrict:"A",link:function(i,n,r){function o(t){a&&(t.html(""),t.append(a),t.css({"background-image":null}))}var a=null;angular.isDefined(r.rnLazyLoader)&&(a=angular.element(t[0].querySelector(r.rnLazyLoader)).clone());var s=e(r.rnLazyBackground);i.$watch(s,function(){o(n);var e=s(i),l=t[0].createElement("img");l.onload=function(){a&&a.remove(),angular.isDefined(r.rnLazyLoadingClass)&&n.removeClass(r.rnLazyLoadingClass),angular.isDefined(r.rnLazyLoadedClass)&&n.addClass(r.rnLazyLoadedClass),n.css({"background-image":"url("+this.src+")"})},l.onerror=function(){},l.src=e})}}}])}(),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){"use strict";var e={},i=Math.max,n=Math.min;e.c={},e.c.d=t(document),e.c.t=function(t){return t.originalEvent.touches.length-1},e.o=function(){var i=this;this.o=null,this.$=null,this.i=null,this.g=null,this.v=null,this.cv=null,this.x=0,this.y=0,this.w=0,this.h=0,this.$c=null,this.c=null,this.t=0,this.isInit=!1,this.fgColor=null,this.pColor=null,this.dH=null,this.cH=null,this.eH=null,this.rH=null,this.scale=1,this.relative=!1,this.relativeWidth=!1,this.relativeHeight=!1,this.$div=null,this.run=function(){var e=function(t,e){var n;for(n in e)i.o[n]=e[n];i._carve().init(),i._configure()._draw()};if(!this.$.data("kontroled")){if(this.$.data("kontroled",!0),this.extend(),this.o=t.extend({min:void 0!==this.$.data("min")?this.$.data("min"):0,max:void 0!==this.$.data("max")?this.$.data("max"):100,stopper:!0,readOnly:this.$.data("readonly")||"readonly"===this.$.attr("readonly"),cursor:this.$.data("cursor")===!0&&30||this.$.data("cursor")||0,thickness:this.$.data("thickness")&&Math.max(Math.min(this.$.data("thickness"),1),.01)||.35,lineCap:this.$.data("linecap")||"butt",width:this.$.data("width")||200,height:this.$.data("height")||200,displayInput:null==this.$.data("displayinput")||this.$.data("displayinput"),displayPrevious:this.$.data("displayprevious"),fgColor:this.$.data("fgcolor")||"#87CEEB",inputColor:this.$.data("inputcolor"),font:this.$.data("font")||"Arial",fontWeight:this.$.data("font-weight")||"bold",inline:!1,step:this.$.data("step")||1,rotation:this.$.data("rotation"),draw:null,change:null,cancel:null,release:null,format:function(t){return t},parse:function(t){return parseFloat(t)}},this.o),this.o.flip="anticlockwise"===this.o.rotation||"acw"===this.o.rotation,this.o.inputColor||(this.o.inputColor=this.o.fgColor),this.$.is("fieldset")?(this.v={},this.i=this.$.find("input"),this.i.each(function(e){var n=t(this);i.i[e]=n,i.v[e]=i.o.parse(n.val()),n.bind("change blur",function(){var t={};t[e]=n.val(),i.val(i._validate(t))})}),this.$.find("legend").remove()):(this.i=this.$,this.v=this.o.parse(this.$.val()),""===this.v&&(this.v=this.o.min),this.$.bind("change blur",function(){i.val(i._validate(i.o.parse(i.$.val())))})),!this.o.displayInput&&this.$.hide(),this.$c=t(document.createElement("canvas")).attr({width:this.o.width,height:this.o.height}),this.$div=t('<div style="'+(this.o.inline?"display:inline;":"")+"width:"+this.o.width+"px;height:"+this.o.height+'px;"></div>'),this.$.wrap(this.$div).before(this.$c),this.$div=this.$.parent(),"undefined"!=typeof G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.$c[0]),this.c=this.$c[0].getContext?this.$c[0].getContext("2d"):null,!this.c)throw{name:"CanvasNotSupportedException",message:"Canvas not supported. Please use excanvas on IE8.0.",toString:function(){return this.name+": "+this.message}};return this.scale=(window.devicePixelRatio||1)/(this.c.webkitBackingStorePixelRatio||this.c.mozBackingStorePixelRatio||this.c.msBackingStorePixelRatio||this.c.oBackingStorePixelRatio||this.c.backingStorePixelRatio||1),this.relativeWidth=this.o.width%1!==0&&this.o.width.indexOf("%"),this.relativeHeight=this.o.height%1!==0&&this.o.height.indexOf("%"),this.relative=this.relativeWidth||this.relativeHeight,this._carve(),this.v instanceof Object?(this.cv={},this.copy(this.v,this.cv)):this.cv=this.v,this.$.bind("configure",e).parent().bind("configure",e),this._listen()._configure()._xy().init(),this.isInit=!0,this.$.val(this.o.format(this.v)),this._draw(),this}},this._carve=function(){if(this.relative){var t=this.relativeWidth?this.$div.parent().width()*parseInt(this.o.width)/100:this.$div.parent().width(),e=this.relativeHeight?this.$div.parent().height()*parseInt(this.o.height)/100:this.$div.parent().height();this.w=this.h=Math.min(t,e)}else this.w=this.o.width,this.h=this.o.height;return this.$div.css({width:this.w+"px",height:this.h+"px"}),this.$c.attr({width:this.w,height:this.h}),1!==this.scale&&(this.$c[0].width=this.$c[0].width*this.scale,this.$c[0].height=this.$c[0].height*this.scale,this.$c.width(this.w),this.$c.height(this.h)),this},this._draw=function(){var t=!0;i.g=i.c,i.clear(),i.dH&&(t=i.dH()),t!==!1&&i.draw()},this._touch=function(t){var n=function(t){var e=i.xy2val(t.originalEvent.touches[i.t].pageX,t.originalEvent.touches[i.t].pageY);e!=i.cv&&(i.cH&&i.cH(e)===!1||(i.change(i._validate(e)),i._draw()))};return this.t=e.c.t(t),n(t),e.c.d.bind("touchmove.k",n).bind("touchend.k",function(){e.c.d.unbind("touchmove.k touchend.k"),i.val(i.cv)}),this},this._mouse=function(t){var n=function(t){var e=i.xy2val(t.pageX,t.pageY);e!=i.cv&&(i.cH&&i.cH(e)===!1||(i.change(i._validate(e)),i._draw()))};return n(t),e.c.d.bind("mousemove.k",n).bind("keyup.k",function(t){if(27===t.keyCode){if(e.c.d.unbind("mouseup.k mousemove.k keyup.k"),i.eH&&i.eH()===!1)return;i.cancel()}}).bind("mouseup.k",function(){e.c.d.unbind("mousemove.k mouseup.k keyup.k"),i.val(i.cv)}),this},this._xy=function(){var t=this.$c.offset();return this.x=t.left,this.y=t.top,this},this._listen=function(){return this.o.readOnly?this.$.attr("readonly","readonly"):(this.$c.bind("mousedown",function(t){t.preventDefault(),i._xy()._mouse(t)}).bind("touchstart",function(t){t.preventDefault(),i._xy()._touch(t)}),this.listen()),this.relative&&t(window).resize(function(){i._carve().init(),i._draw()}),this},this._configure=function(){return this.o.draw&&(this.dH=this.o.draw),this.o.change&&(this.cH=this.o.change),this.o.cancel&&(this.eH=this.o.cancel),this.o.release&&(this.rH=this.o.release),this.o.displayPrevious?(this.pColor=this.h2rgba(this.o.fgColor,"0.4"),this.fgColor=this.h2rgba(this.o.fgColor,"0.6")):this.fgColor=this.o.fgColor,this},this._clear=function(){this.$c[0].width=this.$c[0].width},this._validate=function(t){var e=~~((0>t?-.5:.5)+t/this.o.step)*this.o.step;return Math.round(100*e)/100},this.listen=function(){},this.extend=function(){},this.init=function(){},this.change=function(){},this.val=function(){},this.xy2val=function(){},this.draw=function(){},this.clear=function(){this._clear()},this.h2rgba=function(t,e){var i;return t=t.substring(1,7),i=[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16)],"rgba("+i[0]+","+i[1]+","+i[2]+","+e+")"},this.copy=function(t,e){for(var i in t)e[i]=t[i]}},e.Dial=function(){e.o.call(this),this.startAngle=null,this.xy=null,this.radius=null,this.lineWidth=null,this.cursorExt=null,this.w2=null,this.PI2=2*Math.PI,this.extend=function(){this.o=t.extend({bgColor:this.$.data("bgcolor")||"#EEEEEE",angleOffset:this.$.data("angleoffset")||0,angleArc:this.$.data("anglearc")||360,inline:!0},this.o)},this.val=function(t,e){return null==t?this.v:(t=this.o.parse(t),void(e!==!1&&t!=this.v&&this.rH&&this.rH(t)===!1||(this.cv=this.o.stopper?i(n(t,this.o.max),this.o.min):t,this.v=this.cv,this.$.val(this.o.format(this.v)),this._draw())))},this.xy2val=function(t,e){var r,o;return r=Math.atan2(t-(this.x+this.w2),-(e-this.y-this.w2))-this.angleOffset,this.o.flip&&(r=this.angleArc-r-this.PI2),this.angleArc!=this.PI2&&0>r&&r>-.5?r=0:0>r&&(r+=this.PI2),o=r*(this.o.max-this.o.min)/this.angleArc+this.o.min,this.o.stopper&&(o=i(n(o,this.o.max),this.o.min)),o},this.listen=function(){var e,r,o,a,s=this,l=function(t){t.preventDefault();var o=t.originalEvent,a=o.detail||o.wheelDeltaX,l=o.detail||o.wheelDeltaY,c=s._validate(s.o.parse(s.$.val()))+(a>0||l>0?s.o.step:0>a||0>l?-s.o.step:0);c=i(n(c,s.o.max),s.o.min),s.val(c,!1),s.rH&&(clearTimeout(e),e=setTimeout(function(){s.rH(c),e=null},100),r||(r=setTimeout(function(){e&&s.rH(c),r=null},200)))},c=1,h={37:-s.o.step,38:s.o.step,39:s.o.step,40:-s.o.step};this.$.bind("keydown",function(e){var r=e.keyCode;if(r>=96&&105>=r&&(r=e.keyCode=r-48),o=parseInt(String.fromCharCode(r)),isNaN(o)&&(13!==r&&8!==r&&9!==r&&189!==r&&(190!==r||s.$.val().match(/\./))&&e.preventDefault(),t.inArray(r,[37,38,39,40])>-1)){e.preventDefault();var l=s.o.parse(s.$.val())+h[r]*c;s.o.stopper&&(l=i(n(l,s.o.max),s.o.min)),s.change(s._validate(l)),s._draw(),a=window.setTimeout(function(){c*=2},30)}}).bind("keyup",function(){isNaN(o)?a&&(window.clearTimeout(a),a=null,c=1,s.val(s.$.val())):s.$.val()>s.o.max&&s.$.val(s.o.max)||s.$.val()<s.o.min&&s.$.val(s.o.min)}),this.$c.bind("mousewheel DOMMouseScroll",l),this.$.bind("mousewheel DOMMouseScroll",l)},this.init=function(){(this.v<this.o.min||this.v>this.o.max)&&(this.v=this.o.min),this.$.val(this.v),this.w2=this.w/2,this.cursorExt=this.o.cursor/100,this.xy=this.w2*this.scale,this.lineWidth=this.xy*this.o.thickness,this.lineCap=this.o.lineCap,this.radius=this.xy-this.lineWidth/2,this.o.angleOffset&&(this.o.angleOffset=isNaN(this.o.angleOffset)?0:this.o.angleOffset),this.o.angleArc&&(this.o.angleArc=isNaN(this.o.angleArc)?this.PI2:this.o.angleArc),this.angleOffset=this.o.angleOffset*Math.PI/180,this.angleArc=this.o.angleArc*Math.PI/180,this.startAngle=1.5*Math.PI+this.angleOffset,this.endAngle=1.5*Math.PI+this.angleOffset+this.angleArc;var t=i(String(Math.abs(this.o.max)).length,String(Math.abs(this.o.min)).length,2)+2;this.o.displayInput&&this.i.css({width:(this.w/2+4>>0)+"px",height:(this.w/3>>0)+"px",position:"absolute","vertical-align":"middle","margin-top":(this.w/3>>0)+"px","margin-left":"-"+(3*this.w/4+2>>0)+"px",border:0,background:"none",font:this.o.fontWeight+" "+(this.w/t>>0)+"px "+this.o.font,"text-align":"center",color:this.o.inputColor||this.o.fgColor,padding:"0px","-webkit-appearance":"none"})||this.i.css({width:"0px",visibility:"hidden"})},this.change=function(t){this.cv=t,this.$.val(this.o.format(t))},this.angle=function(t){return(t-this.o.min)*this.angleArc/(this.o.max-this.o.min)},this.arc=function(t){var e,i;return t=this.angle(t),this.o.flip?(e=this.endAngle+1e-5,i=e-t-1e-5):(e=this.startAngle-1e-5,i=e+t+1e-5),this.o.cursor&&(e=i-this.cursorExt)&&(i+=this.cursorExt),{s:e,e:i,d:this.o.flip&&!this.o.cursor}},this.draw=function(){var t,e=this.g,i=this.arc(this.cv),n=1;e.lineWidth=this.lineWidth,e.lineCap=this.lineCap,"none"!==this.o.bgColor&&(e.beginPath(),e.strokeStyle=this.o.bgColor,e.arc(this.xy,this.xy,this.radius,this.endAngle-1e-5,this.startAngle+1e-5,!0),e.stroke()),this.o.displayPrevious&&(t=this.arc(this.v),e.beginPath(),e.strokeStyle=this.pColor,e.arc(this.xy,this.xy,this.radius,t.s,t.e,t.d),e.stroke(),n=this.cv==this.v),e.beginPath(),e.strokeStyle=n?this.o.fgColor:this.fgColor,e.arc(this.xy,this.xy,this.radius,i.s,i.e,i.d),e.stroke()},this.cancel=function(){this.val(this.v)}},t.fn.dial=t.fn.knob=function(i){return this.each(function(){var n=new e.Dial;n.o=i,n.$=t(this),n.run()}).parent()}}),angular.module("ui.knob",[]).directive("knob",["$timeout",function(t){return{restrict:"EA",replace:!0,template:'<input value="{{ knobData }}"/>',reuire:"knobData",scope:{knobData:"=",knobOptions:"&"},link:function(e,i){var n=e.knobOptions()||{};n.release=function(i){t(function(){e.knobData=i,e.$apply()})},e.$watch("knobData",function(t,e){t!=e&&$(i).val(t).change()}),$(i).val(e.knobData).knob(n)}}}]),!function(t){var e=function(e,i){this.options=i,this.$element=t(e).delegate('[data-dismiss="modal-popup"]',"click.dismiss.modal-popup",t.proxy(this.hide,this)),this.options.remote&&this.$element.find(".popover-content").load(this.options.remote),this.$parent=i.$parent};e.prototype=t.extend({},t.fn.modal.Constructor.prototype,{constructor:e,getPosition:function(){var e=this.$parent;return t.extend({},e.offset(),{width:e[0].offsetWidth,height:e[0].offsetHeight})},show:function(){var e=this.$element;e.css({top:0,left:0,display:"block","z-index":1050});var i,n="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,r=this.getPosition(),o=e[0].offsetWidth,a=e[0].offsetHeight;switch(n){case"bottom":i={top:r.top+r.height,left:r.left+r.width/2-o/2};break;case"top":i={top:r.top-a,left:r.left+r.width/2-o/2};break;case"left":i={top:r.top+r.height/2-a/2,left:r.left-o};break;case"right":i={top:r.top+r.height/2-a/2,left:r.left+r.width}}e.css(i).addClass(n).addClass("in"),t.fn.modal.Constructor.prototype.show.call(this,arguments)},backdrop:function(e){var i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=t.support.transition&&i;this.$backdrop=t('<div class="modal-backdrop '+i+'" style="background:none" />').appendTo(document.body),"static"!=this.options.backdrop&&this.$backdrop.click(t.proxy(this.hide,this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),n?this.$backdrop.one(t.support.transition.end,e):e()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,t.proxy(this.removeBackdrop,this)):this.removeBackdrop()):e&&e()}}),t.fn.modalPopover=function(i){return this.each(function(){var n=t(this),r=n.data("modal-popover"),o=t.extend({},t.fn.modalPopover.defaults,n.data(),"object"==typeof i&&i);o.$parent=r&&r.$parent||i.$parent||t(o.target),r||n.data("modal-popover",r=new e(this,o)),"string"==typeof i&&r[i]()})},t.fn.modalPopover.Constructor=e,t.fn.modalPopover.defaults=t.extend({},t.fn.modal.defaults,{placement:"right",keyboard:!0}),t(function(){t("body").on("click.modal-popover.data-api",'[data-toggle="modal-popover"]',function(e){var i=t(this),n=i.attr("href"),r=t(i.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),o=r.data("modal-popover")?"toggle":t.extend({remote:!/#/.test(n)&&n},r.data(),i.data());o.$parent=i,e.preventDefault(),r.modalPopover(o).modalPopover("show").one("hide",function(){i.focus()})})})}(window.jQuery),angular.module("gettext",[]),angular.module("gettext").constant("gettext",function(t){return t}),angular.module("gettext").factory("gettextCatalog",["gettextPlurals","$http","$cacheFactory","$interpolate","$rootScope",function(t,e,i,n,r){function o(){r.$broadcast("gettextLanguageChanged")}var a,s="$$noContext",l="<span>test</span>",c=angular.element("<span>"+l+"</span>").html()!==l,h=function(t){return a.debug&&a.currentLanguage!==a.baseLanguage?a.debugPrefix+t:t},u=function(t){return a.showTranslatedMarkers?a.translatedMarkerPrefix+t+a.translatedMarkerSuffix:t};return a={debug:!1,debugPrefix:"[MISSING]: ",showTranslatedMarkers:!1,translatedMarkerPrefix:"[",translatedMarkerSuffix:"]",strings:{},baseLanguage:"en",currentLanguage:"en",cache:i("strings"),setCurrentLanguage:function(t){this.currentLanguage=t,o()},setStrings:function(t,e){this.strings[t]||(this.strings[t]={});for(var i in e){var n=e[i];if(c&&(i=angular.element("<span>"+i+"</span>").html()),angular.isString(n)||angular.isArray(n)){var r={};r[s]=n,n=r}for(var a in n){var l=n[a];n[a]=angular.isArray(l)?l:[l]}this.strings[t][i]=n}o()},getStringForm:function(t,e,i){var n=this.strings[this.currentLanguage]||{},r=n[t]||{},o=r[i||s]||[];return o[e]},getString:function(t,e,i){return t=this.getStringForm(t,0,i)||h(t),t=e?n(t)(e):t,u(t)},getPlural:function(e,i,r,o,a){var s=t(this.currentLanguage,e);return i=this.getStringForm(i,s,a)||h(1===e?i:r),o&&(o.$count=e,i=n(i)(o)),u(i)},loadRemote:function(t){return e({method:"GET",url:t,cache:a.cache}).success(function(t){for(var e in t)a.setStrings(e,t[e])})}}}]),angular.module("gettext").directive("translate",["gettextCatalog","$parse","$animate","$compile","$window",function(t,e,i,n,r){function o(t,e,i){if(!t)throw new Error("You should add a "+e+" attribute whenever you add a "+i+" attribute.")}var a=function(){return String.prototype.trim?function(t){return"string"==typeof t?t.trim():t}:function(t){return"string"==typeof t?t.replace(/^\s*/,"").replace(/\s*$/,""):t}}(),s=parseInt((/msie (\d+)/.exec(angular.lowercase(r.navigator.userAgent))||[])[1],10);return{restrict:"AE",terminal:!0,compile:function(r,l){o(!l.translatePlural||l.translateN,"translate-n","translate-plural"),o(!l.translateN||l.translatePlural,"translate-plural","translate-n");var c=a(r.html()),h=l.translatePlural,u=l.translateContext;return 8>=s&&"<!--IE fix-->"===c.slice(-13)&&(c=c.slice(0,-13)),{post:function(r,o,a){function s(){var e;h?(r=f||(f=r.$new()),r.$count=l(r),e=t.getPlural(r.$count,c,h,null,u)):e=t.getString(c,null,u);var a=angular.element("<span>"+e+"</span>");n(a.contents())(r);var s=o.contents(),d=a.contents();i.enter(d,o),i.leave(s)}var l=e(a.translateN),f=null;a.translateN&&r.$watch(a.translateN,s),r.$on("gettextLanguageChanged",s),s()}}}}}]),angular.module("gettext").filter("translate",["gettextCatalog",function(t){function e(e,i){return t.getString(e,null,i)}return e.$stateful=!0,e}]),angular.module("gettext").factory("gettextPlurals",function(){return function(t,e){switch(t){case"ay":case"bo":case"cgg":case"dz":case"fa":case"id":case"ja":case"jbo":case"ka":case"kk":case"km":case"ko":case"ky":case"lo":case"ms":case"my":case"sah":case"su":case"th":case"tt":case"ug":case"vi":case"wo":case"zh":return 0;case"is":return e%10!=1||e%100==11?1:0;case"jv":return 0!=e?1:0;case"mk":return 1==e||e%10==1?0:1;case"ach":case"ak":case"am":case"arn":case"br":case"fil":case"fr":case"gun":case"ln":case"mfe":case"mg":case"mi":case"oc":case"pt_BR":case"tg":case"ti":case"tr":case"uz":case"wa":case"zh":return e>1?1:0;case"lv":return e%10==1&&e%100!=11?0:0!=e?1:2;case"lt":return e%10==1&&e%100!=11?0:e%10>=2&&(10>e%100||e%100>=20)?1:2;case"be":case"bs":case"hr":case"ru":case"sr":case"uk":return e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2;case"mnk":return 0==e?0:1==e?1:2;case"ro":return 1==e?0:0==e||e%100>0&&20>e%100?1:2;case"pl":return 1==e?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2;case"cs":case"sk":return 1==e?0:e>=2&&4>=e?1:2;case"sl":return e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0;case"mt":return 1==e?0:0==e||e%100>1&&11>e%100?1:e%100>10&&20>e%100?2:3;case"gd":return 1==e||11==e?0:2==e||12==e?1:e>2&&20>e?2:3;case"cy":return 1==e?0:2==e?1:8!=e&&11!=e?2:3;case"kw":return 1==e?0:2==e?1:3==e?2:3;case"ga":return 1==e?0:2==e?1:7>e?2:11>e?3:4;case"ar":return 0==e?0:1==e?1:2==e?2:e%100>=3&&10>=e%100?3:e%100>=11?4:5;default:return 1!=e?1:0}}});